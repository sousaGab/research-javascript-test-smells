file,type,line,method,source
/examples/rest-persister/tests/rest-persister.test.js,AnonymousTest,"{'startLine':9,'endLine':15}","it('should work', async function () {
    const res = await fetch('https://jsonplaceholder.typicode.com/posts/1');
    const post = await res.json();

    expect(res.status).to.equal(200);
    expect(post.id).to.equal(1);
  })",snuts
/examples/node-fetch/tests/node-fetch.test.js,AnonymousTest,"{'startLine':23,'endLine':29}","it('should work', async function () {
    const res = await fetch('https://jsonplaceholder.typicode.com/posts/1');
    const post = await res.json();

    expect(res.status).to.equal(200);
    expect(post.id).to.equal(1);
  })",snuts
/examples/client-server/tests/intercept.test.js,ConditionalTestLogic,"{'startLine':51,'endLine':56}","it('can conditionally intercept requests', async function () {
    const { server } = this.polly;

    server
      .get('https://jsonplaceholder.typicode.com/posts/:id')
      .intercept((req, res, interceptor) => {
        if (req.params.id === '42') {
          res.status(200).send('Life');
        } else {
          // Abort out of the intercept handler and continue with the request
          interceptor.abort();
        }
      });

    let res = await fetch('https://jsonplaceholder.typicode.com/posts/42');

    expect(res.status).to.equal(200);
    expect(await res.text()).to.equal('Life');

    res = await fetch('https://jsonplaceholder.typicode.com/posts/1');

    expect(res.status).to.equal(200);
    expect((await res.json()).id).to.equal(1);
  })",snuts
/tests/integration/persister-tests.js,VerboseStatement,"{'startLine':27,'endLine':49}","it('should have the correct metadata', async function () {
    const { recordingId, recordingName, persister } = this.polly;

    this.polly.record();
    await this.fetchRecord();
    await persister.persist();

    const har = await persister.findRecording(recordingId);
    const { _recordingName, creator, entries } = har.log;
    const entry = entries[0];

    expect(_recordingName).to.equal(recordingName);

    expect(creator.name).to.equal('Polly.JS');
    expect(creator.version).to.equal(Polly.VERSION);
    expect(creator.comment).to.equal(
      `${persister.constructor.type}:${persister.constructor.id}`
    );

    expect(entry).to.be.an('object');
    expect(entry._id).to.a('string');
    expect(entry._order).to.equal(0);
  })",snuts
/tests/integration/persister-tests.js,VerboseStatement,"{'startLine':51,'endLine':85}","it('should add new entries to an existing recording', async function () {
    const { recordingId, recordingName, config } = this.polly;
    let { persister } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    this.polly.record();
    await this.fetch(orderedRecordUrl(1));
    await persister.persist();

    let har = await persister.findRecording(recordingId);

    expect(har.log.entries).to.have.lengthOf(1);

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    persister = this.polly.persister;

    this.polly.record();
    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await persister.persist();

    har = await persister.findRecording(recordingId);

    expect(har.log.entries).to.have.lengthOf(3);
    expect(
      har.log.entries.filter((e) => e.request.url.includes(orderedRecordUrl(1)))
    ).to.have.lengthOf(2);
    expect(
      har.log.entries.filter((e) => e.request.url.includes(orderedRecordUrl(2)))
    ).to.have.lengthOf(1);
  })",snuts
/tests/integration/persister-tests.js,VerboseStatement,"{'startLine':134,'endLine':173}","it('should correctly handle array header values', async function () {
    const { recordingId, server, persister } = this.polly;
    let responseCalled = false;

    this.polly.record();

    server
      .get(this.recordUrl())
      .configure({ matchRequestsBy: { order: false } })
      .once('beforeResponse', (req, res) => {
        res.setHeaders({
          string: 'foo',
          one: ['foo'],
          two: ['foo', 'bar']
        });
      });

    await this.fetchRecord();
    await persister.persist();

    const har = await persister.findRecording(recordingId);
    const { headers } = har.log.entries[0].response;

    expect(await validate.har(har)).to.be.true;
    expect(
      headers.filter(({ _fromType }) => _fromType === 'array')
    ).to.have.lengthOf(3);

    this.polly.replay();

    server.get(this.recordUrl()).once('response', (req, res) => {
      expect(res.getHeader('string')).to.equal('foo');
      expect(res.getHeader('one')).to.deep.equal(['foo']);
      expect(res.getHeader('two')).to.deep.equal(['foo', 'bar']);
      responseCalled = true;
    });

    await this.fetchRecord();
    expect(responseCalled).to.be.true;
  })",snuts
/tests/integration/persister-tests.js,VerboseStatement,"{'startLine':250,'endLine':284}","it('should remove unused entries when `keepUnusedRequests` is false', async function () {
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: false
      }
    });

    await this.fetch(orderedRecordUrl(1)); // -> Replay
    await this.fetch(orderedRecordUrl(3)); // -> New recording
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(3));
  })",snuts
/tests/integration/persister-tests.js,VerboseStatement,"{'startLine':286,'endLine':325}","it('should sort the entries by date', async function () {
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: true
      }
    });
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(2));

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.record();

    await this.fetch(orderedRecordUrl(3));
    await this.fetch(orderedRecordUrl(4));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(4);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(3));
    expect(har.log.entries[2].request.url).to.include(orderedRecordUrl(4));
    expect(har.log.entries[3].request.url).to.include(orderedRecordUrl(2));
  })",snuts
/tests/integration/persister-tests.js,VerboseStatement,"{'startLine':327,'endLine':366}","it('should not sort the entries by date if `disableSortingHarEntries` is true', async function () {
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: true,
        disableSortingHarEntries: true
      }
    });
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(2));

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();

    await this.fetch(orderedRecordUrl(3));
    await this.fetch(orderedRecordUrl(4));
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(4);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(3));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(4));
    expect(har.log.entries[2].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[3].request.url).to.include(orderedRecordUrl(2));
  })",snuts
/tests/integration/persister-tests.js,VerboseStatement,"{'startLine':368,'endLine':417}","it('should correctly handle binary responses', async function () {
    const { recordingId, server, persister } = this.polly;
    let har, content;

    this.polly.record();

    // Non binary content
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.body = 'Some content';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[0].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.be.undefined;

    // Binary content
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.encoding = 'base64';
      res.body = 'U29tZSBjb250ZW50';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[1].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.equal('base64');

    // Binary content with no body
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.encoding = 'base64';
      res.body = '';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[2].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.be.undefined;
  })",snuts
/tests/integration/adapter-tests.js,AnonymousTest,"{'startLine':77,'endLine':89}","it('should intercept', async function () {
    const { server } = this.polly;

    server.any(this.recordUrl()).intercept((_, res) => res.status(201));

    server.get(this.recordUrl()).intercept((req, res) => res.json(req.query));

    const res = await this.fetch(`${this.recordUrl()}?foo=bar`);
    const json = await res.json();

    expect(res.status).to.equal(201);
    expect(json).to.deep.equal({ foo: 'bar' });
  })",snuts
/tests/integration/adapter-tests.js,AnonymousTest,"{'startLine':91,'endLine':99}","it('should passthrough', async function () {
    const { server, persister, recordingId } = this.polly;

    server.get(this.recordUrl()).passthrough();

    expect(await persister.findRecording(recordingId)).to.be.null;
    expect((await this.fetchRecord()).status).to.equal(404);
    expect(await persister.findRecording(recordingId)).to.be.null;
  })",snuts
/tests/integration/adapter-tests.js,ConditionalTestLogic,"{'startLine':244,'endLine':246}","it('should have resolved requests after flushing', async function () {
    // The puppeteer adapter has its own implementation of this test
    if (this.polly.adapters.has('puppeteer')) {
      this.skip();
    }

    const { server } = this.polly;
    const requests = [];
    const resolved = [];

    server
      .get(this.recordUrl())
      .intercept(async (req, res) => {
        await server.timeout(5);
        res.sendStatus(200);
      })
      .on('request', (req) => {
        requests.push(req);
      });

    this.fetchRecord().then(() => resolved.push(1));
    this.fetchRecord().then(() => resolved.push(2));
    this.fetchRecord().then(() => resolved.push(3));

    await this.polly.server.timeout(10);

    expect(requests).to.have.lengthOf(3);

    await this.polly.flush();

    requests.forEach((request) => expect(request.didRespond).to.be.true);
    expect(resolved).to.have.members([1, 2, 3]);
  })",snuts
/tests/integration/adapter-tests.js,VerboseStatement,"{'startLine':170,'endLine':209}","it('should call beforeReplay with a cloned recording entry', async function () {
    const { recordingId, recordingName, config } = this.polly;
    let replayedEntry;

    this.polly.record();
    await this.fetchRecord();
    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();

    const har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(1);

    this.polly.server
      .get(this.recordUrl())
      .on('beforeReplay', (_req, entry) => (replayedEntry = entry));

    const entry = har.log.entries[0];

    await this.fetchRecord();

    expect(replayedEntry).to.be.an('object');

    expect(entry).to.deep.equal(replayedEntry);
    expect(entry).to.not.equal(replayedEntry);

    expect(entry.request).to.deep.equal(replayedEntry.request);
    expect(entry.request).to.not.equal(replayedEntry.request);

    expect(entry.response).to.deep.equal(replayedEntry.response);
    expect(entry.response).to.not.equal(replayedEntry.response);

    expect(entry.response.content).to.deep.equal(
      replayedEntry.response.content
    );
    expect(entry.response.content).to.not.equal(replayedEntry.response.content);
  })",snuts
/packages/@pollyjs/utils/tests/serializer-tests.js,AnonymousTest,"{'startLine':2,'endLine':4}","it('should exist', function () {
    expect(serialize).to.be.a('function');
  })",snuts
/packages/@pollyjs/persister/tests/unit/persister-test.js,AnonymousTest,"{'startLine':6,'endLine':8}","it('should exist', function () {
    expect(Persister).to.be.a('function');
  })",snuts
/packages/@pollyjs/persister/tests/unit/persister-test.js,AnonymousTest,"{'startLine':63,'endLine':69}","it('caches', async function () {
      await this.persister.findRecording('test');
      await this.persister.findRecording('test');
      await this.persister.findRecording('test');

      expect(callCounts.find).to.equal(1);
    })",snuts
/packages/@pollyjs/persister/tests/unit/persister-test.js,NonFunctionalStatement,"{'startLine':48,'endLine':48}","beforeEach(function () {
      callCounts = { find: 0, save: 0, delete: 0 };
      recording = {
        log: {
          creator: {
            name: 'Polly.JS'
          }
        }
      };

      class CustomPersister extends Persister {
        static get id() {
          return 'CustomPersister';
        }

        async onFindRecording() {
          callCounts.find++;
          await timeout(1);

          return recording;
        }

        async onSaveRecording() {
          callCounts.save++;
          await timeout(1);
        }

        async onDeleteRecording() {
          callCounts.delete++;
          await timeout(1);
        }
      }

      this.persister = new CustomPersister({
        logger: {
          log: { debug: () => {} }
        }
      });
    })",snuts
/packages/@pollyjs/persister/tests/unit/har-test.js,AnonymousTest,"{'startLine':10,'endLine':16}","it('should exist', function () {
    expect(HAR).to.be.a('function');
    expect(Log).to.be.a('function');
    expect(Entry).to.be.a('function');
    expect(Request).to.be.a('function');
    expect(Response).to.be.a('function');
  })",snuts
/packages/@pollyjs/ember/tests/unit/polly-test.js,AnonymousTest,"{'startLine':6,'endLine':8}","test('it works', function (assert) {
      assert.strictEqual(typeof Polly, 'function');
    })",snuts
/packages/@pollyjs/ember/tests/unit/polly-test.js,AnonymousTest,"{'startLine':21,'endLine':24}","test('it works', function (assert) {
      assert.ok(this.polly);
      assert.ok(this.polly instanceof Polly);
    })",snuts
/packages/@pollyjs/ember/tests/unit/polly-test.js,AnonymousTest,"{'startLine':33,'endLine':36}","test('it works', function (assert) {
      assert.ok(this.polly);
      assert.ok(this.polly instanceof Polly);
    })",snuts
/packages/@pollyjs/ember/tests/unit/polly-test.js,AnonymousTest,"{'startLine':40,'endLine':44}","test('it works', function (assert) {
      assert.strictEqual(typeof Timing, 'object');
      assert.strictEqual(typeof Timing.fixed, 'function');
      assert.strictEqual(typeof Timing.relative, 'function');
    })",snuts
/packages/@pollyjs/ember/tests/unit/polly-test.js,AnonymousTest,"{'startLine':48,'endLine':52}","test('adapters', async function (assert) {
      const polly = new Polly('adapters');
      assert.strictEqual(polly.adapters.size, 2);
      await polly.stop();
    })",snuts
/packages/@pollyjs/ember/tests/unit/polly-test.js,AnonymousTest,"{'startLine':54,'endLine':58}","test('persister', async function (assert) {
      const polly = new Polly('persister');
      assert.strictEqual(typeof polly.persister, 'object');
      await polly.stop();
    })",snuts
/packages/@pollyjs/ember/tests/unit/polly-test.js,IdenticalTestDescription,"{'startLine':21,'endLine':24}","test('it works', function (assert) {
      assert.ok(this.polly);
      assert.ok(this.polly instanceof Polly);
    })",snuts
/packages/@pollyjs/ember/tests/unit/polly-test.js,IdenticalTestDescription,"{'startLine':33,'endLine':36}","test('it works', function (assert) {
      assert.ok(this.polly);
      assert.ok(this.polly instanceof Polly);
    })",snuts
/packages/@pollyjs/ember/tests/unit/polly-test.js,IdenticalTestDescription,"{'startLine':40,'endLine':44}","test('it works', function (assert) {
      assert.strictEqual(typeof Timing, 'object');
      assert.strictEqual(typeof Timing.fixed, 'function');
      assert.strictEqual(typeof Timing.relative, 'function');
    })",snuts
/packages/@pollyjs/persister-fs/tests/unit/persister-test.js,AnonymousTest,"{'startLine':19,'endLine':21}","it('should exist', function () {
    expect(FSPersister).to.be.a('function');
  })",snuts
/packages/@pollyjs/persister-fs/tests/unit/persister-test.js,AnonymousTest,"{'startLine':28,'endLine':52}","it('recordingsDir', function () {
      let persister = new FSPersister(new MockPolly());

      expect(persister.options.recordingsDir)
        .to.equal(persister.defaultOptions.recordingsDir)
        .and.to.equal('recordings');

      persister = new FSPersister(
        new MockPolly({
          recordingsDir: 'recordings/tmp'
        })
      );

      expect(persister.options.recordingsDir)
        .to.equal('recordings/tmp')
        .and.to.not.equal(persister.defaultOptions.recordingsDir);

      fixturify.writeSync('recordings/tmp', {
        'FS-Persister': {
          'recording.har': '{}'
        }
      });

      expect(persister.onFindRecording('FS-Persister')).to.deep.equal({});
    })",snuts
/packages/@pollyjs/persister-fs/tests/unit/persister-test.js,AnonymousTest,"{'startLine':66,'endLine':73}","it('onSaveRecording', function () {
      expect(this.persister.onFindRecording('FS-Persister')).to.deep.equal({});

      this.persister.onSaveRecording('FS-Persister', { foo: 'bar' });
      expect(this.persister.onFindRecording('FS-Persister')).to.deep.equal({
        foo: 'bar'
      });
    })",snuts
/packages/@pollyjs/persister-fs/tests/unit/persister-test.js,AnonymousTest,"{'startLine':75,'endLine':78}","it('onFindRecording', function () {
      expect(this.persister.onFindRecording('FS-Persister')).to.deep.equal({});
      expect(this.persister.onFindRecording('Does-Not-Exist')).to.be.null;
    })",snuts
/packages/@pollyjs/persister-fs/tests/unit/persister-test.js,AnonymousTest,"{'startLine':80,'endLine':85}","it('onDeleteRecording', function () {
      expect(this.persister.onFindRecording('FS-Persister')).to.not.be.null;

      this.persister.onDeleteRecording('FS-Persister');
      expect(this.persister.onFindRecording('Does-Not-Exist')).to.be.null;
    })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,AnonymousTest,"{'startLine':11,'endLine':13}","it('should exist', function () {
    expect(Polly).to.be.a('function');
  })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,AnonymousTest,"{'startLine':283,'endLine':289}","it('.record()', async function () {
      this.polly.mode = MODES.REPLAY;

      expect(this.polly.mode).to.equal(MODES.REPLAY);
      this.polly.record();
      expect(this.polly.mode).to.equal(MODES.RECORD);
    })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,AnonymousTest,"{'startLine':291,'endLine':297}","it('.replay()', async function () {
      this.polly.mode = MODES.RECORD;

      expect(this.polly.mode).to.equal(MODES.RECORD);
      this.polly.replay();
      expect(this.polly.mode).to.equal(MODES.REPLAY);
    })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,AnonymousTest,"{'startLine':299,'endLine':305}","it('.passthrough()', async function () {
      this.polly.mode = MODES.RECORD;

      expect(this.polly.mode).to.equal(MODES.RECORD);
      this.polly.passthrough();
      expect(this.polly.mode).to.equal(MODES.PASSTHROUGH);
    })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,AnonymousTest,"{'startLine':307,'endLine':316}","it('.pause()', async function () {
      this.polly.configure({ adapters: [MockAdapterA, MockAdapterB] });

      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
      this.polly.pause();
      expect([...this.polly.adapters.keys()]).to.deep.equal([]);
    })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,AnonymousTest,"{'startLine':318,'endLine':337}","it('.play()', async function () {
      this.polly.configure({ adapters: [MockAdapterA, MockAdapterB] });

      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
      this.polly.play();
      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
      this.polly.pause();
      expect([...this.polly.adapters.keys()]).to.deep.equal([]);
      this.polly.play();
      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
    })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,AnonymousTest,"{'startLine':339,'endLine':348}","it('.stop()', async function () {
      this.polly.mode = MODES.RECORD;
      expect(this.polly.mode).to.equal(MODES.RECORD);

      const promise = this.polly.stop();

      expect(promise).to.be.a('promise');
      await promise;
      expect(this.polly.mode).to.equal(MODES.STOPPED);
    })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,AnonymousTest,"{'startLine':350,'endLine':377}","it('.connectTo()', async function () {
      let connectCount = 0;
      let disconnectCount = 0;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCount++;
        }

        onDisconnect() {
          disconnectCount++;
        }
      }

      this.polly.container.register(MockAdapter);

      this.polly.connectTo('mock');
      expect(connectCount).to.equal(1);
      expect(disconnectCount).to.equal(0);

      this.polly.connectTo(MockAdapter);
      expect(connectCount).to.equal(2);
      expect(disconnectCount).to.equal(1);
    })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,AnonymousTest,"{'startLine':379,'endLine':408}","it('.disconnectTo()', async function () {
      let connectCount = 0;
      let disconnectCount = 0;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCount++;
        }

        onDisconnect() {
          disconnectCount++;
        }
      }

      this.polly.container.register(MockAdapter);

      this.polly.connectTo('mock');
      expect(connectCount).to.equal(1);
      this.polly.disconnectFrom('mock');
      expect(disconnectCount).to.equal(1);

      this.polly.connectTo(MockAdapter);
      expect(connectCount).to.equal(2);
      this.polly.disconnectFrom(MockAdapter);
      expect(disconnectCount).to.equal(2);
    })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,AnonymousTest,"{'startLine':410,'endLine':437}","it('.disconnect()', async function () {
      const disconnects = [];

      class MockAdapterA extends Adapter {
        static get id() {
          return 'mock-a';
        }

        onConnect() {}

        onDisconnect() {
          disconnects.push(true);
        }
      }

      class MockAdapterB extends MockAdapterA {
        static get id() {
          return 'mock-b';
        }
      }

      // configure automatically connects to the new adapter
      this.polly.configure({ adapters: [MockAdapterA, MockAdapterB] });

      expect(disconnects.length).to.equal(0);
      expect(this.polly.disconnect());
      expect(disconnects.length).to.equal(2);
    })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,AnonymousTest,"{'startLine':439,'endLine':444}","it('.flush()', async function () {
      const promise = this.polly.flush();

      expect(promise).to.be.a('promise');
      await promise;
    })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,AnonymousTest,"{'startLine':461,'endLine':470}","it('.register()', async function () {
        Polly.register(MockAdapter);

        const polly = new Polly('Test');

        expect(polly.container.has('adapter:mock')).to.be.true;

        await polly.stop();
        Polly.unregister(MockAdapter);
      })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,AnonymousTest,"{'startLine':472,'endLine':485}","it('.unregister()', async function () {
        Polly.register(MockAdapter);

        let polly = new Polly('Test');

        expect(polly.container.has('adapter:mock')).to.be.true;
        await polly.stop();

        Polly.unregister(MockAdapter);

        polly = new Polly('Test');
        expect(polly.container.has('adapter:mock')).to.be.false;
        await polly.stop();
      })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,AnonymousTest,"{'startLine':489,'endLine':501}","it('register', async function () {
        let registerCalled = false;

        Polly.once('register', (container) => {
          expect(container).to.be.an.instanceof(Container);
          registerCalled = true;
        });

        const polly = new Polly('Test');

        expect(registerCalled).to.be.true;
        await polly.stop();
      })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,AnonymousTest,"{'startLine':503,'endLine':515}","it('create', async function () {
        let createCalled = false;

        Polly.once('create', (polly) => {
          expect(polly).to.be.an.instanceof(Polly);
          createCalled = true;
        });

        const polly = new Polly('Test');

        expect(createCalled).to.be.true;
        await polly.stop();
      })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,AnonymousTest,"{'startLine':536,'endLine':549}","it('stop', async function () {
        let stopCalled = false;

        Polly.once('stop', (polly) => {
          expect(polly).to.be.an.instanceof(Polly);
          expect(polly.mode).to.equal(MODES.STOPPED);
          stopCalled = true;
        });

        const polly = new Polly('Test');

        await polly.stop();
        expect(stopCalled).to.be.true;
      })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,NonFunctionalStatement,"{'startLine':199,'endLine':199}","it('should not deep merge adapter options', async function () {
      class MockAdapterA extends Adapter {
        static get id() {
          return 'mock-a';
        }

        onConnect() {}
        onDisconnect() {}
      }

      class MockAdapterB extends MockAdapterA {
        static get id() {
          return 'mock-b';
        }
      }

      expect(this.polly.config.adapters.length).to.equal(0);

      this.polly.configure({ adapters: [MockAdapterA] });
      this.polly.configure({ adapters: [MockAdapterB] });

      expect(this.polly.config.adapters.length).to.equal(1);
      expect(this.polly.adapters.has('mock-a')).to.be.false;
      expect(this.polly.adapters.has('mock-b')).to.be.true;
    })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,NonFunctionalStatement,"{'startLine':200,'endLine':200}","it('should not deep merge adapter options', async function () {
      class MockAdapterA extends Adapter {
        static get id() {
          return 'mock-a';
        }

        onConnect() {}
        onDisconnect() {}
      }

      class MockAdapterB extends MockAdapterA {
        static get id() {
          return 'mock-b';
        }
      }

      expect(this.polly.config.adapters.length).to.equal(0);

      this.polly.configure({ adapters: [MockAdapterA] });
      this.polly.configure({ adapters: [MockAdapterB] });

      expect(this.polly.config.adapters.length).to.equal(1);
      expect(this.polly.adapters.has('mock-a')).to.be.false;
      expect(this.polly.adapters.has('mock-b')).to.be.true;
    })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,NonFunctionalStatement,"{'startLine':230,'endLine':230}","it('should connect to new adapters', async function () {
      let connectCalled = false;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCalled = true;
        }
        onDisconnect() {}
      }

      expect(connectCalled).to.be.false;
      this.polly.configure({ adapters: [MockAdapter] });
      expect(connectCalled).to.be.true;
    })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,NonFunctionalStatement,"{'startLine':273,'endLine':273}","describe('API', function () {
    setupPolly();

    class MockAdapterA extends Adapter {
      static get id() {
        return 'adapter-a';
      }

      onConnect() {}
      onDisconnect() {}
    }

    class MockAdapterB extends MockAdapterA {
      static get id() {
        return 'adapter-b';
      }
    }

    it('.record()', async function () {
      this.polly.mode = MODES.REPLAY;

      expect(this.polly.mode).to.equal(MODES.REPLAY);
      this.polly.record();
      expect(this.polly.mode).to.equal(MODES.RECORD);
    });

    it('.replay()', async function () {
      this.polly.mode = MODES.RECORD;

      expect(this.polly.mode).to.equal(MODES.RECORD);
      this.polly.replay();
      expect(this.polly.mode).to.equal(MODES.REPLAY);
    });

    it('.passthrough()', async function () {
      this.polly.mode = MODES.RECORD;

      expect(this.polly.mode).to.equal(MODES.RECORD);
      this.polly.passthrough();
      expect(this.polly.mode).to.equal(MODES.PASSTHROUGH);
    });

    it('.pause()', async function () {
      this.polly.configure({ adapters: [MockAdapterA, MockAdapterB] });

      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
      this.polly.pause();
      expect([...this.polly.adapters.keys()]).to.deep.equal([]);
    });

    it('.play()', async function () {
      this.polly.configure({ adapters: [MockAdapterA, MockAdapterB] });

      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
      this.polly.play();
      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
      this.polly.pause();
      expect([...this.polly.adapters.keys()]).to.deep.equal([]);
      this.polly.play();
      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
    });

    it('.stop()', async function () {
      this.polly.mode = MODES.RECORD;
      expect(this.polly.mode).to.equal(MODES.RECORD);

      const promise = this.polly.stop();

      expect(promise).to.be.a('promise');
      await promise;
      expect(this.polly.mode).to.equal(MODES.STOPPED);
    });

    it('.connectTo()', async function () {
      let connectCount = 0;
      let disconnectCount = 0;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCount++;
        }

        onDisconnect() {
          disconnectCount++;
        }
      }

      this.polly.container.register(MockAdapter);

      this.polly.connectTo('mock');
      expect(connectCount).to.equal(1);
      expect(disconnectCount).to.equal(0);

      this.polly.connectTo(MockAdapter);
      expect(connectCount).to.equal(2);
      expect(disconnectCount).to.equal(1);
    });

    it('.disconnectTo()', async function () {
      let connectCount = 0;
      let disconnectCount = 0;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCount++;
        }

        onDisconnect() {
          disconnectCount++;
        }
      }

      this.polly.container.register(MockAdapter);

      this.polly.connectTo('mock');
      expect(connectCount).to.equal(1);
      this.polly.disconnectFrom('mock');
      expect(disconnectCount).to.equal(1);

      this.polly.connectTo(MockAdapter);
      expect(connectCount).to.equal(2);
      this.polly.disconnectFrom(MockAdapter);
      expect(disconnectCount).to.equal(2);
    });

    it('.disconnect()', async function () {
      const disconnects = [];

      class MockAdapterA extends Adapter {
        static get id() {
          return 'mock-a';
        }

        onConnect() {}

        onDisconnect() {
          disconnects.push(true);
        }
      }

      class MockAdapterB extends MockAdapterA {
        static get id() {
          return 'mock-b';
        }
      }

      // configure automatically connects to the new adapter
      this.polly.configure({ adapters: [MockAdapterA, MockAdapterB] });

      expect(disconnects.length).to.equal(0);
      expect(this.polly.disconnect());
      expect(disconnects.length).to.equal(2);
    });

    it('.flush()', async function () {
      const promise = this.polly.flush();

      expect(promise).to.be.a('promise');
      await promise;
    });
  })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,NonFunctionalStatement,"{'startLine':274,'endLine':274}","describe('API', function () {
    setupPolly();

    class MockAdapterA extends Adapter {
      static get id() {
        return 'adapter-a';
      }

      onConnect() {}
      onDisconnect() {}
    }

    class MockAdapterB extends MockAdapterA {
      static get id() {
        return 'adapter-b';
      }
    }

    it('.record()', async function () {
      this.polly.mode = MODES.REPLAY;

      expect(this.polly.mode).to.equal(MODES.REPLAY);
      this.polly.record();
      expect(this.polly.mode).to.equal(MODES.RECORD);
    });

    it('.replay()', async function () {
      this.polly.mode = MODES.RECORD;

      expect(this.polly.mode).to.equal(MODES.RECORD);
      this.polly.replay();
      expect(this.polly.mode).to.equal(MODES.REPLAY);
    });

    it('.passthrough()', async function () {
      this.polly.mode = MODES.RECORD;

      expect(this.polly.mode).to.equal(MODES.RECORD);
      this.polly.passthrough();
      expect(this.polly.mode).to.equal(MODES.PASSTHROUGH);
    });

    it('.pause()', async function () {
      this.polly.configure({ adapters: [MockAdapterA, MockAdapterB] });

      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
      this.polly.pause();
      expect([...this.polly.adapters.keys()]).to.deep.equal([]);
    });

    it('.play()', async function () {
      this.polly.configure({ adapters: [MockAdapterA, MockAdapterB] });

      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
      this.polly.play();
      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
      this.polly.pause();
      expect([...this.polly.adapters.keys()]).to.deep.equal([]);
      this.polly.play();
      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
    });

    it('.stop()', async function () {
      this.polly.mode = MODES.RECORD;
      expect(this.polly.mode).to.equal(MODES.RECORD);

      const promise = this.polly.stop();

      expect(promise).to.be.a('promise');
      await promise;
      expect(this.polly.mode).to.equal(MODES.STOPPED);
    });

    it('.connectTo()', async function () {
      let connectCount = 0;
      let disconnectCount = 0;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCount++;
        }

        onDisconnect() {
          disconnectCount++;
        }
      }

      this.polly.container.register(MockAdapter);

      this.polly.connectTo('mock');
      expect(connectCount).to.equal(1);
      expect(disconnectCount).to.equal(0);

      this.polly.connectTo(MockAdapter);
      expect(connectCount).to.equal(2);
      expect(disconnectCount).to.equal(1);
    });

    it('.disconnectTo()', async function () {
      let connectCount = 0;
      let disconnectCount = 0;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCount++;
        }

        onDisconnect() {
          disconnectCount++;
        }
      }

      this.polly.container.register(MockAdapter);

      this.polly.connectTo('mock');
      expect(connectCount).to.equal(1);
      this.polly.disconnectFrom('mock');
      expect(disconnectCount).to.equal(1);

      this.polly.connectTo(MockAdapter);
      expect(connectCount).to.equal(2);
      this.polly.disconnectFrom(MockAdapter);
      expect(disconnectCount).to.equal(2);
    });

    it('.disconnect()', async function () {
      const disconnects = [];

      class MockAdapterA extends Adapter {
        static get id() {
          return 'mock-a';
        }

        onConnect() {}

        onDisconnect() {
          disconnects.push(true);
        }
      }

      class MockAdapterB extends MockAdapterA {
        static get id() {
          return 'mock-b';
        }
      }

      // configure automatically connects to the new adapter
      this.polly.configure({ adapters: [MockAdapterA, MockAdapterB] });

      expect(disconnects.length).to.equal(0);
      expect(this.polly.disconnect());
      expect(disconnects.length).to.equal(2);
    });

    it('.flush()', async function () {
      const promise = this.polly.flush();

      expect(promise).to.be.a('promise');
      await promise;
    });
  })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,NonFunctionalStatement,"{'startLine':418,'endLine':418}","it('.disconnect()', async function () {
      const disconnects = [];

      class MockAdapterA extends Adapter {
        static get id() {
          return 'mock-a';
        }

        onConnect() {}

        onDisconnect() {
          disconnects.push(true);
        }
      }

      class MockAdapterB extends MockAdapterA {
        static get id() {
          return 'mock-b';
        }
      }

      // configure automatically connects to the new adapter
      this.polly.configure({ adapters: [MockAdapterA, MockAdapterB] });

      expect(disconnects.length).to.equal(0);
      expect(this.polly.disconnect());
      expect(disconnects.length).to.equal(2);
    })",snuts
/packages/@pollyjs/core/tests/unit/polly-test.js,NonFunctionalStatement,"{'startLine':518,'endLine':518}","it('create - should throw with an async listener', async function () {
        Polly.once('create', () => {});
        Polly.once('create', () => Promise.resolve());

        expect(() => new Polly('Test')).to.throw(PollyError);
      })",snuts
/packages/@pollyjs/adapter-puppeteer/tests/integration/adapter-test.js,VerboseStatement,"{'startLine':74,'endLine':108}","it('should have resolved requests after flushing', async function () {
    // Timeout after 500ms since we could have a hanging while loop
    this.timeout(500);

    const { server } = this.polly;
    const requests = [];
    const resolved = [];
    let i = 1;

    server
      .get(this.recordUrl())
      .intercept(async (req, res) => {
        await server.timeout(5);
        res.sendStatus(200);
      })
      .on('request', (req) => requests.push(req));

    this.page.on('requestfinished', () => resolved.push(i++));

    this.fetchRecord();
    this.fetchRecord();
    this.fetchRecord();

    // Since it takes time for Puppeteer to execute the request in the browser's
    // context, we have to wait until the requests have been made.
    while (requests.length !== 3) {
      await server.timeout(5);
    }

    await this.polly.flush();

    expect(requests).to.have.lengthOf(3);
    requests.forEach((request) => expect(request.didRespond).to.be.true);
    expect(resolved).to.have.members([1, 2, 3]);
  })",snuts
/packages/@pollyjs/adapter/tests/unit/adapter-test.js,AnonymousTest,"{'startLine':4,'endLine':6}","it('should exist', function () {
    expect(Adapter).to.be.a('function');
  })",snuts
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,AnonymousTest,"{'startLine':90,'endLine':104}","it('.recordingName()', async function () {
      const { server } = this.polly;
      let recordingName;

      server
        .get('/ping')
        .recordingName('Override')
        .intercept((req, res) => {
          recordingName = req.recordingName;
          res.sendStatus(200);
        });

      expect((await fetch('/ping')).status).to.equal(200);
      expect(recordingName).to.equal('Override');
    })",snuts
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,AnonymousTest,"{'startLine':124,'endLine':139}","it('.filter()', async function () {
      const { server } = this.polly;

      server
        .get('/ping')
        .filter((req) => req.query.num === '1')
        .intercept((req, res) => res.sendStatus(201));

      server
        .get('/ping')
        .filter((req) => req.query.num === '2')
        .intercept((req, res) => res.sendStatus(202));

      expect((await fetch('/ping?num=1')).status).to.equal(201);
      expect((await fetch('/ping?num=2')).status).to.equal(202);
    })",snuts
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,AnonymousTest,"{'startLine':206,'endLine':222}","it('.times()', async function () {
      const { server } = this.polly;
      let callCount = 0;

      server
        .get('/ping')
        .times(1)
        .on('request', () => callCount++)
        .times()
        .intercept((req, res) => res.sendStatus(200));

      expect((await fetch('/ping')).status).to.equal(200);
      expect(callCount).to.equal(1);

      expect((await fetch('/ping')).status).to.equal(200);
      expect(callCount).to.equal(1);
    })",snuts
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,AnonymousTest,"{'startLine':244,'endLine':266}","it('event: request', async function () {
      const { server } = this.polly;
      let requestCalled = false;

      server
        .get('/ping')
        .intercept((req, res) => {
          expect(requestCalled).to.be.true;
          res.sendStatus(200);
        })
        .on('request', (req) => {
          expect(requestCalled).to.be.false;

          // Validate that we can modify the request
          req.body = 'test';
          expect(req.body).to.equal('test');

          requestCalled = true;
        });

      expect((await fetch('/ping')).status).to.equal(200);
      expect(requestCalled).to.be.true;
    })",snuts
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,AnonymousTest,"{'startLine':268,'endLine':288}","it('event: beforeResponse', async function () {
      const { server } = this.polly;
      let beforeResponseCalled = false;

      server
        .get('/ping')
        .intercept((req, res) => {
          expect(beforeResponseCalled).to.be.false;
          res.sendStatus(200);
        })
        .on('beforeResponse', (req, res) => {
          expect(beforeResponseCalled).to.be.false;
          expect(res.statusCode).to.equal(200);

          res.sendStatus(201);
          beforeResponseCalled = true;
        });

      expect((await fetch('/ping')).status).to.equal(201);
      expect(beforeResponseCalled).to.be.true;
    })",snuts
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,AnonymousTest,"{'startLine':290,'endLine':313}","it('event: response', async function () {
      const { server } = this.polly;
      let responseCalled = false;

      server
        .get('/ping')
        .intercept((req, res) => {
          expect(responseCalled).to.be.false;
          res.sendStatus(200);
        })
        .on('response', (req, res) => {
          expect(responseCalled).to.be.false;
          expect(req.didRespond).to.be.true;
          expect(res.statusCode).to.equal(200);

          // Validate that the req cant be modified
          expect(() => (req.body = 'test')).to.throw(Error);

          responseCalled = true;
        });

      expect((await fetch('/ping')).status).to.equal(200);
      expect(responseCalled).to.be.true;
    })",snuts
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,VerboseStatement,"{'startLine':454,'endLine':493}","it('can control flow with .times() & .stopPropagation()', async function () {
      const { server } = this.polly;
      let calledBeforeDelete = false;
      let calledAfterDelete = false;

      // First call should return the user and not enter the 2nd handler
      server
        .get('/users/1')
        .times(1)
        .on('request', (req, e) => {
          e.stopPropagation();
          calledBeforeDelete = true;
        })
        .intercept((req, res, interceptor) => {
          interceptor.stopPropagation();
          res.sendStatus(200);
        });

      server.delete('/users/1').intercept((req, res) => res.status(204));

      // Second call should 404 since the user no longer exists
      server
        .get('/users/1')
        .times(1)
        .on('request', () => (calledAfterDelete = true))
        .intercept((req, res) => res.sendStatus(404));

      expect((await fetch('/users/1')).status).to.equal(200);
      expect(calledBeforeDelete).to.be.true;
      expect(calledAfterDelete).to.be.false;

      calledBeforeDelete = false;
      expect((await fetch('/users/1', { method: 'DELETE' })).status).to.equal(
        204
      );

      expect((await fetch('/users/1')).status).to.equal(404);
      expect(calledBeforeDelete).to.be.false;
      expect(calledAfterDelete).to.be.true;
    })",snuts
/packages/@pollyjs/adapter-fetch/tests/integration/adapter-test.js,NonFunctionalStatement,"{'startLine':244,'endLine':244}","it(`should assign context's fetch as the native fetch and Request as the native Request`, async function () {
      const polly = new Polly('context', { adapters: [] });
      const fetch = () => {};
      const adapterOptions = {
        fetch: {
          context: {
            fetch,
            Request: MockRequest,
            Response: MockResponse,
            Headers: MockHeaders
          }
        }
      };

      polly.configure({ adapters: [FetchAdapter], adapterOptions });

      expect(polly.adapters.get('fetch').nativeFetch).to.equal(fetch);
      expect(polly.adapters.get('fetch').nativeFetch).to.not.equal(
        adapterOptions.fetch.context.fetch
      );

      expect(polly.adapters.get('fetch').NativeRequest).to.equal(MockRequest);
      expect(polly.adapters.get('fetch').NativeRequest).to.not.equal(
        adapterOptions.fetch.context.Request
      );

      expect(function () {
        polly.configure({
          adapterOptions: { fetch: { context: {} } }
        });
      }).to.throw(/fetch global not found/);

      await polly.stop();
    })",snuts
/packages/@pollyjs/adapter-fetch/tests/integration/adapter-test.js,NonFunctionalStatement,"{'startLine':310,'endLine':310}","it('should throw when context, fetch, Request, Response, and Headers are undefined', async function () {
      const polly = new Polly('context', { adapters: [] });

      polly.configure({
        adapters: [FetchAdapter]
      });

      expect(function () {
        polly.configure({
          adapterOptions: { fetch: { context: undefined } }
        });
      }).to.throw(/fetch global not found/);

      expect(function () {
        polly.configure({
          adapterOptions: {
            fetch: {
              context: {
                fetch: undefined,
                Request: MockRequest,
                Response: MockResponse,
                Headers: MockHeaders
              }
            }
          }
        });
      }).to.throw(/fetch global not found/);

      expect(function () {
        polly.configure({
          adapterOptions: {
            fetch: {
              context: {
                fetch() {},
                Request: undefined,
                Response: MockResponse,
                Headers: MockHeaders
              }
            }
          }
        });
      }).to.throw(/Request global not found/);

      expect(function () {
        polly.configure({
          adapterOptions: {
            fetch: {
              context: {
                fetch() {},
                Request: MockRequest,
                Response: undefined,
                Headers: MockHeaders
              }
            }
          }
        });
      }).to.throw(/Response global not found/);

      expect(function () {
        polly.configure({
          adapterOptions: {
            fetch: {
              context: {
                fetch() {},
                Request: MockRequest,
                Response: MockResponse,
                Headers: undefined
              }
            }
          }
        });
      }).to.throw(/Headers global not found/);

      await polly.stop();
    })",snuts
/packages/@pollyjs/adapter-fetch/tests/integration/adapter-test.js,NonFunctionalStatement,"{'startLine':325,'endLine':325}","it('should throw when context, fetch, Request, Response, and Headers are undefined', async function () {
      const polly = new Polly('context', { adapters: [] });

      polly.configure({
        adapters: [FetchAdapter]
      });

      expect(function () {
        polly.configure({
          adapterOptions: { fetch: { context: undefined } }
        });
      }).to.throw(/fetch global not found/);

      expect(function () {
        polly.configure({
          adapterOptions: {
            fetch: {
              context: {
                fetch: undefined,
                Request: MockRequest,
                Response: MockResponse,
                Headers: MockHeaders
              }
            }
          }
        });
      }).to.throw(/fetch global not found/);

      expect(function () {
        polly.configure({
          adapterOptions: {
            fetch: {
              context: {
                fetch() {},
                Request: undefined,
                Response: MockResponse,
                Headers: MockHeaders
              }
            }
          }
        });
      }).to.throw(/Request global not found/);

      expect(function () {
        polly.configure({
          adapterOptions: {
            fetch: {
              context: {
                fetch() {},
                Request: MockRequest,
                Response: undefined,
                Headers: MockHeaders
              }
            }
          }
        });
      }).to.throw(/Response global not found/);

      expect(function () {
        polly.configure({
          adapterOptions: {
            fetch: {
              context: {
                fetch() {},
                Request: MockRequest,
                Response: MockResponse,
                Headers: undefined
              }
            }
          }
        });
      }).to.throw(/Headers global not found/);

      await polly.stop();
    })",snuts
/packages/@pollyjs/adapter-fetch/tests/integration/adapter-test.js,NonFunctionalStatement,"{'startLine':340,'endLine':340}","it('should throw when context, fetch, Request, Response, and Headers are undefined', async function () {
      const polly = new Polly('context', { adapters: [] });

      polly.configure({
        adapters: [FetchAdapter]
      });

      expect(function () {
        polly.configure({
          adapterOptions: { fetch: { context: undefined } }
        });
      }).to.throw(/fetch global not found/);

      expect(function () {
        polly.configure({
          adapterOptions: {
            fetch: {
              context: {
                fetch: undefined,
                Request: MockRequest,
                Response: MockResponse,
                Headers: MockHeaders
              }
            }
          }
        });
      }).to.throw(/fetch global not found/);

      expect(function () {
        polly.configure({
          adapterOptions: {
            fetch: {
              context: {
                fetch() {},
                Request: undefined,
                Response: MockResponse,
                Headers: MockHeaders
              }
            }
          }
        });
      }).to.throw(/Request global not found/);

      expect(function () {
        polly.configure({
          adapterOptions: {
            fetch: {
              context: {
                fetch() {},
                Request: MockRequest,
                Response: undefined,
                Headers: MockHeaders
              }
            }
          }
        });
      }).to.throw(/Response global not found/);

      expect(function () {
        polly.configure({
          adapterOptions: {
            fetch: {
              context: {
                fetch() {},
                Request: MockRequest,
                Response: MockResponse,
                Headers: undefined
              }
            }
          }
        });
      }).to.throw(/Headers global not found/);

      await polly.stop();
    })",snuts
/packages/@pollyjs/utils/tests/unit/utils/url-test.js,AnonymousTest,"{'startLine':7,'endLine':9}","it('should exist', function () {
    expect(URL).to.be.a('function');
  })",snuts
/packages/@pollyjs/utils/tests/unit/utils/url-test.js,AnonymousTest,"{'startLine':11,'endLine':13}","it('should work', function () {
    expect(new URL('http://netflix.com/').href).to.equal('http://netflix.com/');
  })",snuts
/packages/@pollyjs/utils/tests/unit/utils/timestamp-test.js,AnonymousTest,"{'startLine':4,'endLine':6}","it('should exist', function () {
    expect(timestamp).to.be.a('function');
  })",snuts
/packages/@pollyjs/utils/tests/unit/utils/timeout-test.js,AnonymousTest,"{'startLine':4,'endLine':6}","it('should exist', function () {
    expect(timeout).to.be.a('function');
  })",snuts
/packages/@pollyjs/utils/tests/unit/utils/polly-error-test.js,AnonymousTest,"{'startLine':4,'endLine':6}","it('should exist', function () {
    expect(PollyError).to.be.a('function');
  })",snuts
/packages/@pollyjs/utils/tests/unit/utils/build-url-test.js,AnonymousTest,"{'startLine':6,'endLine':8}","it('should exist', function () {
    expect(buildUrl).to.be.a('function');
  })",snuts
/packages/@pollyjs/utils/tests/unit/utils/build-url-test.js,IdenticalTestDescription,"{'startLine':20,'endLine':22}","it('should remove empty fragments of the url', function () {
    expect(buildUrl('/foo/bar/baz')).to.equal(`${origin}/foo/bar/baz`);
  })",snuts
/packages/@pollyjs/utils/tests/unit/utils/assert-test.js,AnonymousTest,"{'startLine':5,'endLine':7}","it('should exist', function () {
    expect(assert).to.be.a('function');
  })",snuts
/packages/@pollyjs/core/tests/unit/utils/timing-test.js,AnonymousTest,"{'startLine':44,'endLine':48}","it('should exist', function () {
    expect(Timing).to.be.a('object');
    expect(Timing.fixed).to.be.a('function');
    expect(Timing.relative).to.be.a('function');
  })",snuts
/packages/@pollyjs/core/tests/unit/utils/remove-host-from-url-test.js,AnonymousTest,"{'startLine':6,'endLine':8}","it('should exist', function () {
    expect(removeHost).to.be.a('function');
  })",snuts
/packages/@pollyjs/core/tests/unit/utils/parse-url-test.js,AnonymousTest,"{'startLine':4,'endLine':6}","it('should exist', function () {
    expect(parseUrl).to.be.a('function');
  })",snuts
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,AnonymousTest,"{'startLine':9,'endLine':14}","it('should exist', function () {
    expect(url).to.be.a('function');
    expect(body).to.be.a('function');
    expect(method).to.be.a('function');
    expect(headers).to.be.a('function');
  })",snuts
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,IdenticalTestDescription,"{'startLine':72,'endLine':87}","it('should support a custom fn', function () {
      expect(
        headers(
          {
            Accept: 'foo',
            test: 'test',
            'Content-Type': 'Bar'
          },
          (headers) => {
            delete headers.test;

            return headers;
          }
        )
      ).to.deep.equal({ accept: 'foo', 'content-type': 'Bar' });
    })",snuts
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,IdenticalTestDescription,"{'startLine':89,'endLine':103}","it('should pass the correct arguments to the custom fn', function () {
      const req = {};
      const reqHeaders = { foo: 'foo' };

      headers(
        reqHeaders,
        (headers, request) => {
          expect(headers).to.deep.equal(reqHeaders);
          expect(request).to.equal(req);

          return headers;
        },
        req
      );
    })",snuts
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,IdenticalTestDescription,"{'startLine':197,'endLine':201}","it('should support a custom fn', function () {
      expect(
        url('https://foo.bar/', (url) => url.replace('bar', 'foo'))
      ).to.equal('https://foo.foo/');
    })",snuts
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,IdenticalTestDescription,"{'startLine':203,'endLine':216}","it('should pass the correct arguments to the custom fn', function () {
      const req = {};

      url(
        'https://foo.bar',
        (url, request) => {
          expect(url).to.deep.equal('https://foo.bar');
          expect(request).to.equal(req);

          return url;
        },
        req
      );
    })",snuts
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,IdenticalTestDescription,"{'startLine':237,'endLine':239}","it('should support a custom fn', function () {
      expect(body('foo', (b) => b.toUpperCase())).to.equal('FOO');
    })",snuts
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,IdenticalTestDescription,"{'startLine':241,'endLine':254}","it('should pass the correct arguments to the custom fn', function () {
      const req = {};

      url(
        'body',
        (body, request) => {
          expect(body).to.deep.equal('body');
          expect(request).to.equal(req);

          return body;
        },
        req
      );
    })",snuts
/packages/@pollyjs/core/tests/unit/utils/merge-configs-test.js,AnonymousTest,"{'startLine':4,'endLine':6}","it('should exist', function () {
    expect(mergeConfigs).to.be.a('function');
  })",snuts
/packages/@pollyjs/core/tests/unit/utils/http-headers-test.js,AnonymousTest,"{'startLine':6,'endLine':8}","it('should exist', function () {
    expect(HTTPHeaders).to.be.a('function');
  })",snuts
/packages/@pollyjs/core/tests/unit/utils/guid-for-recording-test.js,AnonymousTest,"{'startLine':4,'endLine':6}","it('should exist', function () {
    expect(guidForRecording).to.be.a('function');
  })",snuts
/packages/@pollyjs/core/tests/unit/utils/deferred-promise-test.js,AnonymousTest,"{'startLine':4,'endLine':8}","it('should exist', function () {
    expect(defer).to.be.a('function');
    expect(defer().resolve).to.be.a('function');
    expect(defer().reject).to.be.a('function');
  })",snuts
/packages/@pollyjs/core/tests/unit/test-helpers/mocha-test.js,AnonymousTest,"{'startLine':22,'endLine':26}","it('should exist', function () {
    expect(setupPolly).to.be.a('function');
    expect(setupPolly.beforeEach).to.be.a('function');
    expect(setupPolly.afterEach).to.be.a('function');
  })",snuts
/packages/@pollyjs/core/tests/unit/server/server-test.js,AnonymousTest,"{'startLine':12,'endLine':15}","it('should exist', function () {
    expect(() => new Server()).to.not.throw();
    expect(new Server()).to.exist;
  })",snuts
/packages/@pollyjs/core/tests/unit/server/server-test.js,NonFunctionalStatement,"{'startLine':76,'endLine':76}","it('should reset the host after scoping', function () {
      server.host('http://foo.bar', () => {});
      server.get('/foo').intercept(() => 200);

      expect(() => request('GET', 'http://foo.bar/foo')).to.throw();
      expect(request('GET', '/foo')).to.equal(200);
    })",snuts
/packages/@pollyjs/core/tests/unit/server/server-test.js,NonFunctionalStatement,"{'startLine':86,'endLine':86}","it('should throw when nesting hosts', function () {
      expect(() => {
        server.host('http://foo.bar', () => {
          server.host('http://bar.baz', () => {});
        });
      }).to.throw();
    })",snuts
/packages/@pollyjs/core/tests/unit/server/server-test.js,NonFunctionalStatement,"{'startLine':92,'endLine':92}","it('should reset the namespace after scoping', function () {
      server.namespace('/api', () => {});
      server.get('/foo').intercept(() => 200);

      expect(() => request('GET', '/api/foo')).to.throw();
      expect(request('GET', '/foo')).to.equal(200);
    })",snuts
/packages/@pollyjs/core/tests/unit/server/server-test.js,NonFunctionalStatement,"{'startLine':119,'endLine':119}","describe('Route Matching', function () {
    beforeEach(function () {
      server = new Server();
    });

    function addHandlers(url) {
      server.get(url).on('request', () => {});
      server.get(url).on('response', () => {});
      server.get(url).intercept(() => {});
    }

    it('should concat handlers for same paths', async function () {
      [
        '/ping',
        '/ping/:id',
        '/ping/*path',
        'http://ping.com',
        'http://ping.com/pong/:id',
        'http://ping.com/pong/*path'
      ].forEach((url) => {
        addHandlers(url);
        expect(server.lookup('GET', url).handlers).to.have.lengthOf(3);
      });
    });

    it('should concat handlers for same paths with a trailing slash', async function () {
      addHandlers('/ping');
      expect(server.lookup('GET', '/ping').handlers).to.have.lengthOf(3);

      addHandlers('/ping/');
      expect(server.lookup('GET', '/ping').handlers).to.have.lengthOf(6);
      expect(server.lookup('GET', '/ping/').handlers).to.have.lengthOf(6);

      addHandlers('http://ping.com');
      expect(server.lookup('GET', 'http://ping.com').handlers).to.have.lengthOf(
        3
      );

      addHandlers('http://ping.com/');
      expect(server.lookup('GET', 'http://ping.com').handlers).to.have.lengthOf(
        6
      );
      expect(
        server.lookup('GET', 'http://ping.com/').handlers
      ).to.have.lengthOf(6);
    });

    it('should concat handlers for same paths with different dynamic segment names', async function () {
      addHandlers('/ping/:id');
      expect(server.lookup('GET', '/ping/:id').handlers).to.have.lengthOf(3);

      addHandlers('/ping/:uuid');
      expect(server.lookup('GET', '/ping/:id').handlers).to.have.lengthOf(6);
      expect(server.lookup('GET', '/ping/:uuid').handlers).to.have.lengthOf(6);
    });

    it('should concat handlers for same paths with different star segment names', async function () {
      addHandlers('/ping/*path');
      expect(server.lookup('GET', '/ping/*path').handlers).to.have.lengthOf(3);

      addHandlers('/ping/*rest');
      expect(server.lookup('GET', '/ping/*path').handlers).to.have.lengthOf(6);
      expect(server.lookup('GET', '/ping/*rest').handlers).to.have.lengthOf(6);
    });

    it('should concat handlers for same paths with different dynamic and star segment names', async function () {
      addHandlers('/ping/:id/pong/*path');
      expect(
        server.lookup('GET', '/ping/:id/pong/*path').handlers
      ).to.have.lengthOf(3);

      addHandlers('/ping/:uuid/pong/*rest');
      expect(
        server.lookup('GET', '/ping/:id/pong/*path').handlers
      ).to.have.lengthOf(6);
      expect(
        server.lookup('GET', '/ping/:uuid/pong/*rest').handlers
      ).to.have.lengthOf(6);
    });
  })",snuts
/packages/@pollyjs/core/tests/unit/server/server-test.js,NonFunctionalStatement,"{'startLine':120,'endLine':120}","describe('Route Matching', function () {
    beforeEach(function () {
      server = new Server();
    });

    function addHandlers(url) {
      server.get(url).on('request', () => {});
      server.get(url).on('response', () => {});
      server.get(url).intercept(() => {});
    }

    it('should concat handlers for same paths', async function () {
      [
        '/ping',
        '/ping/:id',
        '/ping/*path',
        'http://ping.com',
        'http://ping.com/pong/:id',
        'http://ping.com/pong/*path'
      ].forEach((url) => {
        addHandlers(url);
        expect(server.lookup('GET', url).handlers).to.have.lengthOf(3);
      });
    });

    it('should concat handlers for same paths with a trailing slash', async function () {
      addHandlers('/ping');
      expect(server.lookup('GET', '/ping').handlers).to.have.lengthOf(3);

      addHandlers('/ping/');
      expect(server.lookup('GET', '/ping').handlers).to.have.lengthOf(6);
      expect(server.lookup('GET', '/ping/').handlers).to.have.lengthOf(6);

      addHandlers('http://ping.com');
      expect(server.lookup('GET', 'http://ping.com').handlers).to.have.lengthOf(
        3
      );

      addHandlers('http://ping.com/');
      expect(server.lookup('GET', 'http://ping.com').handlers).to.have.lengthOf(
        6
      );
      expect(
        server.lookup('GET', 'http://ping.com/').handlers
      ).to.have.lengthOf(6);
    });

    it('should concat handlers for same paths with different dynamic segment names', async function () {
      addHandlers('/ping/:id');
      expect(server.lookup('GET', '/ping/:id').handlers).to.have.lengthOf(3);

      addHandlers('/ping/:uuid');
      expect(server.lookup('GET', '/ping/:id').handlers).to.have.lengthOf(6);
      expect(server.lookup('GET', '/ping/:uuid').handlers).to.have.lengthOf(6);
    });

    it('should concat handlers for same paths with different star segment names', async function () {
      addHandlers('/ping/*path');
      expect(server.lookup('GET', '/ping/*path').handlers).to.have.lengthOf(3);

      addHandlers('/ping/*rest');
      expect(server.lookup('GET', '/ping/*path').handlers).to.have.lengthOf(6);
      expect(server.lookup('GET', '/ping/*rest').handlers).to.have.lengthOf(6);
    });

    it('should concat handlers for same paths with different dynamic and star segment names', async function () {
      addHandlers('/ping/:id/pong/*path');
      expect(
        server.lookup('GET', '/ping/:id/pong/*path').handlers
      ).to.have.lengthOf(3);

      addHandlers('/ping/:uuid/pong/*rest');
      expect(
        server.lookup('GET', '/ping/:id/pong/*path').handlers
      ).to.have.lengthOf(6);
      expect(
        server.lookup('GET', '/ping/:uuid/pong/*rest').handlers
      ).to.have.lengthOf(6);
    });
  })",snuts
/packages/@pollyjs/core/tests/unit/server/server-test.js,NonFunctionalStatement,"{'startLine':121,'endLine':121}","describe('Route Matching', function () {
    beforeEach(function () {
      server = new Server();
    });

    function addHandlers(url) {
      server.get(url).on('request', () => {});
      server.get(url).on('response', () => {});
      server.get(url).intercept(() => {});
    }

    it('should concat handlers for same paths', async function () {
      [
        '/ping',
        '/ping/:id',
        '/ping/*path',
        'http://ping.com',
        'http://ping.com/pong/:id',
        'http://ping.com/pong/*path'
      ].forEach((url) => {
        addHandlers(url);
        expect(server.lookup('GET', url).handlers).to.have.lengthOf(3);
      });
    });

    it('should concat handlers for same paths with a trailing slash', async function () {
      addHandlers('/ping');
      expect(server.lookup('GET', '/ping').handlers).to.have.lengthOf(3);

      addHandlers('/ping/');
      expect(server.lookup('GET', '/ping').handlers).to.have.lengthOf(6);
      expect(server.lookup('GET', '/ping/').handlers).to.have.lengthOf(6);

      addHandlers('http://ping.com');
      expect(server.lookup('GET', 'http://ping.com').handlers).to.have.lengthOf(
        3
      );

      addHandlers('http://ping.com/');
      expect(server.lookup('GET', 'http://ping.com').handlers).to.have.lengthOf(
        6
      );
      expect(
        server.lookup('GET', 'http://ping.com/').handlers
      ).to.have.lengthOf(6);
    });

    it('should concat handlers for same paths with different dynamic segment names', async function () {
      addHandlers('/ping/:id');
      expect(server.lookup('GET', '/ping/:id').handlers).to.have.lengthOf(3);

      addHandlers('/ping/:uuid');
      expect(server.lookup('GET', '/ping/:id').handlers).to.have.lengthOf(6);
      expect(server.lookup('GET', '/ping/:uuid').handlers).to.have.lengthOf(6);
    });

    it('should concat handlers for same paths with different star segment names', async function () {
      addHandlers('/ping/*path');
      expect(server.lookup('GET', '/ping/*path').handlers).to.have.lengthOf(3);

      addHandlers('/ping/*rest');
      expect(server.lookup('GET', '/ping/*path').handlers).to.have.lengthOf(6);
      expect(server.lookup('GET', '/ping/*rest').handlers).to.have.lengthOf(6);
    });

    it('should concat handlers for same paths with different dynamic and star segment names', async function () {
      addHandlers('/ping/:id/pong/*path');
      expect(
        server.lookup('GET', '/ping/:id/pong/*path').handlers
      ).to.have.lengthOf(3);

      addHandlers('/ping/:uuid/pong/*rest');
      expect(
        server.lookup('GET', '/ping/:id/pong/*path').handlers
      ).to.have.lengthOf(6);
      expect(
        server.lookup('GET', '/ping/:uuid/pong/*rest').handlers
      ).to.have.lengthOf(6);
    });
  })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,AnonymousTest,"{'startLine':4,'endLine':6}","it('should exist', function () {
    expect(Handler).to.be.a('function');
  })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,AnonymousTest,"{'startLine':177,'endLine':187}","it('should work', function () {
      const handler = new Handler();

      expect(handler.has('passthrough')).to.be.false;

      handler.passthrough();
      expect(handler.get('passthrough')).to.be.true;

      handler.passthrough(false);
      expect(handler.get('passthrough')).to.be.false;
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,AnonymousTest,"{'startLine':214,'endLine':225}","it('should work', function () {
      const handler = new Handler();

      expect(handler.has('recordingName')).to.be.false;

      handler.recordingName('Test');
      expect(handler.get('recordingName')).to.equal('Test');

      handler.recordingName();
      expect(handler.has('recordingName')).to.be.true;
      expect(handler.get('recordingName')).to.be.undefined;
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,AnonymousTest,"{'startLine':251,'endLine':264}","it('should work', function () {
      const handler = new Handler();

      expect(handler.get('config')).to.deep.equal({});

      handler.configure({ logLevel: 'info' });
      expect(handler.get('config')).to.deep.equal({ logLevel: 'info' });

      handler.configure({ recordIfMissing: false });
      expect(handler.get('config')).to.deep.equal({ recordIfMissing: false });

      handler.configure({});
      expect(handler.get('config')).to.deep.equal({});
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,AnonymousTest,"{'startLine':290,'endLine':305}","it('should work', function () {
      const handler = new Handler();
      const filters = handler.get('filters');
      const fn = () => {};

      expect(filters.size).to.equal(0);

      handler.filter(fn);
      expect(filters.size).to.equal(1);

      handler.filter(fn);
      expect(filters.size).to.equal(1);

      handler.filter(() => {});
      expect(filters.size).to.equal(2);
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,AnonymousTest,"{'startLine':319,'endLine':333}","it('should work', function () {
      const handler = new Handler();
      const defaultOptions = handler.get('defaultOptions');

      expect(defaultOptions).to.deep.equal({});

      handler.times(1);
      expect(defaultOptions).to.deep.equal({ times: 1 });

      handler.times(2);
      expect(defaultOptions).to.deep.equal({ times: 2 });

      handler.times();
      expect(defaultOptions).to.deep.equal({});
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,IdenticalTestDescription,"{'startLine':214,'endLine':225}","it('should work', function () {
      const handler = new Handler();

      expect(handler.has('recordingName')).to.be.false;

      handler.recordingName('Test');
      expect(handler.get('recordingName')).to.equal('Test');

      handler.recordingName();
      expect(handler.has('recordingName')).to.be.true;
      expect(handler.get('recordingName')).to.be.undefined;
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,IdenticalTestDescription,"{'startLine':251,'endLine':264}","it('should work', function () {
      const handler = new Handler();

      expect(handler.get('config')).to.deep.equal({});

      handler.configure({ logLevel: 'info' });
      expect(handler.get('config')).to.deep.equal({ logLevel: 'info' });

      handler.configure({ recordIfMissing: false });
      expect(handler.get('config')).to.deep.equal({ recordIfMissing: false });

      handler.configure({});
      expect(handler.get('config')).to.deep.equal({});
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,IdenticalTestDescription,"{'startLine':290,'endLine':305}","it('should work', function () {
      const handler = new Handler();
      const filters = handler.get('filters');
      const fn = () => {};

      expect(filters.size).to.equal(0);

      handler.filter(fn);
      expect(filters.size).to.equal(1);

      handler.filter(fn);
      expect(filters.size).to.equal(1);

      handler.filter(() => {});
      expect(filters.size).to.equal(2);
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,IdenticalTestDescription,"{'startLine':319,'endLine':333}","it('should work', function () {
      const handler = new Handler();
      const defaultOptions = handler.get('defaultOptions');

      expect(defaultOptions).to.deep.equal({});

      handler.times(1);
      expect(defaultOptions).to.deep.equal({ times: 1 });

      handler.times(2);
      expect(defaultOptions).to.deep.equal({ times: 2 });

      handler.times();
      expect(defaultOptions).to.deep.equal({});
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,IdenticalTestDescription,"{'startLine':335,'endLine':341}","it('throws when passing an invalid times option', function () {
      const handler = new Handler();

      ['1', -1, 0].forEach((times) => {
        expect(() => handler.times(times)).to.throw(/Invalid number provided/);
      });
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,NonFunctionalStatement,"{'startLine':27,'endLine':27}","it('registers a known event via .on()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;

      expect(eventEmitter.hasListeners('request')).to.be.false;

      handler.on('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;

      handler.on('request', () => {});
      expect(eventEmitter.listeners('request')).to.have.lengthOf(2);
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,NonFunctionalStatement,"{'startLine':30,'endLine':30}","it('registers a known event via .on()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;

      expect(eventEmitter.hasListeners('request')).to.be.false;

      handler.on('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;

      handler.on('request', () => {});
      expect(eventEmitter.listeners('request')).to.have.lengthOf(2);
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,NonFunctionalStatement,"{'startLine':38,'endLine':38}","it('registers a known event via .on() with { times }', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;

      handler.on('request', () => {}, { times: 2 });
      expect(eventEmitter.hasListeners('request')).to.be.true;

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.true;

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,NonFunctionalStatement,"{'startLine':52,'endLine':52}","it('registers a known event via .on() with .times()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;

      handler.times(2).on('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.true;

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,NonFunctionalStatement,"{'startLine':66,'endLine':66}","it('registers a known event via .on() with .times() and override with { times }', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;

      handler.times(2).on('request', () => {}, { times: 1 });
      expect(eventEmitter.hasListeners('request')).to.be.true;

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,NonFunctionalStatement,"{'startLine':79,'endLine':79}","it('registers a known event via .once()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;

      expect(eventEmitter.hasListeners('request')).to.be.false;

      handler.once('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;

      handler.once('request', () => {});
      expect(eventEmitter.listeners('request')).to.have.lengthOf(2);

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,NonFunctionalStatement,"{'startLine':82,'endLine':82}","it('registers a known event via .once()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;

      expect(eventEmitter.hasListeners('request')).to.be.false;

      handler.once('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;

      handler.once('request', () => {});
      expect(eventEmitter.listeners('request')).to.have.lengthOf(2);

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,NonFunctionalStatement,"{'startLine':92,'endLine':92}","it('un-registers a known event via .off()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;
      const fn = () => {};

      handler.on('request', fn);
      handler.on('request', () => {});
      handler.on('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(3);

      handler.off('request', fn);
      expect(eventEmitter.hasListeners('request')).to.be.true;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(2);
      expect(eventEmitter.listeners('request').includes(fn)).to.be.false;

      handler.off('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(0);
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,NonFunctionalStatement,"{'startLine':95,'endLine':95}","it('un-registers a known event via .off()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;
      const fn = () => {};

      handler.on('request', fn);
      handler.on('request', () => {});
      handler.on('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(3);

      handler.off('request', fn);
      expect(eventEmitter.hasListeners('request')).to.be.true;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(2);
      expect(eventEmitter.listeners('request').includes(fn)).to.be.false;

      handler.off('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(0);
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,NonFunctionalStatement,"{'startLine':96,'endLine':96}","it('un-registers a known event via .off()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;
      const fn = () => {};

      handler.on('request', fn);
      handler.on('request', () => {});
      handler.on('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(3);

      handler.off('request', fn);
      expect(eventEmitter.hasListeners('request')).to.be.true;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(2);
      expect(eventEmitter.listeners('request').includes(fn)).to.be.false;

      handler.off('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(0);
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,NonFunctionalStatement,"{'startLine':115,'endLine':115}","it('registers an intercept handler', function () {
      const handler = new Handler();

      handler.intercept(() => {});
      expect(handler.has('intercept')).to.be.true;
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,NonFunctionalStatement,"{'startLine':133,'endLine':133}","it('throws when passing an invalid times option', function () {
      const handler = new Handler();

      ['1', -1, 0].forEach((times) => {
        expect(() => handler.intercept(() => {}, { times })).to.throw(
          /Invalid number provided/
        );
      });
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,NonFunctionalStatement,"{'startLine':142,'endLine':142}","it('registers an intercept handler with { times }', function () {
      const handler = new Handler();

      handler.intercept(() => {}, { times: 2 });
      expect(handler.has('intercept')).to.be.true;

      handler.get('intercept')();
      expect(handler.has('intercept')).to.be.true;

      handler.get('intercept')();
      expect(handler.has('intercept')).to.be.false;
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,NonFunctionalStatement,"{'startLine':155,'endLine':155}","it('registers an intercept handler with .times()', function () {
      const handler = new Handler();

      handler.times(2).intercept(() => {});
      expect(handler.has('intercept')).to.be.true;

      handler.get('intercept')();
      expect(handler.has('intercept')).to.be.true;

      handler.get('intercept')();
      expect(handler.has('intercept')).to.be.false;
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,NonFunctionalStatement,"{'startLine':168,'endLine':168}","it('registers an intercept handler with .times() and override with { times }', function () {
      const handler = new Handler();

      handler.times(2).intercept(() => {}, { times: 1 });
      expect(handler.has('intercept')).to.be.true;

      handler.get('intercept')();
      expect(handler.has('intercept')).to.be.false;
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,NonFunctionalStatement,"{'startLine':192,'endLine':192}","it('removes the intercept handler on passthrough', function () {
      const handler = new Handler();

      handler.intercept(() => {});
      expect(handler.has('intercept')).to.be.true;

      handler.passthrough();
      expect(handler.get('passthrough')).to.be.true;
      expect(handler.has('intercept')).to.be.false;
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,NonFunctionalStatement,"{'startLine':207,'endLine':207}","it('disables passthrough on intercept', function () {
      const handler = new Handler();

      handler.passthrough();
      expect(handler.get('passthrough')).to.be.true;
      expect(handler.has('intercept')).to.be.false;

      handler.intercept(() => {});
      expect(handler.has('intercept')).to.be.true;
      expect(handler.get('passthrough')).to.be.false;
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,NonFunctionalStatement,"{'startLine':293,'endLine':293}","it('should work', function () {
      const handler = new Handler();
      const filters = handler.get('filters');
      const fn = () => {};

      expect(filters.size).to.equal(0);

      handler.filter(fn);
      expect(filters.size).to.equal(1);

      handler.filter(fn);
      expect(filters.size).to.equal(1);

      handler.filter(() => {});
      expect(filters.size).to.equal(2);
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,NonFunctionalStatement,"{'startLine':303,'endLine':303}","it('should work', function () {
      const handler = new Handler();
      const filters = handler.get('filters');
      const fn = () => {};

      expect(filters.size).to.equal(0);

      handler.filter(fn);
      expect(filters.size).to.equal(1);

      handler.filter(fn);
      expect(filters.size).to.equal(1);

      handler.filter(() => {});
      expect(filters.size).to.equal(2);
    })",snuts
/packages/@pollyjs/core/tests/unit/server/handler-test.js,VerboseStatement,"{'startLine':89,'endLine':108}","it('un-registers a known event via .off()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;
      const fn = () => {};

      handler.on('request', fn);
      handler.on('request', () => {});
      handler.on('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(3);

      handler.off('request', fn);
      expect(eventEmitter.hasListeners('request')).to.be.true;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(2);
      expect(eventEmitter.listeners('request').includes(fn)).to.be.false;

      handler.off('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(0);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/response-test.js,AnonymousTest,"{'startLine':8,'endLine':11}","it('should exist', function () {
    expect(() => new PollyResponse()).to.not.throw();
    expect(new PollyResponse()).to.exist;
  })",snuts
/packages/@pollyjs/core/tests/unit/-private/response-test.js,AnonymousTest,"{'startLine':26,'endLine':39}","it('.status()', function () {
      [100, '404', 500, '599'].forEach((statusCode) => {
        expect(response.status(statusCode).statusCode).to.equal(
          Number(statusCode)
        );
      });

      [null, '', 0, 99, 600, 999].forEach((statusCode) => {
        expect(() => response.status(statusCode)).to.throw(
          PollyError,
          /Invalid status code/
        );
      });
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/response-test.js,AnonymousTest,"{'startLine':41,'endLine':48}","it('.sendStatus()', function () {
      response.sendStatus(200);

      expect(response.body).to.equal('OK');
      expect(response.getHeader('Content-Type')).to.equal(
        'text/plain; charset=utf-8'
      );
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/response-test.js,AnonymousTest,"{'startLine':50,'endLine':63}","it('.end()', function () {
      response.status(200);
      response.setHeader('foo', 'bar');

      expect(response.statusCode).to.equal(200);
      expect(response.headers).to.deep.equal({ foo: 'bar' });

      response.end();
      expect(() => response.status(404)).to.throw();
      expect(() => response.setHeader('bar', 'baz')).to.throw();

      expect(response.statusCode).to.equal(200);
      expect(response.headers).to.deep.equal({ foo: 'bar' });
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/interceptor-test.js,AnonymousTest,"{'startLine':4,'endLine':6}","it('should exist', function () {
    expect(Interceptor).to.be.a('function');
  })",snuts
/packages/@pollyjs/core/tests/unit/-private/interceptor-test.js,AnonymousTest,"{'startLine':33,'endLine':43}","it('.abort()', function () {
    const interceptor = new Interceptor();

    expect(interceptor.shouldAbort).to.be.false;
    expect(interceptor.shouldIntercept).to.be.true;

    interceptor.abort();

    expect(interceptor.shouldAbort).to.be.true;
    expect(interceptor.shouldIntercept).to.be.false;
  })",snuts
/packages/@pollyjs/core/tests/unit/-private/interceptor-test.js,AnonymousTest,"{'startLine':45,'endLine':55}","it('.passthrough()', function () {
    const interceptor = new Interceptor();

    expect(interceptor.shouldPassthrough).to.be.false;
    expect(interceptor.shouldIntercept).to.be.true;

    interceptor.passthrough();

    expect(interceptor.shouldPassthrough).to.be.true;
    expect(interceptor.shouldIntercept).to.be.false;
  })",snuts
/packages/@pollyjs/core/tests/unit/-private/interceptor-test.js,AnonymousTest,"{'startLine':57,'endLine':63}","it('.stopPropagation()', function () {
    const interceptor = new Interceptor();

    expect(interceptor.shouldStopPropagating).to.be.false;
    interceptor.stopPropagation();
    expect(interceptor.shouldStopPropagating).to.be.true;
  })",snuts
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,AnonymousTest,"{'startLine':8,'endLine':11}","it('should exist', function () {
    expect(() => new HTTPBase()).to.not.throw();
    expect(new HTTPBase()).to.exist;
  })",snuts
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,AnonymousTest,"{'startLine':18,'endLine':31}","it('.getHeader()', function () {
      const { headers } = base;

      base.setHeader('One', '1');
      expect(headers).to.deep.equal({ one: '1' });

      expect(base.getHeader('One')).to.equal('1');
      expect(base.getHeader('one')).to.equal('1');
      expect(base.getHeader('Two')).to.be.undefined;

      base.removeHeader('One');
      expect(base.getHeader('One')).to.be.undefined;
      expect(base.getHeader('one')).to.be.undefined;
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,AnonymousTest,"{'startLine':33,'endLine':46}","it('.hasHeader()', function () {
      const { headers } = base;

      base.setHeader('One', '1');
      expect(headers).to.deep.equal({ one: '1' });

      expect(base.hasHeader('One')).to.be.true;
      expect(base.hasHeader('one')).to.be.true;
      expect(base.hasHeader('Two')).to.be.false;

      base.removeHeader('One');
      expect(base.hasHeader('One')).to.be.false;
      expect(base.hasHeader('one')).to.be.false;
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,AnonymousTest,"{'startLine':48,'endLine':59}","it('.setHeader()', function () {
      const { headers } = base;

      base.setHeader('One', '1');
      expect(headers).to.deep.equal({ one: '1' });

      base.setHeader('two', '2');
      expect(headers).to.deep.equal({ one: '1', two: '2' });

      base.setHeader('Two', null);
      expect(headers).to.deep.equal({ one: '1' });
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,AnonymousTest,"{'startLine':61,'endLine':72}","it('.setHeaders()', function () {
      const { headers } = base;

      base.setHeaders({ One: '1', two: '2' });
      expect(headers).to.deep.equal({ one: '1', two: '2' });

      base.setHeaders({ Three: '3' });
      expect(headers).to.deep.equal({ one: '1', two: '2', three: '3' });

      base.setHeaders({ Three: null });
      expect(headers).to.deep.equal({ one: '1', two: '2' });
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,AnonymousTest,"{'startLine':74,'endLine':84}","it('.removeHeader()', function () {
      const { headers } = base;

      base.setHeaders({ One: '1', Two: '2' });

      base.removeHeader('One');
      expect(headers).to.deep.equal({ two: '2' });

      base.removeHeader('two');
      expect(headers).to.deep.equal({});
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,AnonymousTest,"{'startLine':86,'endLine':93}","it('.removeHeaders()', function () {
      const { headers } = base;

      base.setHeaders({ One: '1', Two: '2' });

      base.removeHeaders(['One', 'two']);
      expect(headers).to.deep.equal({});
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,AnonymousTest,"{'startLine':95,'endLine':98}","it('.type()', function () {
      base.type('text/plain');
      expect(base.getHeader('Content-Type')).to.equal('text/plain');
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,AnonymousTest,"{'startLine':143,'endLine':152}","it('.json()', function () {
      const obj = { foo: 'bar' };

      base.json(obj);

      expect(base.body).to.equal(stringify(obj));
      expect(base.getHeader('Content-Type')).to.equal(
        'application/json; charset=utf-8'
      );
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,AnonymousTest,"{'startLine':166,'endLine':173}","it('.jsonBody()', function () {
      const obj = { foo: 'bar' };

      expect(() => base.jsonBody()).to.throw(Error);

      base.json(obj);
      expect(base.jsonBody()).to.deep.equal(obj);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,AnonymousTest,"{'startLine':175,'endLine':183}","it('.end()', function () {
      base.setHeader('foo', 'bar');

      expect(base.headers).to.deep.equal({ foo: 'bar' });

      base.end();
      expect(() => base.setHeader('bar', 'baz')).to.throw();
      expect(base.headers).to.deep.equal({ foo: 'bar' });
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-test.js,AnonymousTest,"{'startLine':8,'endLine':10}","it('should exist', function () {
    expect(Event).to.be.a('function');
  })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-test.js,AnonymousTest,"{'startLine':37,'endLine':43}","it('.stopPropagation()', function () {
    const event = new Event(EVENT_TYPE);

    expect(event.shouldStopPropagating).to.be.false;
    event.stopPropagation();
    expect(event.shouldStopPropagating).to.be.true;
  })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,AnonymousTest,"{'startLine':26,'endLine':29}","it('should exist', function () {
    expect(() => new EventEmitter({ eventNames: ['a'] })).to.not.throw();
    expect(new EventEmitter({ eventNames: ['a'] })).to.exist;
  })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,AnonymousTest,"{'startLine':46,'endLine':57}","it('.eventNames()', function () {
      const listener = () => {};

      expect(emitter.eventNames()).to.have.lengthOf(0);

      emitter.on('a', listener);
      emitter.on('b', listener);
      expect(emitter.eventNames()).to.have.ordered.members(['a', 'b']);

      emitter.off('a', listener);
      expect(emitter.eventNames()).to.have.ordered.members(['b']);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,AnonymousTest,"{'startLine':59,'endLine':75}","it('.on()', async function () {
      assertEventName('on');
      assertListener('on');

      let listenerCalled = 0;
      const listener = () => listenerCalled++;

      emitter.on('a', listener);
      emitter.on('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.on('a', () => {});
      expect(emitter.listeners('a')).to.have.lengthOf(2);

      await emitter.emit('a');
      expect(listenerCalled).to.equal(1);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,AnonymousTest,"{'startLine':106,'endLine':128}","it('.once()', async function () {
      assertEventName('once');
      assertListener('once');

      let listenerCalled = 0;
      const listener = () => listenerCalled++;

      emitter.once('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      await emitter.emit('a');
      expect(listenerCalled).to.equal(1);
      expect(emitter.listeners('a')).to.have.lengthOf(0);

      await emitter.emit('a');
      expect(listenerCalled).to.equal(1);

      emitter.once('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,AnonymousTest,"{'startLine':130,'endLine':151}","it('.off()', async function () {
      assertEventName('off');

      const listener = () => {};

      emitter.on('a', listener);
      emitter.on('a', () => {});
      emitter.on('a', () => {});
      expect(emitter.listeners('a')).to.have.lengthOf(3);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(2);

      emitter.off('a');
      expect(emitter.listeners('a')).to.have.lengthOf(0);

      emitter.on('a', listener, { times: 3 });
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,AnonymousTest,"{'startLine':153,'endLine':169}","it('.listeners()', async function () {
      assertEventName('listeners');

      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.deep.equal([]);

      emitter.on('a', () => {});
      emitter.on('b', () => {});
      emitter.on('b', () => {});
      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.have.lengthOf(1);
      expect(emitter.listeners('b')).to.have.lengthOf(2);

      emitter.off('b');
      expect(emitter.listeners('b')).to.be.an('array');
      expect(emitter.listeners('b')).to.have.lengthOf(0);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,AnonymousTest,"{'startLine':171,'endLine':181}","it('.hasListeners()', async function () {
      assertEventName('hasListeners');

      expect(emitter.hasListeners('a')).to.be.false;

      emitter.on('a', () => {});
      expect(emitter.hasListeners('a')).to.be.true;

      emitter.off('a');
      expect(emitter.hasListeners('a')).to.be.false;
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,AnonymousTest,"{'startLine':183,'endLine':197}","it('.emit()', async function () {
      expect(emitter.emit('a')).to.be.a('promise');

      const array = [];

      emitter.on('a', () => array.push(1));
      emitter.on('a', async () => {
        await timeout(10);
        array.push(2);
      });
      emitter.on('a', () => array.push(3));

      expect(await emitter.emit('a')).to.be.true;
      expect(array).to.have.ordered.members([1, 2, 3]);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,AnonymousTest,"{'startLine':212,'endLine':229}","it('.emitParallel()', async function () {
      expect(emitter.emitParallel('a')).to.be.a('promise');

      const array = [];

      emitter.on('a', () => array.push(1));
      emitter.on('a', async () => {
        await timeout(20);
        array.push(2);
      });
      emitter.on('a', async () => {
        await timeout(10);
        array.push(3);
      });

      expect(await emitter.emitParallel('a')).to.be.true;
      expect(array).to.have.ordered.members([1, 3, 2]);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,AnonymousTest,"{'startLine':244,'endLine':259}","it('.emitSync()', async function () {
      emitter.once('a', () => Promise.resolve());
      expect(() => emitter.emitSync('a')).to.throw(
        PollyError,
        /Attempted to emit a synchronous event/
      );

      const array = [];

      emitter.on('a', () => array.push(1));
      emitter.on('a', () => array.push(2));
      emitter.on('a', () => array.push(3));

      expect(emitter.emitSync('a')).to.be.true;
      expect(array).to.have.ordered.members([1, 2, 3]);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,NonFunctionalStatement,"{'startLine':47,'endLine':47}","it('.eventNames()', function () {
      const listener = () => {};

      expect(emitter.eventNames()).to.have.lengthOf(0);

      emitter.on('a', listener);
      emitter.on('b', listener);
      expect(emitter.eventNames()).to.have.ordered.members(['a', 'b']);

      emitter.off('a', listener);
      expect(emitter.eventNames()).to.have.ordered.members(['b']);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,NonFunctionalStatement,"{'startLine':70,'endLine':70}","it('.on()', async function () {
      assertEventName('on');
      assertListener('on');

      let listenerCalled = 0;
      const listener = () => listenerCalled++;

      emitter.on('a', listener);
      emitter.on('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.on('a', () => {});
      expect(emitter.listeners('a')).to.have.lengthOf(2);

      await emitter.emit('a');
      expect(listenerCalled).to.equal(1);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,NonFunctionalStatement,"{'startLine':133,'endLine':133}","it('.off()', async function () {
      assertEventName('off');

      const listener = () => {};

      emitter.on('a', listener);
      emitter.on('a', () => {});
      emitter.on('a', () => {});
      expect(emitter.listeners('a')).to.have.lengthOf(3);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(2);

      emitter.off('a');
      expect(emitter.listeners('a')).to.have.lengthOf(0);

      emitter.on('a', listener, { times: 3 });
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,NonFunctionalStatement,"{'startLine':136,'endLine':136}","it('.off()', async function () {
      assertEventName('off');

      const listener = () => {};

      emitter.on('a', listener);
      emitter.on('a', () => {});
      emitter.on('a', () => {});
      expect(emitter.listeners('a')).to.have.lengthOf(3);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(2);

      emitter.off('a');
      expect(emitter.listeners('a')).to.have.lengthOf(0);

      emitter.on('a', listener, { times: 3 });
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,NonFunctionalStatement,"{'startLine':137,'endLine':137}","it('.off()', async function () {
      assertEventName('off');

      const listener = () => {};

      emitter.on('a', listener);
      emitter.on('a', () => {});
      emitter.on('a', () => {});
      expect(emitter.listeners('a')).to.have.lengthOf(3);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(2);

      emitter.off('a');
      expect(emitter.listeners('a')).to.have.lengthOf(0);

      emitter.on('a', listener, { times: 3 });
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,NonFunctionalStatement,"{'startLine':159,'endLine':159}","it('.listeners()', async function () {
      assertEventName('listeners');

      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.deep.equal([]);

      emitter.on('a', () => {});
      emitter.on('b', () => {});
      emitter.on('b', () => {});
      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.have.lengthOf(1);
      expect(emitter.listeners('b')).to.have.lengthOf(2);

      emitter.off('b');
      expect(emitter.listeners('b')).to.be.an('array');
      expect(emitter.listeners('b')).to.have.lengthOf(0);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,NonFunctionalStatement,"{'startLine':160,'endLine':160}","it('.listeners()', async function () {
      assertEventName('listeners');

      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.deep.equal([]);

      emitter.on('a', () => {});
      emitter.on('b', () => {});
      emitter.on('b', () => {});
      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.have.lengthOf(1);
      expect(emitter.listeners('b')).to.have.lengthOf(2);

      emitter.off('b');
      expect(emitter.listeners('b')).to.be.an('array');
      expect(emitter.listeners('b')).to.have.lengthOf(0);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,NonFunctionalStatement,"{'startLine':161,'endLine':161}","it('.listeners()', async function () {
      assertEventName('listeners');

      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.deep.equal([]);

      emitter.on('a', () => {});
      emitter.on('b', () => {});
      emitter.on('b', () => {});
      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.have.lengthOf(1);
      expect(emitter.listeners('b')).to.have.lengthOf(2);

      emitter.off('b');
      expect(emitter.listeners('b')).to.be.an('array');
      expect(emitter.listeners('b')).to.have.lengthOf(0);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,NonFunctionalStatement,"{'startLine':176,'endLine':176}","it('.hasListeners()', async function () {
      assertEventName('hasListeners');

      expect(emitter.hasListeners('a')).to.be.false;

      emitter.on('a', () => {});
      expect(emitter.hasListeners('a')).to.be.true;

      emitter.off('a');
      expect(emitter.hasListeners('a')).to.be.false;
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,VerboseStatement,"{'startLine':77,'endLine':104}","it('.on(listener, { times })', async function () {
      assertEventName('on');
      assertListener('on');

      let listenerCalled = 0;
      const listener = () => listenerCalled++;

      expect(() => emitter.on('a', listener, { times: '1' })).to.throw(
        PollyError,
        /Invalid number provided/
      );

      expect(() => emitter.on('a', listener, { times: -1 })).to.throw(
        PollyError,
        /The number must be greater than 0/
      );

      emitter.on('a', listener, { times: 1 });
      emitter.on('a', listener, { times: 2 });
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      await emitter.emit('a');
      await emitter.emit('a');
      await emitter.emit('a');

      expect(listenerCalled).to.equal(2);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,VerboseStatement,"{'startLine':106,'endLine':128}","it('.once()', async function () {
      assertEventName('once');
      assertListener('once');

      let listenerCalled = 0;
      const listener = () => listenerCalled++;

      emitter.once('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      await emitter.emit('a');
      expect(listenerCalled).to.equal(1);
      expect(emitter.listeners('a')).to.have.lengthOf(0);

      await emitter.emit('a');
      expect(listenerCalled).to.equal(1);

      emitter.once('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,VerboseStatement,"{'startLine':130,'endLine':151}","it('.off()', async function () {
      assertEventName('off');

      const listener = () => {};

      emitter.on('a', listener);
      emitter.on('a', () => {});
      emitter.on('a', () => {});
      expect(emitter.listeners('a')).to.have.lengthOf(3);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(2);

      emitter.off('a');
      expect(emitter.listeners('a')).to.have.lengthOf(0);

      emitter.on('a', listener, { times: 3 });
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/container-test.js,AnonymousTest,"{'startLine':18,'endLine':21}","it('should exist', function () {
    expect(() => new Container()).to.not.throw();
    expect(new Container()).to.exist;
  })",snuts
/packages/@pollyjs/core/tests/unit/-private/container-test.js,AnonymousTest,"{'startLine':28,'endLine':31}","it('.register()', function () {
      container.register(Factory);
      expect(container.has('factory:factory-id')).to.be.true;
    })",snuts
/packages/@pollyjs/core/tests/unit/-private/container-test.js,AnonymousTest,"{'startLine':76,'endLine':80}","it('.lookup()', function () {
      container.register(Factory);
      expect(container.lookup('factory:factory-id')).to.equal(Factory);
      expect(container.lookup('factory:bar')).to.be.null;
    })",snuts
/packages/@pollyjs/adapter/tests/unit/utils/is-expired-test.js,AnonymousTest,"{'startLine':4,'endLine':6}","it('should exist', function () {
    expect(isExpired).to.be.a('function');
  })",snuts
/packages/@pollyjs/adapter/tests/unit/utils/is-expired-test.js,AnonymousTest,"{'startLine':8,'endLine':21}","it('should work', function () {
    [
      [undefined, undefined, false],
      [null, null, false],
      [new Date(), undefined, false],
      [undefined, '1 day', false],
      [new Date(), '1 day', false],
      [new Date('1/1/2018'), '100 years', false],
      [new Date('1/1/2017'), '1y', true],
      [new Date('1/1/2018'), '1m5d10h', true]
    ].forEach(([recordedOn, expiresIn, value]) => {
      expect(isExpired(recordedOn, expiresIn)).to.equal(value);
    });
  })",snuts
/packages/@pollyjs/adapter/tests/unit/utils/dehumanize-time-test.js,AnonymousTest,"{'startLine':4,'endLine':6}","it('should exist', function () {
    expect(dehumanizeTime).to.be.a('function');
  })",snuts
/packages/@pollyjs/adapter/tests/unit/utils/dehumanize-time-test.js,AnonymousTest,"{'startLine':8,'endLine':35}","it('should work', function () {
    expect(dehumanizeTime(null)).to.be.NaN;
    expect(dehumanizeTime(undefined)).to.be.NaN;
    expect(dehumanizeTime(true)).to.be.NaN;
    expect(dehumanizeTime(false)).to.be.NaN;

    [
      [['1ms', '1millisecond', '1 milliseconds'], 1],
      [['10ms', '10millisecond', '10 milliseconds'], 10],
      [['100ms', '100millisecond', '100 milliseconds'], 100],
      [['1s', '1sec', '1secs', '1 second', '1 seconds'], 1000],
      [['1.5s', '1.5sec', '1.5secs', '1.5 second', '1.5 seconds'], 1500],
      [['1m', '1min', '1mins', '1 minute', '1 minutes'], 1000 * 60],
      [['1h', '1hr', '1hrs', '1 hour', '1 hours'], 1000 * 60 * 60],
      [['1d', '1day', '1 days'], 1000 * 60 * 60 * 24],
      [['1w', '1wk', '1wks', '1 week', '1 weeks'], 1000 * 60 * 60 * 24 * 7],
      [['1y', '1yr', '1 yrs', '1 year', '1 years'], 1000 * 60 * 60 * 24 * 365],
      [
        [
          '1y 2 wks 3day 4 minutes 5secs 6 ms',
          '6 millisecond 5s 4 min 3d 2 weeks 1yrs'
        ],
        33005045006
      ]
    ].forEach(([inputs, value]) => {
      inputs.forEach((str) => expect(dehumanizeTime(str)).to.equal(value));
    });
  })",snuts
/packages/@pollyjs/adapter-node-http/tests/jest/integration/xhr-test.js,AnonymousTest,"{'startLine':28,'endLine':45}","test('it works', async () => {
    polly.recordingName += '/it works';

    const { persister, recordingId } = polly;

    expect((await request('/api/db/foo')).status).toBe(404);
    await persister.persist();

    const har = await persister.findRecording(recordingId);

    expect(har).toBeDefined();
    expect(har.log.entries.length).toBe(1);
    expect(har.log.entries[0].request.url.includes('/api/db/foo')).toBe(true);
    expect(har.log.entries[0].response.status).toBe(404);

    await persister.deleteRecording(recordingId);
    expect(persister.findRecording(recordingId)).resolves.toBeNull();
  })",snuts
/packages/@pollyjs/adapter-node-http/tests/jest/integration/xhr-test.js,SubOptimalAssert,"{'startLine':39,'endLine':39}","test('it works', async () => {
    polly.recordingName += '/it works';

    const { persister, recordingId } = polly;

    expect((await request('/api/db/foo')).status).toBe(404);
    await persister.persist();

    const har = await persister.findRecording(recordingId);

    expect(har).toBeDefined();
    expect(har.log.entries.length).toBe(1);
    expect(har.log.entries[0].request.url.includes('/api/db/foo')).toBe(true);
    expect(har.log.entries[0].response.status).toBe(404);

    await persister.deleteRecording(recordingId);
    expect(persister.findRecording(recordingId)).resolves.toBeNull();
  })",snuts
/packages/@pollyjs/adapter-node-http/tests/jest/integration/fetch-test.js,AnonymousTest,"{'startLine':16,'endLine':33}","test('it works', async () => {
    polly.recordingName += '/it works';

    const { persister, recordingId } = polly;

    expect((await fetch('http://localhost:4000/api/db/foo')).status).toBe(404);
    await persister.persist();

    const har = await persister.findRecording(recordingId);

    expect(har).toBeDefined();
    expect(har.log.entries.length).toBe(1);
    expect(har.log.entries[0].request.url.includes('/api/db/foo')).toBe(true);
    expect(har.log.entries[0].response.status).toBe(404);

    await persister.deleteRecording(recordingId);
    expect(persister.findRecording(recordingId)).resolves.toBeNull();
  })",snuts
/packages/@pollyjs/adapter-node-http/tests/jest/integration/fetch-test.js,SubOptimalAssert,"{'startLine':27,'endLine':27}","test('it works', async () => {
    polly.recordingName += '/it works';

    const { persister, recordingId } = polly;

    expect((await fetch('http://localhost:4000/api/db/foo')).status).toBe(404);
    await persister.persist();

    const har = await persister.findRecording(recordingId);

    expect(har).toBeDefined();
    expect(har.log.entries.length).toBe(1);
    expect(har.log.entries[0].request.url.includes('/api/db/foo')).toBe(true);
    expect(har.log.entries[0].response.status).toBe(404);

    await persister.deleteRecording(recordingId);
    expect(persister.findRecording(recordingId)).resolves.toBeNull();
  })",snuts
/packages/@pollyjs/adapter-node-http/tests/unit/utils/merge-chunks-test.js,AnonymousTest,"{'startLine':4,'endLine':6}","it('should exist', function () {
    expect(mergeChunks).to.be.a('function');
  })",snuts
/packages/@pollyjs/adapter-node-http/tests/unit/utils/merge-chunks-test.js,AnonymousTest,"{'startLine':8,'endLine':25}","it('should work', function () {
    [null, []].forEach((chunks) => {
      const buffer = mergeChunks(chunks);

      expect(Buffer.isBuffer(buffer)).to.be.true;
      expect(buffer.toString()).to.have.lengthOf(0);
    });

    const str = mergeChunks(['T', 'e', 's', 't']);

    expect(Buffer.isBuffer(str)).to.be.false;
    expect(str).to.equal('Test');

    const buffer = mergeChunks(['T', 'e', 's', 't'].map((c) => Buffer.from(c)));

    expect(Buffer.isBuffer(buffer)).to.be.true;
    expect(buffer.toString()).to.equal('Test');
  })",snuts
/tests/helpers/setup-persister.js,NonFunctionalStatement,"{'startLine':6,'endLine':6}",Unknown,snuts
/packages/@pollyjs/ember/tests/dummy/app/router.js,NonFunctionalStatement,"{'startLine':9,'endLine':9}",Unknown,snuts
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 12, 'column': 4, 'index': 332}","it('should persist valid HAR', async function () {
    const { recordingId, persister } = this.polly;

    this.polly.record();
    await this.fetchRecord();
    await persister.persist();

    expect(await validate.har(await persister.findRecording(recordingId))).to.be
      .true;

    await this.fetchRecord({
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ foo: 'bar', bar: 'baz' })
    });

    await persister.persist();

    expect(await validate.har(await persister.findRecording(recordingId))).to.be
      .true;
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 23, 'column': 4, 'index': 629}","it('should persist valid HAR', async function () {
    const { recordingId, persister } = this.polly;

    this.polly.record();
    await this.fetchRecord();
    await persister.persist();

    expect(await validate.har(await persister.findRecording(recordingId))).to.be
      .true;

    await this.fetchRecord({
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ foo: 'bar', bar: 'baz' })
    });

    await persister.persist();

    expect(await validate.har(await persister.findRecording(recordingId))).to.be
      .true;
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 63, 'column': 4, 'index': 1894}","it('should add new entries to an existing recording', async function () {
    const { recordingId, recordingName, config } = this.polly;
    let { persister } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    this.polly.record();
    await this.fetch(orderedRecordUrl(1));
    await persister.persist();

    let har = await persister.findRecording(recordingId);

    expect(har.log.entries).to.have.lengthOf(1);

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    persister = this.polly.persister;

    this.polly.record();
    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await persister.persist();

    har = await persister.findRecording(recordingId);

    expect(har.log.entries).to.have.lengthOf(3);
    expect(
      har.log.entries.filter((e) => e.request.url.includes(orderedRecordUrl(1)))
    ).to.have.lengthOf(2);
    expect(
      har.log.entries.filter((e) => e.request.url.includes(orderedRecordUrl(2)))
    ).to.have.lengthOf(1);
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 78, 'column': 4, 'index': 2305}","it('should add new entries to an existing recording', async function () {
    const { recordingId, recordingName, config } = this.polly;
    let { persister } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    this.polly.record();
    await this.fetch(orderedRecordUrl(1));
    await persister.persist();

    let har = await persister.findRecording(recordingId);

    expect(har.log.entries).to.have.lengthOf(1);

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    persister = this.polly.persister;

    this.polly.record();
    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await persister.persist();

    har = await persister.findRecording(recordingId);

    expect(har.log.entries).to.have.lengthOf(3);
    expect(
      har.log.entries.filter((e) => e.request.url.includes(orderedRecordUrl(1)))
    ).to.have.lengthOf(2);
    expect(
      har.log.entries.filter((e) => e.request.url.includes(orderedRecordUrl(2)))
    ).to.have.lengthOf(1);
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 92, 'column': 6, 'index': 2815}","it('should emit beforePersist', async function () {
    const { persister, server } = this.polly;
    let beforePersistCalled = false;

    server.get(this.recordUrl()).on('beforePersist', (req /*, res*/) => {
      expect(beforePersistCalled).to.be.false;
      expect(() => (req.body = 'test')).to.throw(Error);
      beforePersistCalled = true;
    });

    this.polly.record();

    await this.fetchRecord();
    expect(beforePersistCalled).to.be.false;

    await persister.persist();
    expect(beforePersistCalled).to.be.true;
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 100, 'column': 4, 'index': 3016}","it('should emit beforePersist', async function () {
    const { persister, server } = this.polly;
    let beforePersistCalled = false;

    server.get(this.recordUrl()).on('beforePersist', (req /*, res*/) => {
      expect(beforePersistCalled).to.be.false;
      expect(() => (req.body = 'test')).to.throw(Error);
      beforePersistCalled = true;
    });

    this.polly.record();

    await this.fetchRecord();
    expect(beforePersistCalled).to.be.false;

    await persister.persist();
    expect(beforePersistCalled).to.be.true;
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 103, 'column': 4, 'index': 3093}","it('should emit beforePersist', async function () {
    const { persister, server } = this.polly;
    let beforePersistCalled = false;

    server.get(this.recordUrl()).on('beforePersist', (req /*, res*/) => {
      expect(beforePersistCalled).to.be.false;
      expect(() => (req.body = 'test')).to.throw(Error);
      beforePersistCalled = true;
    });

    this.polly.record();

    await this.fetchRecord();
    expect(beforePersistCalled).to.be.false;

    await persister.persist();
    expect(beforePersistCalled).to.be.true;
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 261, 'column': 4, 'index': 7870}","it('should remove unused entries when `keepUnusedRequests` is false', async function () {
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: false
      }
    });

    await this.fetch(orderedRecordUrl(1)); // -> Replay
    await this.fetch(orderedRecordUrl(3)); // -> New recording
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(3));
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 262, 'column': 4, 'index': 7906}","it('should remove unused entries when `keepUnusedRequests` is false', async function () {
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: false
      }
    });

    await this.fetch(orderedRecordUrl(1)); // -> Replay
    await this.fetch(orderedRecordUrl(3)); // -> New recording
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(3));
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 280, 'column': 4, 'index': 8394}","it('should remove unused entries when `keepUnusedRequests` is false', async function () {
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: false
      }
    });

    await this.fetch(orderedRecordUrl(1)); // -> Replay
    await this.fetch(orderedRecordUrl(3)); // -> New recording
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(3));
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 281, 'column': 4, 'index': 8430}","it('should remove unused entries when `keepUnusedRequests` is false', async function () {
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: false
      }
    });

    await this.fetch(orderedRecordUrl(1)); // -> Replay
    await this.fetch(orderedRecordUrl(3)); // -> New recording
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(3));
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 302, 'column': 4, 'index': 9142}","it('should sort the entries by date', async function () {
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: true
      }
    });
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(2));

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.record();

    await this.fetch(orderedRecordUrl(3));
    await this.fetch(orderedRecordUrl(4));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(4);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(3));
    expect(har.log.entries[2].request.url).to.include(orderedRecordUrl(4));
    expect(har.log.entries[3].request.url).to.include(orderedRecordUrl(2));
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 303, 'column': 4, 'index': 9178}","it('should sort the entries by date', async function () {
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: true
      }
    });
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(2));

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.record();

    await this.fetch(orderedRecordUrl(3));
    await this.fetch(orderedRecordUrl(4));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(4);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(3));
    expect(har.log.entries[2].request.url).to.include(orderedRecordUrl(4));
    expect(har.log.entries[3].request.url).to.include(orderedRecordUrl(2));
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 304, 'column': 4, 'index': 9227}","it('should sort the entries by date', async function () {
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: true
      }
    });
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(2));

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.record();

    await this.fetch(orderedRecordUrl(3));
    await this.fetch(orderedRecordUrl(4));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(4);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(3));
    expect(har.log.entries[2].request.url).to.include(orderedRecordUrl(4));
    expect(har.log.entries[3].request.url).to.include(orderedRecordUrl(2));
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 305, 'column': 4, 'index': 9303}","it('should sort the entries by date', async function () {
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: true
      }
    });
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(2));

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.record();

    await this.fetch(orderedRecordUrl(3));
    await this.fetch(orderedRecordUrl(4));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(4);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(3));
    expect(har.log.entries[2].request.url).to.include(orderedRecordUrl(4));
    expect(har.log.entries[3].request.url).to.include(orderedRecordUrl(2));
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 319, 'column': 4, 'index': 9725}","it('should sort the entries by date', async function () {
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: true
      }
    });
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(2));

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.record();

    await this.fetch(orderedRecordUrl(3));
    await this.fetch(orderedRecordUrl(4));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(4);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(3));
    expect(har.log.entries[2].request.url).to.include(orderedRecordUrl(4));
    expect(har.log.entries[3].request.url).to.include(orderedRecordUrl(2));
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 320, 'column': 4, 'index': 9761}","it('should sort the entries by date', async function () {
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: true
      }
    });
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(2));

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.record();

    await this.fetch(orderedRecordUrl(3));
    await this.fetch(orderedRecordUrl(4));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(4);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(3));
    expect(har.log.entries[2].request.url).to.include(orderedRecordUrl(4));
    expect(har.log.entries[3].request.url).to.include(orderedRecordUrl(2));
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 321, 'column': 4, 'index': 9810}","it('should sort the entries by date', async function () {
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: true
      }
    });
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(2));

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.record();

    await this.fetch(orderedRecordUrl(3));
    await this.fetch(orderedRecordUrl(4));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(4);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(3));
    expect(har.log.entries[2].request.url).to.include(orderedRecordUrl(4));
    expect(har.log.entries[3].request.url).to.include(orderedRecordUrl(2));
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 322, 'column': 4, 'index': 9886}","it('should sort the entries by date', async function () {
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: true
      }
    });
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(2));

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.record();

    await this.fetch(orderedRecordUrl(3));
    await this.fetch(orderedRecordUrl(4));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(4);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(3));
    expect(har.log.entries[2].request.url).to.include(orderedRecordUrl(4));
    expect(har.log.entries[3].request.url).to.include(orderedRecordUrl(2));
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 344, 'column': 4, 'index': 10707}","it('should not sort the entries by date if `disableSortingHarEntries` is true', async function () {
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: true,
        disableSortingHarEntries: true
      }
    });
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(2));

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();

    await this.fetch(orderedRecordUrl(3));
    await this.fetch(orderedRecordUrl(4));
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(4);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(3));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(4));
    expect(har.log.entries[2].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[3].request.url).to.include(orderedRecordUrl(2));
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 345, 'column': 4, 'index': 10743}","it('should not sort the entries by date if `disableSortingHarEntries` is true', async function () {
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: true,
        disableSortingHarEntries: true
      }
    });
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(2));

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();

    await this.fetch(orderedRecordUrl(3));
    await this.fetch(orderedRecordUrl(4));
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(4);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(3));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(4));
    expect(har.log.entries[2].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[3].request.url).to.include(orderedRecordUrl(2));
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 346, 'column': 4, 'index': 10792}","it('should not sort the entries by date if `disableSortingHarEntries` is true', async function () {
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: true,
        disableSortingHarEntries: true
      }
    });
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(2));

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();

    await this.fetch(orderedRecordUrl(3));
    await this.fetch(orderedRecordUrl(4));
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(4);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(3));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(4));
    expect(har.log.entries[2].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[3].request.url).to.include(orderedRecordUrl(2));
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 347, 'column': 4, 'index': 10868}","it('should not sort the entries by date if `disableSortingHarEntries` is true', async function () {
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: true,
        disableSortingHarEntries: true
      }
    });
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(2));

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();

    await this.fetch(orderedRecordUrl(3));
    await this.fetch(orderedRecordUrl(4));
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(4);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(3));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(4));
    expect(har.log.entries[2].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[3].request.url).to.include(orderedRecordUrl(2));
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 360, 'column': 4, 'index': 11247}","it('should not sort the entries by date if `disableSortingHarEntries` is true', async function () {
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: true,
        disableSortingHarEntries: true
      }
    });
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(2));

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();

    await this.fetch(orderedRecordUrl(3));
    await this.fetch(orderedRecordUrl(4));
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(4);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(3));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(4));
    expect(har.log.entries[2].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[3].request.url).to.include(orderedRecordUrl(2));
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 361, 'column': 4, 'index': 11283}","it('should not sort the entries by date if `disableSortingHarEntries` is true', async function () {
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: true,
        disableSortingHarEntries: true
      }
    });
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(2));

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();

    await this.fetch(orderedRecordUrl(3));
    await this.fetch(orderedRecordUrl(4));
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(4);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(3));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(4));
    expect(har.log.entries[2].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[3].request.url).to.include(orderedRecordUrl(2));
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 362, 'column': 4, 'index': 11332}","it('should not sort the entries by date if `disableSortingHarEntries` is true', async function () {
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: true,
        disableSortingHarEntries: true
      }
    });
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(2));

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();

    await this.fetch(orderedRecordUrl(3));
    await this.fetch(orderedRecordUrl(4));
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(4);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(3));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(4));
    expect(har.log.entries[2].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[3].request.url).to.include(orderedRecordUrl(2));
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 363, 'column': 4, 'index': 11408}","it('should not sort the entries by date if `disableSortingHarEntries` is true', async function () {
    this.polly.configure({
      persisterOptions: {
        keepUnusedRequests: true,
        disableSortingHarEntries: true
      }
    });
    const { recordingName, recordingId, config } = this.polly;

    const orderedRecordUrl = (order) => `${this.recordUrl()}?order=${order}`;

    await this.fetch(orderedRecordUrl(1));
    await this.fetch(orderedRecordUrl(2));
    await this.polly.persister.persist();

    let har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(2);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(2));

    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();

    await this.fetch(orderedRecordUrl(3));
    await this.fetch(orderedRecordUrl(4));
    await this.polly.persister.persist();

    har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(4);
    expect(har.log.entries[0].request.url).to.include(orderedRecordUrl(3));
    expect(har.log.entries[1].request.url).to.include(orderedRecordUrl(4));
    expect(har.log.entries[2].request.url).to.include(orderedRecordUrl(1));
    expect(har.log.entries[3].request.url).to.include(orderedRecordUrl(2));
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 385, 'column': 4, 'index': 12128}","it('should correctly handle binary responses', async function () {
    const { recordingId, server, persister } = this.polly;
    let har, content;

    this.polly.record();

    // Non binary content
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.body = 'Some content';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[0].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.be.undefined;

    // Binary content
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.encoding = 'base64';
      res.body = 'U29tZSBjb250ZW50';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[1].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.equal('base64');

    // Binary content with no body
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.encoding = 'base64';
      res.body = '';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[2].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.be.undefined;
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 386, 'column': 4, 'index': 12176}","it('should correctly handle binary responses', async function () {
    const { recordingId, server, persister } = this.polly;
    let har, content;

    this.polly.record();

    // Non binary content
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.body = 'Some content';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[0].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.be.undefined;

    // Binary content
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.encoding = 'base64';
      res.body = 'U29tZSBjb250ZW50';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[1].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.equal('base64');

    // Binary content with no body
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.encoding = 'base64';
      res.body = '';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[2].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.be.undefined;
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 400, 'column': 4, 'index': 12562}","it('should correctly handle binary responses', async function () {
    const { recordingId, server, persister } = this.polly;
    let har, content;

    this.polly.record();

    // Non binary content
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.body = 'Some content';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[0].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.be.undefined;

    // Binary content
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.encoding = 'base64';
      res.body = 'U29tZSBjb250ZW50';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[1].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.equal('base64');

    // Binary content with no body
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.encoding = 'base64';
      res.body = '';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[2].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.be.undefined;
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 401, 'column': 4, 'index': 12610}","it('should correctly handle binary responses', async function () {
    const { recordingId, server, persister } = this.polly;
    let har, content;

    this.polly.record();

    // Non binary content
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.body = 'Some content';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[0].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.be.undefined;

    // Binary content
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.encoding = 'base64';
      res.body = 'U29tZSBjb250ZW50';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[1].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.equal('base64');

    // Binary content with no body
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.encoding = 'base64';
      res.body = '';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[2].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.be.undefined;
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 415, 'column': 4, 'index': 12996}","it('should correctly handle binary responses', async function () {
    const { recordingId, server, persister } = this.polly;
    let har, content;

    this.polly.record();

    // Non binary content
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.body = 'Some content';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[0].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.be.undefined;

    // Binary content
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.encoding = 'base64';
      res.body = 'U29tZSBjb250ZW50';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[1].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.equal('base64');

    // Binary content with no body
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.encoding = 'base64';
      res.body = '';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[2].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.be.undefined;
  })",steel
/tests/integration/persister-tests.js,Duplicate Assert,"{'line': 416, 'column': 4, 'index': 13044}","it('should correctly handle binary responses', async function () {
    const { recordingId, server, persister } = this.polly;
    let har, content;

    this.polly.record();

    // Non binary content
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.body = 'Some content';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[0].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.be.undefined;

    // Binary content
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.encoding = 'base64';
      res.body = 'U29tZSBjb250ZW50';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[1].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.equal('base64');

    // Binary content with no body
    server.get(this.recordUrl()).once('beforeResponse', (req, res) => {
      res.encoding = 'base64';
      res.body = '';
    });

    await this.fetchRecord();
    await persister.persist();

    har = await persister.findRecording(recordingId);
    content = har.log.entries[2].response.content;

    expect(await validate.har(har)).to.be.true;
    expect(content.encoding).to.be.undefined;
  })",steel
/tests/integration/persister-tests.js,Exception Handling,"{'line': 203, 'column': 4, 'index': 6031}","it('should error when persisting a failed request', async function () {
    let error;

    this.polly.configure({ recordFailedRequests: false });

    try {
      await this.relativeFetch('/echo?status=400');
      await this.polly.stop();
    } catch (e) {
      error = e;
    } finally {
      const savedRecording = await this.polly.persister.findRecording(
        this.polly.recordingId
      );

      expect(savedRecording).to.be.null;
      expect(error.message).to.contain('Cannot persist response for');

      // Clear the pending requests so `this.polly.stop()` in the
      // afterEach hook won't bomb.
      this.polly.persister.pending.clear();
    }
  })",steel
/tests/integration/adapter-tests.js,Conditional Test Logic,"{'line': 244, 'column': 4, 'index': 7271}","it('should have resolved requests after flushing', async function () {
    // The puppeteer adapter has its own implementation of this test
    if (this.polly.adapters.has('puppeteer')) {
      this.skip();
    }

    const { server } = this.polly;
    const requests = [];
    const resolved = [];

    server
      .get(this.recordUrl())
      .intercept(async (req, res) => {
        await server.timeout(5);
        res.sendStatus(200);
      })
      .on('request', (req) => {
        requests.push(req);
      });

    this.fetchRecord().then(() => resolved.push(1));
    this.fetchRecord().then(() => resolved.push(2));
    this.fetchRecord().then(() => resolved.push(3));

    await this.polly.server.timeout(10);

    expect(requests).to.have.lengthOf(3);

    await this.polly.flush();

    requests.forEach((request) => expect(request.didRespond).to.be.true);
    expect(resolved).to.have.members([1, 2, 3]);
  })",steel
/tests/integration/adapter-tests.js,Duplicate Assert,"{'line': 9, 'column': 6, 'index': 265}","it('should respect request order', async function () {
    const testOrder = async () => {
      let res = await this.fetchRecord();

      expect(res.status).to.equal(404);

      res = await this.fetchRecord({
        method: 'POST',
        body: JSON.stringify({ foo: 'bar' }),
        headers: { 'Content-Type': 'application/json' }
      });

      expect(res.status).to.equal(200);

      res = await this.fetchRecord();
      const json = await res.json();

      expect(json).to.deep.equal({ foo: 'bar' });

      res = await this.fetchRecord({ method: 'DELETE' });
      expect(res.status).to.equal(200);

      res = await this.fetchRecord();
      expect(res.status).to.equal(404);
    };

    this.polly.configure({ recordIfMissing: false });

    const { recordingName, config } = this.polly;

    this.polly.record();
    await testOrder();
    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();
    await testOrder();
  })",steel
/tests/integration/adapter-tests.js,Duplicate Assert,"{'line': 17, 'column': 6, 'index': 480}","it('should respect request order', async function () {
    const testOrder = async () => {
      let res = await this.fetchRecord();

      expect(res.status).to.equal(404);

      res = await this.fetchRecord({
        method: 'POST',
        body: JSON.stringify({ foo: 'bar' }),
        headers: { 'Content-Type': 'application/json' }
      });

      expect(res.status).to.equal(200);

      res = await this.fetchRecord();
      const json = await res.json();

      expect(json).to.deep.equal({ foo: 'bar' });

      res = await this.fetchRecord({ method: 'DELETE' });
      expect(res.status).to.equal(200);

      res = await this.fetchRecord();
      expect(res.status).to.equal(404);
    };

    this.polly.configure({ recordIfMissing: false });

    const { recordingName, config } = this.polly;

    this.polly.record();
    await testOrder();
    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();
    await testOrder();
  })",steel
/tests/integration/adapter-tests.js,Duplicate Assert,"{'line': 25, 'column': 6, 'index': 706}","it('should respect request order', async function () {
    const testOrder = async () => {
      let res = await this.fetchRecord();

      expect(res.status).to.equal(404);

      res = await this.fetchRecord({
        method: 'POST',
        body: JSON.stringify({ foo: 'bar' }),
        headers: { 'Content-Type': 'application/json' }
      });

      expect(res.status).to.equal(200);

      res = await this.fetchRecord();
      const json = await res.json();

      expect(json).to.deep.equal({ foo: 'bar' });

      res = await this.fetchRecord({ method: 'DELETE' });
      expect(res.status).to.equal(200);

      res = await this.fetchRecord();
      expect(res.status).to.equal(404);
    };

    this.polly.configure({ recordIfMissing: false });

    const { recordingName, config } = this.polly;

    this.polly.record();
    await testOrder();
    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();
    await testOrder();
  })",steel
/tests/integration/adapter-tests.js,Duplicate Assert,"{'line': 28, 'column': 6, 'index': 785}","it('should respect request order', async function () {
    const testOrder = async () => {
      let res = await this.fetchRecord();

      expect(res.status).to.equal(404);

      res = await this.fetchRecord({
        method: 'POST',
        body: JSON.stringify({ foo: 'bar' }),
        headers: { 'Content-Type': 'application/json' }
      });

      expect(res.status).to.equal(200);

      res = await this.fetchRecord();
      const json = await res.json();

      expect(json).to.deep.equal({ foo: 'bar' });

      res = await this.fetchRecord({ method: 'DELETE' });
      expect(res.status).to.equal(200);

      res = await this.fetchRecord();
      expect(res.status).to.equal(404);
    };

    this.polly.configure({ recordIfMissing: false });

    const { recordingName, config } = this.polly;

    this.polly.record();
    await testOrder();
    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();
    await testOrder();
  })",steel
/tests/integration/adapter-tests.js,Duplicate Assert,"{'line': 96, 'column': 4, 'index': 2796}","it('should passthrough', async function () {
    const { server, persister, recordingId } = this.polly;

    server.get(this.recordUrl()).passthrough();

    expect(await persister.findRecording(recordingId)).to.be.null;
    expect((await this.fetchRecord()).status).to.equal(404);
    expect(await persister.findRecording(recordingId)).to.be.null;
  })",steel
/tests/integration/adapter-tests.js,Duplicate Assert,"{'line': 98, 'column': 4, 'index': 2924}","it('should passthrough', async function () {
    const { server, persister, recordingId } = this.polly;

    server.get(this.recordUrl()).passthrough();

    expect(await persister.findRecording(recordingId)).to.be.null;
    expect((await this.fetchRecord()).status).to.equal(404);
    expect(await persister.findRecording(recordingId)).to.be.null;
  })",steel
/tests/integration/adapter-tests.js,Duplicate Assert,"{'line': 145, 'column': 4, 'index': 4327}","it('should be able to passthrough from an intercept', async function () {
    const { server, persister, recordingId } = this.polly;
    let responseCalled = false;

    server
      .get(this.recordUrl())
      .intercept((req, res, interceptor) => interceptor.passthrough())
      .on('response', (req) => {
        responseCalled = true;
        expect(req.action).to.equal(ACTIONS.PASSTHROUGH);
      });

    expect(await persister.findRecording(recordingId)).to.be.null;
    expect((await this.fetchRecord()).status).to.equal(404);
    expect(await persister.findRecording(recordingId)).to.be.null;
    expect(responseCalled).to.be.true;
  })",steel
/tests/integration/adapter-tests.js,Duplicate Assert,"{'line': 147, 'column': 4, 'index': 4455}","it('should be able to passthrough from an intercept', async function () {
    const { server, persister, recordingId } = this.polly;
    let responseCalled = false;

    server
      .get(this.recordUrl())
      .intercept((req, res, interceptor) => interceptor.passthrough())
      .on('response', (req) => {
        responseCalled = true;
        expect(req.action).to.equal(ACTIONS.PASSTHROUGH);
      });

    expect(await persister.findRecording(recordingId)).to.be.null;
    expect((await this.fetchRecord()).status).to.equal(404);
    expect(await persister.findRecording(recordingId)).to.be.null;
    expect(responseCalled).to.be.true;
  })",steel
/tests/integration/adapter-tests.js,Duplicate Assert,"{'line': 196, 'column': 4, 'index': 5781}","it('should call beforeReplay with a cloned recording entry', async function () {
    const { recordingId, recordingName, config } = this.polly;
    let replayedEntry;

    this.polly.record();
    await this.fetchRecord();
    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();

    const har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(1);

    this.polly.server
      .get(this.recordUrl())
      .on('beforeReplay', (_req, entry) => (replayedEntry = entry));

    const entry = har.log.entries[0];

    await this.fetchRecord();

    expect(replayedEntry).to.be.an('object');

    expect(entry).to.deep.equal(replayedEntry);
    expect(entry).to.not.equal(replayedEntry);

    expect(entry.request).to.deep.equal(replayedEntry.request);
    expect(entry.request).to.not.equal(replayedEntry.request);

    expect(entry.response).to.deep.equal(replayedEntry.response);
    expect(entry.response).to.not.equal(replayedEntry.response);

    expect(entry.response.content).to.deep.equal(
      replayedEntry.response.content
    );
    expect(entry.response.content).to.not.equal(replayedEntry.response.content);
  })",steel
/tests/integration/adapter-tests.js,Duplicate Assert,"{'line': 197, 'column': 4, 'index': 5829}","it('should call beforeReplay with a cloned recording entry', async function () {
    const { recordingId, recordingName, config } = this.polly;
    let replayedEntry;

    this.polly.record();
    await this.fetchRecord();
    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();

    const har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(1);

    this.polly.server
      .get(this.recordUrl())
      .on('beforeReplay', (_req, entry) => (replayedEntry = entry));

    const entry = har.log.entries[0];

    await this.fetchRecord();

    expect(replayedEntry).to.be.an('object');

    expect(entry).to.deep.equal(replayedEntry);
    expect(entry).to.not.equal(replayedEntry);

    expect(entry.request).to.deep.equal(replayedEntry.request);
    expect(entry.request).to.not.equal(replayedEntry.request);

    expect(entry.response).to.deep.equal(replayedEntry.response);
    expect(entry.response).to.not.equal(replayedEntry.response);

    expect(entry.response.content).to.deep.equal(
      replayedEntry.response.content
    );
    expect(entry.response.content).to.not.equal(replayedEntry.response.content);
  })",steel
/tests/integration/adapter-tests.js,Duplicate Assert,"{'line': 199, 'column': 4, 'index': 5877}","it('should call beforeReplay with a cloned recording entry', async function () {
    const { recordingId, recordingName, config } = this.polly;
    let replayedEntry;

    this.polly.record();
    await this.fetchRecord();
    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();

    const har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(1);

    this.polly.server
      .get(this.recordUrl())
      .on('beforeReplay', (_req, entry) => (replayedEntry = entry));

    const entry = har.log.entries[0];

    await this.fetchRecord();

    expect(replayedEntry).to.be.an('object');

    expect(entry).to.deep.equal(replayedEntry);
    expect(entry).to.not.equal(replayedEntry);

    expect(entry.request).to.deep.equal(replayedEntry.request);
    expect(entry.request).to.not.equal(replayedEntry.request);

    expect(entry.response).to.deep.equal(replayedEntry.response);
    expect(entry.response).to.not.equal(replayedEntry.response);

    expect(entry.response.content).to.deep.equal(
      replayedEntry.response.content
    );
    expect(entry.response.content).to.not.equal(replayedEntry.response.content);
  })",steel
/tests/integration/adapter-tests.js,Duplicate Assert,"{'line': 200, 'column': 4, 'index': 5941}","it('should call beforeReplay with a cloned recording entry', async function () {
    const { recordingId, recordingName, config } = this.polly;
    let replayedEntry;

    this.polly.record();
    await this.fetchRecord();
    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();

    const har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(1);

    this.polly.server
      .get(this.recordUrl())
      .on('beforeReplay', (_req, entry) => (replayedEntry = entry));

    const entry = har.log.entries[0];

    await this.fetchRecord();

    expect(replayedEntry).to.be.an('object');

    expect(entry).to.deep.equal(replayedEntry);
    expect(entry).to.not.equal(replayedEntry);

    expect(entry.request).to.deep.equal(replayedEntry.request);
    expect(entry.request).to.not.equal(replayedEntry.request);

    expect(entry.response).to.deep.equal(replayedEntry.response);
    expect(entry.response).to.not.equal(replayedEntry.response);

    expect(entry.response.content).to.deep.equal(
      replayedEntry.response.content
    );
    expect(entry.response.content).to.not.equal(replayedEntry.response.content);
  })",steel
/tests/integration/adapter-tests.js,Duplicate Assert,"{'line': 202, 'column': 4, 'index': 6005}","it('should call beforeReplay with a cloned recording entry', async function () {
    const { recordingId, recordingName, config } = this.polly;
    let replayedEntry;

    this.polly.record();
    await this.fetchRecord();
    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();

    const har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(1);

    this.polly.server
      .get(this.recordUrl())
      .on('beforeReplay', (_req, entry) => (replayedEntry = entry));

    const entry = har.log.entries[0];

    await this.fetchRecord();

    expect(replayedEntry).to.be.an('object');

    expect(entry).to.deep.equal(replayedEntry);
    expect(entry).to.not.equal(replayedEntry);

    expect(entry.request).to.deep.equal(replayedEntry.request);
    expect(entry.request).to.not.equal(replayedEntry.request);

    expect(entry.response).to.deep.equal(replayedEntry.response);
    expect(entry.response).to.not.equal(replayedEntry.response);

    expect(entry.response.content).to.deep.equal(
      replayedEntry.response.content
    );
    expect(entry.response.content).to.not.equal(replayedEntry.response.content);
  })",steel
/tests/integration/adapter-tests.js,Duplicate Assert,"{'line': 203, 'column': 4, 'index': 6071}","it('should call beforeReplay with a cloned recording entry', async function () {
    const { recordingId, recordingName, config } = this.polly;
    let replayedEntry;

    this.polly.record();
    await this.fetchRecord();
    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();

    const har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(1);

    this.polly.server
      .get(this.recordUrl())
      .on('beforeReplay', (_req, entry) => (replayedEntry = entry));

    const entry = har.log.entries[0];

    await this.fetchRecord();

    expect(replayedEntry).to.be.an('object');

    expect(entry).to.deep.equal(replayedEntry);
    expect(entry).to.not.equal(replayedEntry);

    expect(entry.request).to.deep.equal(replayedEntry.request);
    expect(entry.request).to.not.equal(replayedEntry.request);

    expect(entry.response).to.deep.equal(replayedEntry.response);
    expect(entry.response).to.not.equal(replayedEntry.response);

    expect(entry.response.content).to.deep.equal(
      replayedEntry.response.content
    );
    expect(entry.response.content).to.not.equal(replayedEntry.response.content);
  })",steel
/tests/integration/adapter-tests.js,Duplicate Assert,"{'line': 205, 'column': 4, 'index': 6137}","it('should call beforeReplay with a cloned recording entry', async function () {
    const { recordingId, recordingName, config } = this.polly;
    let replayedEntry;

    this.polly.record();
    await this.fetchRecord();
    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();

    const har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(1);

    this.polly.server
      .get(this.recordUrl())
      .on('beforeReplay', (_req, entry) => (replayedEntry = entry));

    const entry = har.log.entries[0];

    await this.fetchRecord();

    expect(replayedEntry).to.be.an('object');

    expect(entry).to.deep.equal(replayedEntry);
    expect(entry).to.not.equal(replayedEntry);

    expect(entry.request).to.deep.equal(replayedEntry.request);
    expect(entry.request).to.not.equal(replayedEntry.request);

    expect(entry.response).to.deep.equal(replayedEntry.response);
    expect(entry.response).to.not.equal(replayedEntry.response);

    expect(entry.response.content).to.deep.equal(
      replayedEntry.response.content
    );
    expect(entry.response.content).to.not.equal(replayedEntry.response.content);
  })",steel
/tests/integration/adapter-tests.js,Duplicate Assert,"{'line': 208, 'column': 4, 'index': 6231}","it('should call beforeReplay with a cloned recording entry', async function () {
    const { recordingId, recordingName, config } = this.polly;
    let replayedEntry;

    this.polly.record();
    await this.fetchRecord();
    await this.polly.stop();

    this.polly = new Polly(recordingName, config);
    this.polly.replay();

    const har = await this.polly.persister.findRecording(recordingId);

    expect(har).to.be.an('object');
    expect(har.log.entries).to.have.lengthOf(1);

    this.polly.server
      .get(this.recordUrl())
      .on('beforeReplay', (_req, entry) => (replayedEntry = entry));

    const entry = har.log.entries[0];

    await this.fetchRecord();

    expect(replayedEntry).to.be.an('object');

    expect(entry).to.deep.equal(replayedEntry);
    expect(entry).to.not.equal(replayedEntry);

    expect(entry.request).to.deep.equal(replayedEntry.request);
    expect(entry.request).to.not.equal(replayedEntry.request);

    expect(entry.response).to.deep.equal(replayedEntry.response);
    expect(entry.response).to.not.equal(replayedEntry.response);

    expect(entry.response.content).to.deep.equal(
      replayedEntry.response.content
    );
    expect(entry.response.content).to.not.equal(replayedEntry.response.content);
  })",steel
/tests/integration/adapter-tests.js,Exception Handling,"{'line': 219, 'column': 4, 'index': 6556}","it('should emit an error event', async function () {
    const { server } = this.polly;
    let error;

    this.polly.configure({ recordIfMissing: false });

    server.get(this.recordUrl()).on('error', (req, err) => (error = err));

    try {
      await this.fetchRecord();
    } catch (e) {
      /* noop */
    }

    expect(error).to.exist;
    expect(error.message).to.match(
      /Recording for the following request is not found/
    );
  })",steel
/tests/integration/adapter-tests.js,Exception Handling,"{'line': 362, 'column': 6, 'index': 10789}","it('throws on expired recording if expiryStrategy is ""error""', async function () {
      const { server } = this.polly;
      let error;

      this.polly.configure({ expiryStrategy: 'error' });
      server.any().on('error', (req, e) => (error = e));

      try {
        await testExpiration.call(this);
      } catch (e) {
        // noop
      }

      expect(error).to.exist;
      expect(error.message).to.match(
        /Recording for the following request has expired/
      );
    })",steel
/tests/integration/adapter-tests.js,Ignored Test,"{'line': 245, 'column': 11, 'index': 7326}","it('should have resolved requests after flushing', async function () {
    // The puppeteer adapter has its own implementation of this test
    if (this.polly.adapters.has('puppeteer')) {
      this.skip();
    }

    const { server } = this.polly;
    const requests = [];
    const resolved = [];

    server
      .get(this.recordUrl())
      .intercept(async (req, res) => {
        await server.timeout(5);
        res.sendStatus(200);
      })
      .on('request', (req) => {
        requests.push(req);
      });

    this.fetchRecord().then(() => resolved.push(1));
    this.fetchRecord().then(() => resolved.push(2));
    this.fetchRecord().then(() => resolved.push(3));

    await this.polly.server.timeout(10);

    expect(requests).to.have.lengthOf(3);

    await this.polly.flush();

    requests.forEach((request) => expect(request.didRespond).to.be.true);
    expect(resolved).to.have.members([1, 2, 3]);
  })",steel
/tests/integration/adapter-tests.js,Ignored Test,"{'line': 277, 'column': 5, 'index': 8124}","it.skip('should work with CORS requests', async function () {
    this.timeout(10000);

    const { server } = this.polly;
    const apiUrl = 'http://jsonplaceholder.typicode.com';

    server.any(`${apiUrl}/*`).passthrough();

    let res = await this.fetch(`${apiUrl}/posts/1`);

    expect(res.ok).to.be.true;
    expect(await res.json()).to.be.an('object');

    res = await this.fetch(`${apiUrl}/posts`, {
      method: 'POST',
      body: JSON.stringify({ foo: 'bar' }),
      headers: { 'Content-Type': 'application/json' }
    });

    expect(res.ok).to.be.true;
  })",steel
/tests/integration/adapter-identifier-tests.js,Conditional Test Logic,"{'line': 283, 'column': 4, 'index': 7381}","it(`${optionName}=${value}`, async function () {
    const adapterName = lookupAdapterName(this.polly);
    const expectedValue = deepmerge(
      expectedValues.expected || {},
      (expectedValues.overrides && expectedValues.overrides[adapterName]) || {}
    );

    const matchRequestsBy = set({}, optionName, value);

    this.polly.configure({
      matchRequestsBy
    });

    await this.fetch('http://localhost:4000/pathname?query=param#abc', {
      method: 'POST',
      body: JSON.stringify({}),
      headers: { 'content-type': 'application/json;charset=utf-8' }
    });

    const [targetRequest] = this.requests;

    if (targetRequest.identifiers) {
      expect(targetRequest.identifiers).to.deep.equal(
        expectedValue.identifiers
      );
    }

    expect(targetRequest.id).to.equal(expectedValue.id);
  })",steel
/tests/integration/adapter-browser-tests.js,Duplicate Assert,"{'line': 21, 'column': 6, 'index': 730}","it('should handle recording requests posting FormData + Blob/File', async function () {
    const { server, recordingName } = this.polly;
    const form = new FormData();

    form.append('string', recordingName);
    form.append('array', [recordingName, recordingName]);
    form.append('blob', new Blob([recordingName], { type: 'text/plain' }));
    form.append(
      'file',
      new File([recordingName], 'test.txt', { type: 'text/plain' })
    );

    server.post('/submit').intercept((req, res) => {
      const body = req.identifiers.body;

      // Make sure the form data exists in the identifiers
      expect(body).to.include(recordingName);

      expect(body).to.include(`string=${recordingName}`);
      expect(body).to.include(
        `array=${[recordingName, recordingName].toString()}`
      );
      expect(body).to.include(
        `blob=data:text/plain;base64,${btoa(recordingName)}`
      );

      expect(body).to.include(
        `file=data:text/plain;base64,${btoa(recordingName)}`
      );

      res.sendStatus(200);
    });

    const res = await this.fetch('/submit', { method: 'POST', body: form });

    expect(res.status).to.equal(200);
  })",steel
/tests/integration/adapter-browser-tests.js,Duplicate Assert,"{'line': 23, 'column': 6, 'index': 777}","it('should handle recording requests posting FormData + Blob/File', async function () {
    const { server, recordingName } = this.polly;
    const form = new FormData();

    form.append('string', recordingName);
    form.append('array', [recordingName, recordingName]);
    form.append('blob', new Blob([recordingName], { type: 'text/plain' }));
    form.append(
      'file',
      new File([recordingName], 'test.txt', { type: 'text/plain' })
    );

    server.post('/submit').intercept((req, res) => {
      const body = req.identifiers.body;

      // Make sure the form data exists in the identifiers
      expect(body).to.include(recordingName);

      expect(body).to.include(`string=${recordingName}`);
      expect(body).to.include(
        `array=${[recordingName, recordingName].toString()}`
      );
      expect(body).to.include(
        `blob=data:text/plain;base64,${btoa(recordingName)}`
      );

      expect(body).to.include(
        `file=data:text/plain;base64,${btoa(recordingName)}`
      );

      res.sendStatus(200);
    });

    const res = await this.fetch('/submit', { method: 'POST', body: form });

    expect(res.status).to.equal(200);
  })",steel
/tests/integration/adapter-browser-tests.js,Duplicate Assert,"{'line': 24, 'column': 6, 'index': 835}","it('should handle recording requests posting FormData + Blob/File', async function () {
    const { server, recordingName } = this.polly;
    const form = new FormData();

    form.append('string', recordingName);
    form.append('array', [recordingName, recordingName]);
    form.append('blob', new Blob([recordingName], { type: 'text/plain' }));
    form.append(
      'file',
      new File([recordingName], 'test.txt', { type: 'text/plain' })
    );

    server.post('/submit').intercept((req, res) => {
      const body = req.identifiers.body;

      // Make sure the form data exists in the identifiers
      expect(body).to.include(recordingName);

      expect(body).to.include(`string=${recordingName}`);
      expect(body).to.include(
        `array=${[recordingName, recordingName].toString()}`
      );
      expect(body).to.include(
        `blob=data:text/plain;base64,${btoa(recordingName)}`
      );

      expect(body).to.include(
        `file=data:text/plain;base64,${btoa(recordingName)}`
      );

      res.sendStatus(200);
    });

    const res = await this.fetch('/submit', { method: 'POST', body: form });

    expect(res.status).to.equal(200);
  })",steel
/tests/integration/adapter-browser-tests.js,Duplicate Assert,"{'line': 27, 'column': 6, 'index': 936}","it('should handle recording requests posting FormData + Blob/File', async function () {
    const { server, recordingName } = this.polly;
    const form = new FormData();

    form.append('string', recordingName);
    form.append('array', [recordingName, recordingName]);
    form.append('blob', new Blob([recordingName], { type: 'text/plain' }));
    form.append(
      'file',
      new File([recordingName], 'test.txt', { type: 'text/plain' })
    );

    server.post('/submit').intercept((req, res) => {
      const body = req.identifiers.body;

      // Make sure the form data exists in the identifiers
      expect(body).to.include(recordingName);

      expect(body).to.include(`string=${recordingName}`);
      expect(body).to.include(
        `array=${[recordingName, recordingName].toString()}`
      );
      expect(body).to.include(
        `blob=data:text/plain;base64,${btoa(recordingName)}`
      );

      expect(body).to.include(
        `file=data:text/plain;base64,${btoa(recordingName)}`
      );

      res.sendStatus(200);
    });

    const res = await this.fetch('/submit', { method: 'POST', body: form });

    expect(res.status).to.equal(200);
  })",steel
/tests/integration/adapter-browser-tests.js,Duplicate Assert,"{'line': 31, 'column': 6, 'index': 1038}","it('should handle recording requests posting FormData + Blob/File', async function () {
    const { server, recordingName } = this.polly;
    const form = new FormData();

    form.append('string', recordingName);
    form.append('array', [recordingName, recordingName]);
    form.append('blob', new Blob([recordingName], { type: 'text/plain' }));
    form.append(
      'file',
      new File([recordingName], 'test.txt', { type: 'text/plain' })
    );

    server.post('/submit').intercept((req, res) => {
      const body = req.identifiers.body;

      // Make sure the form data exists in the identifiers
      expect(body).to.include(recordingName);

      expect(body).to.include(`string=${recordingName}`);
      expect(body).to.include(
        `array=${[recordingName, recordingName].toString()}`
      );
      expect(body).to.include(
        `blob=data:text/plain;base64,${btoa(recordingName)}`
      );

      expect(body).to.include(
        `file=data:text/plain;base64,${btoa(recordingName)}`
      );

      res.sendStatus(200);
    });

    const res = await this.fetch('/submit', { method: 'POST', body: form });

    expect(res.status).to.equal(200);
  })",steel
/packages/@pollyjs/utils/tests/unit/utils/url-test.js,Conditional Test Logic,"{'line': 28, 'column': 6, 'index': 859}","it('should correctly parse query params', function () {
    [
      ['', {}],
      ['a&b=', { a: null, b: '' }],
      ['foo=bar', { foo: 'bar' }],
      ['a[]=1&a[]=2', { a: ['1', '2'] }],
      ['a[1]=1&a[0]=2', { a: ['2', '1'] }],
      ['a=1&a=2', { a: ['1', '2'] }],
      ['foo[bar][baz]=1', { foo: { bar: { baz: '1' } } }]
    ].forEach(([query, obj]) => {
      expect(new URL(`http://foo.bar/?${query}`, true).query).to.deep.equal(
        obj
      );
    });
  })",steel
/packages/@pollyjs/utils/tests/unit/utils/url-test.js,Conditional Test Logic,"{'line': 43, 'column': 6, 'index': 1352}","it('should correctly stringify query params', function () {
    [
      // Query string will be undefined but we decode it in the assertion
      [{}, decode(undefined)],
      [{ a: null, b: '' }, 'a&b='],
      [{ foo: 'bar' }, 'foo=bar'],
      [{ a: ['1', '2'] }, 'a[0]=1&a[1]=2'],
      [{ foo: { bar: { baz: '1' } } }, 'foo[bar][baz]=1']
    ].forEach(([obj, query]) => {
      const url = new URL('http://foo.bar', true);

      url.set('query', obj);
      expect(decode(url.href.split('?')[1])).to.equal(query);
      expect(decode(url.toString().split('?')[1])).to.equal(query);
    });
  })",steel
/packages/@pollyjs/utils/tests/unit/utils/url-test.js,Conditional Test Logic,"{'line': 59, 'column': 6, 'index': 1843}","it('should correctly detect original array formats', function () {
    [
      'a[0]=1&a[1]=2',
      `${encode('a[0]')}=1&${encode('a[1]')}=2`,
      'a[]=1&a[]=2',
      `${encode('a[]')}=1&${encode('a[]')}=2`,
      'a=1&a=2'
    ].forEach((query) => {
      const url = new URL(`http://foo.bar/?${query}`, true);

      expect(decode(url.href.split('?')[1])).to.equal(decode(query));
      expect(decode(url.toString().split('?')[1])).to.equal(decode(query));
    });
  })",steel
/packages/@pollyjs/utils/tests/unit/utils/url-test.js,Conditional Test Logic,"{'line': 70, 'column': 48, 'index': 2256}","it('should correctly handle changes in array formats', function () {
    const url = new URL(`http://foo.bar`, true);

    ['a[0]=1&a[1]=2', 'a[]=1&a[]=2', 'a=1&a=2'].forEach((query) => {
      url.set('query', query);

      expect(decode(url.href.split('?')[1])).to.equal(query);
      expect(decode(url.toString().split('?')[1])).to.equal(query);
    });
  })",steel
/packages/@pollyjs/utils/tests/unit/utils/timeout-test.js,Duplicate Assert,"{'line': 24, 'column': 21, 'index': 558}","it('should timeout for the correct amount of ms', async function () {
    this.timeout(110);

    const promise = timeout(100);
    let resolved = false;

    promise.then(() => (resolved = true));

    setTimeout(() => expect(resolved).to.be.false, 50);
    setTimeout(() => expect(resolved).to.be.true, 101);

    await promise;
  })",steel
/packages/@pollyjs/utils/tests/unit/utils/timeout-test.js,Duplicate Assert,"{'line': 25, 'column': 21, 'index': 614}","it('should timeout for the correct amount of ms', async function () {
    this.timeout(110);

    const promise = timeout(100);
    let resolved = false;

    promise.then(() => (resolved = true));

    setTimeout(() => expect(resolved).to.be.false, 50);
    setTimeout(() => expect(resolved).to.be.true, 101);

    await promise;
  })",steel
/packages/@pollyjs/utils/tests/unit/utils/timeout-test.js,Sleepy Test,"{'line': 24, 'column': 4, 'index': 541}","it('should timeout for the correct amount of ms', async function () {
    this.timeout(110);

    const promise = timeout(100);
    let resolved = false;

    promise.then(() => (resolved = true));

    setTimeout(() => expect(resolved).to.be.false, 50);
    setTimeout(() => expect(resolved).to.be.true, 101);

    await promise;
  })",steel
/packages/@pollyjs/utils/tests/unit/utils/timeout-test.js,Sleepy Test,"{'line': 25, 'column': 4, 'index': 597}","it('should timeout for the correct amount of ms', async function () {
    this.timeout(110);

    const promise = timeout(100);
    let resolved = false;

    promise.then(() => (resolved = true));

    setTimeout(() => expect(resolved).to.be.false, 50);
    setTimeout(() => expect(resolved).to.be.true, 101);

    await promise;
  })",steel
/packages/@pollyjs/utils/tests/unit/utils/assert-test.js,Redundant Assertion,"{'column': 17, 'line': 10}","it('should throw with a false condition', function () {
    expect(() => assert('Test', false)).to.throw(PollyError, /Test/);
  })",steel
/packages/@pollyjs/utils/tests/unit/utils/assert-test.js,Redundant Assertion,"{'column': 17, 'line': 14}","it('should throw without a condition', function () {
    expect(() => assert('Test')).to.throw(PollyError, /Test/);
  })",steel
/packages/@pollyjs/utils/tests/unit/utils/assert-test.js,Redundant Assertion,"{'column': 17, 'line': 18}","it('should not throw with a true condition', function () {
    expect(() => assert('Test', true)).to.not.throw();
  })",steel
/packages/@pollyjs/persister-fs/tests/unit/persister-test.js,Duplicate Assert,"{'line': 31, 'column': 6, 'index': 672}","it('recordingsDir', function () {
      let persister = new FSPersister(new MockPolly());

      expect(persister.options.recordingsDir)
        .to.equal(persister.defaultOptions.recordingsDir)
        .and.to.equal('recordings');

      persister = new FSPersister(
        new MockPolly({
          recordingsDir: 'recordings/tmp'
        })
      );

      expect(persister.options.recordingsDir)
        .to.equal('recordings/tmp')
        .and.to.not.equal(persister.defaultOptions.recordingsDir);

      fixturify.writeSync('recordings/tmp', {
        'FS-Persister': {
          'recording.har': '{}'
        }
      });

      expect(persister.onFindRecording('FS-Persister')).to.deep.equal({});
    })",steel
/packages/@pollyjs/persister-fs/tests/unit/persister-test.js,Duplicate Assert,"{'line': 41, 'column': 6, 'index': 936}","it('recordingsDir', function () {
      let persister = new FSPersister(new MockPolly());

      expect(persister.options.recordingsDir)
        .to.equal(persister.defaultOptions.recordingsDir)
        .and.to.equal('recordings');

      persister = new FSPersister(
        new MockPolly({
          recordingsDir: 'recordings/tmp'
        })
      );

      expect(persister.options.recordingsDir)
        .to.equal('recordings/tmp')
        .and.to.not.equal(persister.defaultOptions.recordingsDir);

      fixturify.writeSync('recordings/tmp', {
        'FS-Persister': {
          'recording.har': '{}'
        }
      });

      expect(persister.onFindRecording('FS-Persister')).to.deep.equal({});
    })",steel
/packages/@pollyjs/persister-fs/tests/unit/persister-test.js,Duplicate Assert,"{'line': 67, 'column': 6, 'index': 1589}","it('onSaveRecording', function () {
      expect(this.persister.onFindRecording('FS-Persister')).to.deep.equal({});

      this.persister.onSaveRecording('FS-Persister', { foo: 'bar' });
      expect(this.persister.onFindRecording('FS-Persister')).to.deep.equal({
        foo: 'bar'
      });
    })",steel
/packages/@pollyjs/persister-fs/tests/unit/persister-test.js,Duplicate Assert,"{'line': 70, 'column': 6, 'index': 1740}","it('onSaveRecording', function () {
      expect(this.persister.onFindRecording('FS-Persister')).to.deep.equal({});

      this.persister.onSaveRecording('FS-Persister', { foo: 'bar' });
      expect(this.persister.onFindRecording('FS-Persister')).to.deep.equal({
        foo: 'bar'
      });
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Conditional Test Logic,"{'line': 28, 'column': 4, 'index': 835}","it('should throw with an empty recording name', async function () {
    for (const value of [undefined, null, '', '\n\r']) {
      const polly = new Polly('test');

      expect(() => (polly.recordingName = value)).to.throw(
        PollyError,
        /Invalid recording name provided/
      );

      await polly.stop();
    }
  })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 43, 'column': 4, 'index': 1215}","it('should be able to change the recording name', async function () {
    const polly = new Polly('squawk');

    expect(polly.recordingName).to.equal('squawk');
    polly.recordingName = 'squawk squawk';
    expect(polly.recordingName).to.equal('squawk squawk');

    await polly.stop();
  })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 45, 'column': 4, 'index': 1310}","it('should be able to change the recording name', async function () {
    const polly = new Polly('squawk');

    expect(polly.recordingName).to.equal('squawk');
    polly.recordingName = 'squawk squawk';
    expect(polly.recordingName).to.equal('squawk squawk');

    await polly.stop();
  })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 53, 'column': 4, 'index': 1522}","it('should update the recording id when the name changes', async function () {
    const polly = new Polly('squawk');

    expect(polly.recordingName).to.equal('squawk');
    expect(polly.recordingId).to.contain('squawk');
    polly.recordingName = 'chirp';
    expect(polly.recordingName).to.equal('chirp');
    expect(polly.recordingId).to.contain('chirp');

    await polly.stop();
  })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 54, 'column': 4, 'index': 1574}","it('should update the recording id when the name changes', async function () {
    const polly = new Polly('squawk');

    expect(polly.recordingName).to.equal('squawk');
    expect(polly.recordingId).to.contain('squawk');
    polly.recordingName = 'chirp';
    expect(polly.recordingName).to.equal('chirp');
    expect(polly.recordingId).to.contain('chirp');

    await polly.stop();
  })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 56, 'column': 4, 'index': 1661}","it('should update the recording id when the name changes', async function () {
    const polly = new Polly('squawk');

    expect(polly.recordingName).to.equal('squawk');
    expect(polly.recordingId).to.contain('squawk');
    polly.recordingName = 'chirp';
    expect(polly.recordingName).to.equal('chirp');
    expect(polly.recordingId).to.contain('chirp');

    await polly.stop();
  })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 57, 'column': 4, 'index': 1712}","it('should update the recording id when the name changes', async function () {
    const polly = new Polly('squawk');

    expect(polly.recordingName).to.equal('squawk');
    expect(polly.recordingId).to.contain('squawk');
    polly.recordingName = 'chirp';
    expect(polly.recordingName).to.equal('chirp');
    expect(polly.recordingId).to.contain('chirp');

    await polly.stop();
  })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 65, 'column': 4, 'index': 1889}","it('can manually set the mode', async function () {
    const polly = new Polly('squawk');

    expect(polly.mode).to.equal('replay');
    polly.mode = 'record';
    expect(polly.mode).to.equal('record');

    await polly.stop();
  })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 67, 'column': 4, 'index': 1959}","it('can manually set the mode', async function () {
    const polly = new Polly('squawk');

    expect(polly.mode).to.equal('replay');
    polly.mode = 'record';
    expect(polly.mode).to.equal('record');

    await polly.stop();
  })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 144, 'column': 4, 'index': 3615}","it('calls flush when flushRequestsOnStop is enabled', async function () {
    let polly = new Polly('squawk', { flushRequestsOnStop: false });
    let flushCalled = false;

    polly.flush = async () => {
      flushCalled = true;
    };

    await polly.stop();
    expect(flushCalled).to.be.false;

    polly = new Polly('squawk', { flushRequestsOnStop: true });
    flushCalled = false;

    polly.flush = async () => {
      flushCalled = true;
    };

    await polly.stop();
    expect(flushCalled).to.be.true;
  })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 154, 'column': 4, 'index': 3833}","it('calls flush when flushRequestsOnStop is enabled', async function () {
    let polly = new Polly('squawk', { flushRequestsOnStop: false });
    let flushCalled = false;

    polly.flush = async () => {
      flushCalled = true;
    };

    await polly.stop();
    expect(flushCalled).to.be.false;

    polly = new Polly('squawk', { flushRequestsOnStop: true });
    flushCalled = false;

    polly.flush = async () => {
      flushCalled = true;
    };

    await polly.stop();
    expect(flushCalled).to.be.true;
  })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 209, 'column': 6, 'index': 5324}","it('should not deep merge adapter options', async function () {
      class MockAdapterA extends Adapter {
        static get id() {
          return 'mock-a';
        }

        onConnect() {}
        onDisconnect() {}
      }

      class MockAdapterB extends MockAdapterA {
        static get id() {
          return 'mock-b';
        }
      }

      expect(this.polly.config.adapters.length).to.equal(0);

      this.polly.configure({ adapters: [MockAdapterA] });
      this.polly.configure({ adapters: [MockAdapterB] });

      expect(this.polly.config.adapters.length).to.equal(1);
      expect(this.polly.adapters.has('mock-a')).to.be.false;
      expect(this.polly.adapters.has('mock-b')).to.be.true;
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 214, 'column': 6, 'index': 5503}","it('should not deep merge adapter options', async function () {
      class MockAdapterA extends Adapter {
        static get id() {
          return 'mock-a';
        }

        onConnect() {}
        onDisconnect() {}
      }

      class MockAdapterB extends MockAdapterA {
        static get id() {
          return 'mock-b';
        }
      }

      expect(this.polly.config.adapters.length).to.equal(0);

      this.polly.configure({ adapters: [MockAdapterA] });
      this.polly.configure({ adapters: [MockAdapterB] });

      expect(this.polly.config.adapters.length).to.equal(1);
      expect(this.polly.adapters.has('mock-a')).to.be.false;
      expect(this.polly.adapters.has('mock-b')).to.be.true;
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 233, 'column': 6, 'index': 5992}","it('should connect to new adapters', async function () {
      let connectCalled = false;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCalled = true;
        }
        onDisconnect() {}
      }

      expect(connectCalled).to.be.false;
      this.polly.configure({ adapters: [MockAdapter] });
      expect(connectCalled).to.be.true;
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 235, 'column': 6, 'index': 6090}","it('should connect to new adapters', async function () {
      let connectCalled = false;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCalled = true;
        }
        onDisconnect() {}
      }

      expect(connectCalled).to.be.false;
      this.polly.configure({ adapters: [MockAdapter] });
      expect(connectCalled).to.be.true;
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 256, 'column': 6, 'index': 6571}","it('should disconnect from adapters before connecting', async function () {
      let connectCount = 0;
      let disconnectCount = 0;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCount++;
        }
        onDisconnect() {
          disconnectCount++;
        }
      }

      this.polly.configure({ adapters: [MockAdapter] });
      expect(connectCount).to.equal(1);
      expect(disconnectCount).to.equal(0);

      this.polly.configure({ adapters: [MockAdapter] });
      expect(connectCount).to.equal(2);
      expect(disconnectCount).to.equal(1);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 257, 'column': 6, 'index': 6611}","it('should disconnect from adapters before connecting', async function () {
      let connectCount = 0;
      let disconnectCount = 0;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCount++;
        }
        onDisconnect() {
          disconnectCount++;
        }
      }

      this.polly.configure({ adapters: [MockAdapter] });
      expect(connectCount).to.equal(1);
      expect(disconnectCount).to.equal(0);

      this.polly.configure({ adapters: [MockAdapter] });
      expect(connectCount).to.equal(2);
      expect(disconnectCount).to.equal(1);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 260, 'column': 6, 'index': 6712}","it('should disconnect from adapters before connecting', async function () {
      let connectCount = 0;
      let disconnectCount = 0;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCount++;
        }
        onDisconnect() {
          disconnectCount++;
        }
      }

      this.polly.configure({ adapters: [MockAdapter] });
      expect(connectCount).to.equal(1);
      expect(disconnectCount).to.equal(0);

      this.polly.configure({ adapters: [MockAdapter] });
      expect(connectCount).to.equal(2);
      expect(disconnectCount).to.equal(1);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 261, 'column': 6, 'index': 6752}","it('should disconnect from adapters before connecting', async function () {
      let connectCount = 0;
      let disconnectCount = 0;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCount++;
        }
        onDisconnect() {
          disconnectCount++;
        }
      }

      this.polly.configure({ adapters: [MockAdapter] });
      expect(connectCount).to.equal(1);
      expect(disconnectCount).to.equal(0);

      this.polly.configure({ adapters: [MockAdapter] });
      expect(connectCount).to.equal(2);
      expect(disconnectCount).to.equal(1);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 286, 'column': 6, 'index': 7207}","it('.record()', async function () {
      this.polly.mode = MODES.REPLAY;

      expect(this.polly.mode).to.equal(MODES.REPLAY);
      this.polly.record();
      expect(this.polly.mode).to.equal(MODES.RECORD);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 288, 'column': 6, 'index': 7288}","it('.record()', async function () {
      this.polly.mode = MODES.REPLAY;

      expect(this.polly.mode).to.equal(MODES.REPLAY);
      this.polly.record();
      expect(this.polly.mode).to.equal(MODES.RECORD);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 294, 'column': 6, 'index': 7430}","it('.replay()', async function () {
      this.polly.mode = MODES.RECORD;

      expect(this.polly.mode).to.equal(MODES.RECORD);
      this.polly.replay();
      expect(this.polly.mode).to.equal(MODES.REPLAY);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 296, 'column': 6, 'index': 7511}","it('.replay()', async function () {
      this.polly.mode = MODES.RECORD;

      expect(this.polly.mode).to.equal(MODES.RECORD);
      this.polly.replay();
      expect(this.polly.mode).to.equal(MODES.REPLAY);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 302, 'column': 6, 'index': 7658}","it('.passthrough()', async function () {
      this.polly.mode = MODES.RECORD;

      expect(this.polly.mode).to.equal(MODES.RECORD);
      this.polly.passthrough();
      expect(this.polly.mode).to.equal(MODES.PASSTHROUGH);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 304, 'column': 6, 'index': 7744}","it('.passthrough()', async function () {
      this.polly.mode = MODES.RECORD;

      expect(this.polly.mode).to.equal(MODES.RECORD);
      this.polly.passthrough();
      expect(this.polly.mode).to.equal(MODES.PASSTHROUGH);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 310, 'column': 6, 'index': 7924}","it('.pause()', async function () {
      this.polly.configure({ adapters: [MockAdapterA, MockAdapterB] });

      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
      this.polly.pause();
      expect([...this.polly.adapters.keys()]).to.deep.equal([]);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 315, 'column': 6, 'index': 8063}","it('.pause()', async function () {
      this.polly.configure({ adapters: [MockAdapterA, MockAdapterB] });

      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
      this.polly.pause();
      expect([...this.polly.adapters.keys()]).to.deep.equal([]);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 321, 'column': 6, 'index': 8248}","it('.play()', async function () {
      this.polly.configure({ adapters: [MockAdapterA, MockAdapterB] });

      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
      this.polly.play();
      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
      this.polly.pause();
      expect([...this.polly.adapters.keys()]).to.deep.equal([]);
      this.polly.play();
      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 326, 'column': 6, 'index': 8386}","it('.play()', async function () {
      this.polly.configure({ adapters: [MockAdapterA, MockAdapterB] });

      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
      this.polly.play();
      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
      this.polly.pause();
      expect([...this.polly.adapters.keys()]).to.deep.equal([]);
      this.polly.play();
      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 331, 'column': 6, 'index': 8525}","it('.play()', async function () {
      this.polly.configure({ adapters: [MockAdapterA, MockAdapterB] });

      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
      this.polly.play();
      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
      this.polly.pause();
      expect([...this.polly.adapters.keys()]).to.deep.equal([]);
      this.polly.play();
      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 333, 'column': 6, 'index': 8615}","it('.play()', async function () {
      this.polly.configure({ adapters: [MockAdapterA, MockAdapterB] });

      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
      this.polly.play();
      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
      this.polly.pause();
      expect([...this.polly.adapters.keys()]).to.deep.equal([]);
      this.polly.play();
      expect([...this.polly.adapters.keys()]).to.deep.equal([
        'adapter-a',
        'adapter-b'
      ]);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 341, 'column': 6, 'index': 8813}","it('.stop()', async function () {
      this.polly.mode = MODES.RECORD;
      expect(this.polly.mode).to.equal(MODES.RECORD);

      const promise = this.polly.stop();

      expect(promise).to.be.a('promise');
      await promise;
      expect(this.polly.mode).to.equal(MODES.STOPPED);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 347, 'column': 6, 'index': 8973}","it('.stop()', async function () {
      this.polly.mode = MODES.RECORD;
      expect(this.polly.mode).to.equal(MODES.RECORD);

      const promise = this.polly.stop();

      expect(promise).to.be.a('promise');
      await promise;
      expect(this.polly.mode).to.equal(MODES.STOPPED);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 371, 'column': 6, 'index': 9463}","it('.connectTo()', async function () {
      let connectCount = 0;
      let disconnectCount = 0;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCount++;
        }

        onDisconnect() {
          disconnectCount++;
        }
      }

      this.polly.container.register(MockAdapter);

      this.polly.connectTo('mock');
      expect(connectCount).to.equal(1);
      expect(disconnectCount).to.equal(0);

      this.polly.connectTo(MockAdapter);
      expect(connectCount).to.equal(2);
      expect(disconnectCount).to.equal(1);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 372, 'column': 6, 'index': 9503}","it('.connectTo()', async function () {
      let connectCount = 0;
      let disconnectCount = 0;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCount++;
        }

        onDisconnect() {
          disconnectCount++;
        }
      }

      this.polly.container.register(MockAdapter);

      this.polly.connectTo('mock');
      expect(connectCount).to.equal(1);
      expect(disconnectCount).to.equal(0);

      this.polly.connectTo(MockAdapter);
      expect(connectCount).to.equal(2);
      expect(disconnectCount).to.equal(1);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 375, 'column': 6, 'index': 9588}","it('.connectTo()', async function () {
      let connectCount = 0;
      let disconnectCount = 0;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCount++;
        }

        onDisconnect() {
          disconnectCount++;
        }
      }

      this.polly.container.register(MockAdapter);

      this.polly.connectTo('mock');
      expect(connectCount).to.equal(1);
      expect(disconnectCount).to.equal(0);

      this.polly.connectTo(MockAdapter);
      expect(connectCount).to.equal(2);
      expect(disconnectCount).to.equal(1);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 376, 'column': 6, 'index': 9628}","it('.connectTo()', async function () {
      let connectCount = 0;
      let disconnectCount = 0;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCount++;
        }

        onDisconnect() {
          disconnectCount++;
        }
      }

      this.polly.container.register(MockAdapter);

      this.polly.connectTo('mock');
      expect(connectCount).to.equal(1);
      expect(disconnectCount).to.equal(0);

      this.polly.connectTo(MockAdapter);
      expect(connectCount).to.equal(2);
      expect(disconnectCount).to.equal(1);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 400, 'column': 6, 'index': 10109}","it('.disconnectTo()', async function () {
      let connectCount = 0;
      let disconnectCount = 0;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCount++;
        }

        onDisconnect() {
          disconnectCount++;
        }
      }

      this.polly.container.register(MockAdapter);

      this.polly.connectTo('mock');
      expect(connectCount).to.equal(1);
      this.polly.disconnectFrom('mock');
      expect(disconnectCount).to.equal(1);

      this.polly.connectTo(MockAdapter);
      expect(connectCount).to.equal(2);
      this.polly.disconnectFrom(MockAdapter);
      expect(disconnectCount).to.equal(2);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 402, 'column': 6, 'index': 10190}","it('.disconnectTo()', async function () {
      let connectCount = 0;
      let disconnectCount = 0;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCount++;
        }

        onDisconnect() {
          disconnectCount++;
        }
      }

      this.polly.container.register(MockAdapter);

      this.polly.connectTo('mock');
      expect(connectCount).to.equal(1);
      this.polly.disconnectFrom('mock');
      expect(disconnectCount).to.equal(1);

      this.polly.connectTo(MockAdapter);
      expect(connectCount).to.equal(2);
      this.polly.disconnectFrom(MockAdapter);
      expect(disconnectCount).to.equal(2);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 405, 'column': 6, 'index': 10275}","it('.disconnectTo()', async function () {
      let connectCount = 0;
      let disconnectCount = 0;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCount++;
        }

        onDisconnect() {
          disconnectCount++;
        }
      }

      this.polly.container.register(MockAdapter);

      this.polly.connectTo('mock');
      expect(connectCount).to.equal(1);
      this.polly.disconnectFrom('mock');
      expect(disconnectCount).to.equal(1);

      this.polly.connectTo(MockAdapter);
      expect(connectCount).to.equal(2);
      this.polly.disconnectFrom(MockAdapter);
      expect(disconnectCount).to.equal(2);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 407, 'column': 6, 'index': 10361}","it('.disconnectTo()', async function () {
      let connectCount = 0;
      let disconnectCount = 0;

      class MockAdapter extends Adapter {
        static get id() {
          return 'mock';
        }

        onConnect() {
          connectCount++;
        }

        onDisconnect() {
          disconnectCount++;
        }
      }

      this.polly.container.register(MockAdapter);

      this.polly.connectTo('mock');
      expect(connectCount).to.equal(1);
      this.polly.disconnectFrom('mock');
      expect(disconnectCount).to.equal(1);

      this.polly.connectTo(MockAdapter);
      expect(connectCount).to.equal(2);
      this.polly.disconnectFrom(MockAdapter);
      expect(disconnectCount).to.equal(2);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 434, 'column': 6, 'index': 10951}","it('.disconnect()', async function () {
      const disconnects = [];

      class MockAdapterA extends Adapter {
        static get id() {
          return 'mock-a';
        }

        onConnect() {}

        onDisconnect() {
          disconnects.push(true);
        }
      }

      class MockAdapterB extends MockAdapterA {
        static get id() {
          return 'mock-b';
        }
      }

      // configure automatically connects to the new adapter
      this.polly.configure({ adapters: [MockAdapterA, MockAdapterB] });

      expect(disconnects.length).to.equal(0);
      expect(this.polly.disconnect());
      expect(disconnects.length).to.equal(2);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 436, 'column': 6, 'index': 11036}","it('.disconnect()', async function () {
      const disconnects = [];

      class MockAdapterA extends Adapter {
        static get id() {
          return 'mock-a';
        }

        onConnect() {}

        onDisconnect() {
          disconnects.push(true);
        }
      }

      class MockAdapterB extends MockAdapterA {
        static get id() {
          return 'mock-b';
        }
      }

      // configure automatically connects to the new adapter
      this.polly.configure({ adapters: [MockAdapterA, MockAdapterB] });

      expect(disconnects.length).to.equal(0);
      expect(this.polly.disconnect());
      expect(disconnects.length).to.equal(2);
    })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 477, 'column': 8, 'index': 12034}","it('.unregister()', async function () {
        Polly.register(MockAdapter);

        let polly = new Polly('Test');

        expect(polly.container.has('adapter:mock')).to.be.true;
        await polly.stop();

        Polly.unregister(MockAdapter);

        polly = new Polly('Test');
        expect(polly.container.has('adapter:mock')).to.be.false;
        await polly.stop();
      })",steel
/packages/@pollyjs/core/tests/unit/polly-test.js,Duplicate Assert,"{'line': 483, 'column': 8, 'index': 12202}","it('.unregister()', async function () {
        Polly.register(MockAdapter);

        let polly = new Polly('Test');

        expect(polly.container.has('adapter:mock')).to.be.true;
        await polly.stop();

        Polly.unregister(MockAdapter);

        polly = new Polly('Test');
        expect(polly.container.has('adapter:mock')).to.be.false;
        await polly.stop();
      })",steel
/packages/@pollyjs/core/tests/unit/index-test.js,Conditional Test Logic,"{'line': 5, 'column': 52, 'index': 197}","it('should export all the necessary modules', function () {
    ['Polly', 'Timing', 'setupQunit', 'setupMocha'].forEach((name) => {
      expect(PollyExports[name]).to.be.ok;
    });
  })",steel
/packages/@pollyjs/core/tests/unit/utils/timing-test.js,Conditional Test Logic,"{'line': 13, 'column': 4, 'index': 319}","it(`should handle ${ms}ms`, async function () {
    // Fail the test if it exceeds ms + 10ms buffer
    this.timeout(ms + 50);

    const promise = Timing.fixed(ms)();
    let resolved = false;

    promise.then(() => (resolved = true));

    if (ms) {
      setTimeout(() => expect(resolved).to.be.false, ms / 2);
    }
    setTimeout(() => expect(resolved).to.be.true, ms + 1);

    await promise;
  })",steel
/packages/@pollyjs/core/tests/unit/utils/timing-test.js,Conditional Test Logic,"{'line': 34, 'column': 4, 'index': 824}","it(`should handle a ratio of ${ratio}`, async function () {
    // Fail the test if it exceeds timeout + 10ms buffer
    this.timeout(timeout + 50);

    const promise = Timing.relative(ratio)(100);
    let resolved = false;

    promise.then(() => (resolved = true));

    if (timeout) {
      setTimeout(() => expect(resolved).to.be.false, timeout / 2);
    }
    setTimeout(() => expect(resolved).to.be.true, timeout + 1);

    await promise;
  })",steel
/packages/@pollyjs/core/tests/unit/utils/parse-url-test.js,Conditional Test Logic,"{'line': 13, 'column': 6, 'index': 366}","it('should exactly match passed urls', function () {
    [
      '/movies/1',
      'http://netflix.com/movies/1',
      'http://netflix.com/movies/1?sort=title&dir=asc'
    ].forEach((url) => expect(parseUrl(url).href).to.equal(url));
  })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Conditional Test Logic,"{'line': 186, 'column': 8, 'index': 5283}","it('should respect `matchRequestsBy.url` config', function () {
      [
        [
          /* config options */
          'hash',
          /* input url */
          'http://hash-test.com/?b=1&c=1&a=1#hello=world',
          /* expected when true */
          [true, 'http://hash-test.com/?a=1&b=1&c=1#hello=world'],
          /* expected when false */
          [false, 'http://hash-test.com/?a=1&b=1&c=1'],
          /* expected when custom fn */
          [
            (h) => h.replace('=', '!='),
            'http://hash-test.com/?a=1&b=1&c=1#hello!=world'
          ]
        ],
        [
          'protocol',
          'http://protocol-test.com/',
          [true, 'http://protocol-test.com/'],
          [false, '//protocol-test.com/'],
          [(p) => p.replace('http', 'https'), 'https://protocol-test.com/']
        ],
        [
          'query',
          'http://query-test.com/?b=1&c=1&a=1',
          [true, 'http://query-test.com/?a=1&b=1&c=1'],
          [false, 'http://query-test.com/'],
          [(q) => ({ ...q, c: 2 }), 'http://query-test.com/?a=1&b=1&c=2']
        ],
        [
          'username',
          'https://username:password@username-test.com/',
          [true, 'https://username:password@username-test.com/'],
          [false, 'https://username-test.com/'],
          [(u) => `${u}123`, 'https://username123:password@username-test.com/']
        ],
        [
          'password',
          'https://username:password@password-test.com/',
          [true, 'https://username:password@password-test.com/'],
          [false, 'https://username@password-test.com/'],
          [(p) => `${p}123`, 'https://username:password123@password-test.com/']
        ],
        [
          'port',
          'https://port-test.com:8000/',
          [true, 'https://port-test.com:8000/'],
          [false, 'https://port-test.com/'],
          [(p) => Number(p) + 1, 'https://port-test.com:8001/']
        ],
        [
          'pathname',
          'https://pathname-test.com/bar/baz',
          [true, 'https://pathname-test.com/bar/baz'],
          [false, 'https://pathname-test.com'],
          [(p) => p.replace('bar', 'foo'), 'https://pathname-test.com/foo/baz']
        ]
      ].forEach(([rule, input, ...options]) => {
        options.forEach(([optionValue, expectedOutput]) => {
          expect(url(input, { [rule]: optionValue })).to.equal(expectedOutput);
        });
      });
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Eager Test,"{'line': 18, 'column': 13, 'index': 445}","it('should handle all verbs', function () {
      expect(method('get')).to.equal('GET');
      expect(method('put')).to.equal('PUT');
      expect(method('post')).to.equal('POST');
      expect(method('patch')).to.equal('PATCH');
      expect(method('delete')).to.equal('DELETE');
      expect(method('option')).to.equal('OPTION');
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Eager Test,"{'line': 19, 'column': 13, 'index': 490}","it('should handle all verbs', function () {
      expect(method('get')).to.equal('GET');
      expect(method('put')).to.equal('PUT');
      expect(method('post')).to.equal('POST');
      expect(method('patch')).to.equal('PATCH');
      expect(method('delete')).to.equal('DELETE');
      expect(method('option')).to.equal('OPTION');
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Eager Test,"{'line': 20, 'column': 13, 'index': 535}","it('should handle all verbs', function () {
      expect(method('get')).to.equal('GET');
      expect(method('put')).to.equal('PUT');
      expect(method('post')).to.equal('POST');
      expect(method('patch')).to.equal('PATCH');
      expect(method('delete')).to.equal('DELETE');
      expect(method('option')).to.equal('OPTION');
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Eager Test,"{'line': 21, 'column': 13, 'index': 582}","it('should handle all verbs', function () {
      expect(method('get')).to.equal('GET');
      expect(method('put')).to.equal('PUT');
      expect(method('post')).to.equal('POST');
      expect(method('patch')).to.equal('PATCH');
      expect(method('delete')).to.equal('DELETE');
      expect(method('option')).to.equal('OPTION');
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Eager Test,"{'line': 22, 'column': 13, 'index': 631}","it('should handle all verbs', function () {
      expect(method('get')).to.equal('GET');
      expect(method('put')).to.equal('PUT');
      expect(method('post')).to.equal('POST');
      expect(method('patch')).to.equal('PATCH');
      expect(method('delete')).to.equal('DELETE');
      expect(method('option')).to.equal('OPTION');
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Eager Test,"{'line': 23, 'column': 13, 'index': 682}","it('should handle all verbs', function () {
      expect(method('get')).to.equal('GET');
      expect(method('put')).to.equal('PUT');
      expect(method('post')).to.equal('POST');
      expect(method('patch')).to.equal('PATCH');
      expect(method('delete')).to.equal('DELETE');
      expect(method('option')).to.equal('OPTION');
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Lazy Test,"{'line': 18, 'column': 13, 'index': 445}","it('should handle all verbs', function () {
      expect(method('get')).to.equal('GET');
      expect(method('put')).to.equal('PUT');
      expect(method('post')).to.equal('POST');
      expect(method('patch')).to.equal('PATCH');
      expect(method('delete')).to.equal('DELETE');
      expect(method('option')).to.equal('OPTION');
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Lazy Test,"{'line': 27, 'column': 13, 'index': 793}","it('should support a custom fn', function () {
      expect(method('GET', (m) => m.toLowerCase())).to.equal('get');
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Lazy Test,"{'line': 33, 'column': 6, 'index': 962}","it('should pass the correct arguments to the custom fn', function () {
      const req = {};

      method(
        'GET',
        (method, request) => {
          expect(method).to.equal('GET');
          expect(request).to.equal(req);

          return method;
        },
        req
      );
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Lazy Test,"{'line': 49, 'column': 8, 'index': 1288}","it('should lower-case all header keys', function () {
      expect(
        headers({
          Accept: 'foo',
          'Content-Type': 'Bar'
        })
      ).to.deep.equal({
        accept: 'foo',
        'content-type': 'Bar'
      });
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Lazy Test,"{'line': 61, 'column': 8, 'index': 1541}","it('should exclude specified headers', function () {
      expect(
        headers(
          {
            Accept: 'foo',
            test: 'test',
            'Content-Type': 'Bar'
          },
          { exclude: ['test', 'content-type'] }
        )
      ).to.deep.equal({ accept: 'foo' });
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Lazy Test,"{'line': 74, 'column': 8, 'index': 1844}","it('should support a custom fn', function () {
      expect(
        headers(
          {
            Accept: 'foo',
            test: 'test',
            'Content-Type': 'Bar'
          },
          (headers) => {
            delete headers.test;

            return headers;
          }
        )
      ).to.deep.equal({ accept: 'foo', 'content-type': 'Bar' });
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Lazy Test,"{'line': 93, 'column': 6, 'index': 2293}","it('should pass the correct arguments to the custom fn', function () {
      const req = {};
      const reqHeaders = { foo: 'foo' };

      headers(
        reqHeaders,
        (headers, request) => {
          expect(headers).to.deep.equal(reqHeaders);
          expect(request).to.equal(req);

          return headers;
        },
        req
      );
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Lazy Test,"{'line': 109, 'column': 8, 'index': 2660}","it('should not mutate the original headers in the custom fn', function () {
      const reqHeaders = { foo: 'bar' };

      expect(
        headers(reqHeaders, (headers) => {
          delete headers.foo;

          return headers;
        })
      ).to.deep.equal({});

      expect(reqHeaders).to.deep.equal({ foo: 'bar' });
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Lazy Test,"{'line': 122, 'column': 13, 'index': 2956}","it('should sort query params', function () {
      expect(url('http://foo.com/?b=1&c=1&a=1', {})).to.equal(
        'http://foo.com/?a=1&b=1&c=1'
      );
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Lazy Test,"{'line': 188, 'column': 17, 'index': 5402}","it('should respect `matchRequestsBy.url` config', function () {
      [
        [
          /* config options */
          'hash',
          /* input url */
          'http://hash-test.com/?b=1&c=1&a=1#hello=world',
          /* expected when true */
          [true, 'http://hash-test.com/?a=1&b=1&c=1#hello=world'],
          /* expected when false */
          [false, 'http://hash-test.com/?a=1&b=1&c=1'],
          /* expected when custom fn */
          [
            (h) => h.replace('=', '!='),
            'http://hash-test.com/?a=1&b=1&c=1#hello!=world'
          ]
        ],
        [
          'protocol',
          'http://protocol-test.com/',
          [true, 'http://protocol-test.com/'],
          [false, '//protocol-test.com/'],
          [(p) => p.replace('http', 'https'), 'https://protocol-test.com/']
        ],
        [
          'query',
          'http://query-test.com/?b=1&c=1&a=1',
          [true, 'http://query-test.com/?a=1&b=1&c=1'],
          [false, 'http://query-test.com/'],
          [(q) => ({ ...q, c: 2 }), 'http://query-test.com/?a=1&b=1&c=2']
        ],
        [
          'username',
          'https://username:password@username-test.com/',
          [true, 'https://username:password@username-test.com/'],
          [false, 'https://username-test.com/'],
          [(u) => `${u}123`, 'https://username123:password@username-test.com/']
        ],
        [
          'password',
          'https://username:password@password-test.com/',
          [true, 'https://username:password@password-test.com/'],
          [false, 'https://username@password-test.com/'],
          [(p) => `${p}123`, 'https://username:password123@password-test.com/']
        ],
        [
          'port',
          'https://port-test.com:8000/',
          [true, 'https://port-test.com:8000/'],
          [false, 'https://port-test.com/'],
          [(p) => Number(p) + 1, 'https://port-test.com:8001/']
        ],
        [
          'pathname',
          'https://pathname-test.com/bar/baz',
          [true, 'https://pathname-test.com/bar/baz'],
          [false, 'https://pathname-test.com'],
          [(p) => p.replace('bar', 'foo'), 'https://pathname-test.com/foo/baz']
        ]
      ].forEach(([rule, input, ...options]) => {
        options.forEach(([optionValue, expectedOutput]) => {
          expect(url(input, { [rule]: optionValue })).to.equal(expectedOutput);
        });
      });
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Lazy Test,"{'line': 194, 'column': 13, 'index': 5562}","it('should respect relative urls', function () {
      expect(url('/some/path')).to.equal('/some/path');
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Lazy Test,"{'line': 199, 'column': 8, 'index': 5687}","it('should support a custom fn', function () {
      expect(
        url('https://foo.bar/', (url) => url.replace('bar', 'foo'))
      ).to.equal('https://foo.foo/');
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Lazy Test,"{'line': 206, 'column': 6, 'index': 5898}","it('should pass the correct arguments to the custom fn', function () {
      const req = {};

      url(
        'https://foo.bar',
        (url, request) => {
          expect(url).to.deep.equal('https://foo.bar');
          expect(request).to.equal(req);

          return url;
        },
        req
      );
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Lazy Test,"{'line': 221, 'column': 6, 'index': 6265}","it(""should pass the correct arguments to the individual `matchRequestsBy.url` option's custom fn"", function () {
      const req = {};

      url(
        'https://foo.bar',
        {
          protocol: (protocol, request) => {
            expect(protocol).to.deep.equal('https:');
            expect(request).to.equal(req);

            return protocol;
          }
        },
        req
      );
    })",steel
/packages/@pollyjs/core/tests/unit/utils/normalize-request-test.js,Lazy Test,"{'line': 244, 'column': 6, 'index': 6802}","it('should pass the correct arguments to the custom fn', function () {
      const req = {};

      url(
        'body',
        (body, request) => {
          expect(body).to.deep.equal('body');
          expect(request).to.equal(req);

          return body;
        },
        req
      );
    })",steel
/packages/@pollyjs/core/tests/unit/utils/http-headers-test.js,Duplicate Assert,"{'line': 43, 'column': 4, 'index': 1175}","it('should delete header regardless of case', function () {
    const headers = new HTTPHeaders();

    headers['Content-Type'] = 'application/json';
    expect(keys(headers)).to.deep.equal(['content-type']);

    delete headers['Content-Type'];
    expect(keys(headers)).to.deep.equal([]);

    headers['Content-Type'] = 'application/json';
    expect(keys(headers)).to.deep.equal(['content-type']);

    delete headers['CONTENT-TYPE'];
    expect(keys(headers)).to.deep.equal([]);
  })",steel
/packages/@pollyjs/core/tests/unit/utils/http-headers-test.js,Duplicate Assert,"{'line': 46, 'column': 4, 'index': 1271}","it('should delete header regardless of case', function () {
    const headers = new HTTPHeaders();

    headers['Content-Type'] = 'application/json';
    expect(keys(headers)).to.deep.equal(['content-type']);

    delete headers['Content-Type'];
    expect(keys(headers)).to.deep.equal([]);

    headers['Content-Type'] = 'application/json';
    expect(keys(headers)).to.deep.equal(['content-type']);

    delete headers['CONTENT-TYPE'];
    expect(keys(headers)).to.deep.equal([]);
  })",steel
/packages/@pollyjs/core/tests/unit/utils/http-headers-test.js,Duplicate Assert,"{'line': 49, 'column': 4, 'index': 1367}","it('should delete header regardless of case', function () {
    const headers = new HTTPHeaders();

    headers['Content-Type'] = 'application/json';
    expect(keys(headers)).to.deep.equal(['content-type']);

    delete headers['Content-Type'];
    expect(keys(headers)).to.deep.equal([]);

    headers['Content-Type'] = 'application/json';
    expect(keys(headers)).to.deep.equal(['content-type']);

    delete headers['CONTENT-TYPE'];
    expect(keys(headers)).to.deep.equal([]);
  })",steel
/packages/@pollyjs/core/tests/unit/utils/http-headers-test.js,Duplicate Assert,"{'line': 52, 'column': 4, 'index': 1463}","it('should delete header regardless of case', function () {
    const headers = new HTTPHeaders();

    headers['Content-Type'] = 'application/json';
    expect(keys(headers)).to.deep.equal(['content-type']);

    delete headers['Content-Type'];
    expect(keys(headers)).to.deep.equal([]);

    headers['Content-Type'] = 'application/json';
    expect(keys(headers)).to.deep.equal(['content-type']);

    delete headers['CONTENT-TYPE'];
    expect(keys(headers)).to.deep.equal([]);
  })",steel
/packages/@pollyjs/core/tests/unit/utils/http-headers-test.js,Duplicate Assert,"{'line': 59, 'column': 4, 'index': 1685}","it('should delete header when set with a null/undefined value', function () {
    const headers = new HTTPHeaders();

    headers['Content-Type'] = 'application/json';
    expect(keys(headers)).to.deep.equal(['content-type']);

    headers['Content-Type'] = null;
    expect(keys(headers)).to.deep.equal([]);

    headers['Content-Type'] = 'application/json';
    expect(keys(headers)).to.deep.equal(['content-type']);

    headers['Content-Type'] = undefined;
    expect(keys(headers)).to.deep.equal([]);
  })",steel
/packages/@pollyjs/core/tests/unit/utils/http-headers-test.js,Duplicate Assert,"{'line': 62, 'column': 4, 'index': 1781}","it('should delete header when set with a null/undefined value', function () {
    const headers = new HTTPHeaders();

    headers['Content-Type'] = 'application/json';
    expect(keys(headers)).to.deep.equal(['content-type']);

    headers['Content-Type'] = null;
    expect(keys(headers)).to.deep.equal([]);

    headers['Content-Type'] = 'application/json';
    expect(keys(headers)).to.deep.equal(['content-type']);

    headers['Content-Type'] = undefined;
    expect(keys(headers)).to.deep.equal([]);
  })",steel
/packages/@pollyjs/core/tests/unit/utils/http-headers-test.js,Duplicate Assert,"{'line': 65, 'column': 4, 'index': 1877}","it('should delete header when set with a null/undefined value', function () {
    const headers = new HTTPHeaders();

    headers['Content-Type'] = 'application/json';
    expect(keys(headers)).to.deep.equal(['content-type']);

    headers['Content-Type'] = null;
    expect(keys(headers)).to.deep.equal([]);

    headers['Content-Type'] = 'application/json';
    expect(keys(headers)).to.deep.equal(['content-type']);

    headers['Content-Type'] = undefined;
    expect(keys(headers)).to.deep.equal([]);
  })",steel
/packages/@pollyjs/core/tests/unit/utils/http-headers-test.js,Duplicate Assert,"{'line': 68, 'column': 4, 'index': 1978}","it('should delete header when set with a null/undefined value', function () {
    const headers = new HTTPHeaders();

    headers['Content-Type'] = 'application/json';
    expect(keys(headers)).to.deep.equal(['content-type']);

    headers['Content-Type'] = null;
    expect(keys(headers)).to.deep.equal([]);

    headers['Content-Type'] = 'application/json';
    expect(keys(headers)).to.deep.equal(['content-type']);

    headers['Content-Type'] = undefined;
    expect(keys(headers)).to.deep.equal([]);
  })",steel
/packages/@pollyjs/core/tests/unit/utils/deferred-promise-test.js,Exception Handling,"{'line': 22, 'column': 4, 'index': 599}","it('should reject when calling .reject()', async function () {
    const promise = defer();

    promise.reject(new Error('42'));

    try {
      await promise;
    } catch (error) {
      expect(error).to.be.an('error');
      expect(error.message).to.equal('42');
    }
  })",steel
/packages/@pollyjs/core/tests/unit/server/server-test.js,Conditional Test Logic,"{'line': 52, 'column': 24, 'index': 1569}","it('should differentiate hosts with different protocols', function () {
      ['http', 'https'].forEach((protocol) => {
        server.get(`${protocol}://foo.bar`).intercept(() => protocol);
        expect(request('GET', `${protocol}://foo.bar`)).to.equal(protocol);
      });
    })",steel
/packages/@pollyjs/core/tests/unit/server/server-test.js,Conditional Test Logic,"{'line': 132, 'column': 8, 'index': 3979}","it('should concat handlers for same paths', async function () {
      [
        '/ping',
        '/ping/:id',
        '/ping/*path',
        'http://ping.com',
        'http://ping.com/pong/:id',
        'http://ping.com/pong/*path'
      ].forEach((url) => {
        addHandlers(url);
        expect(server.lookup('GET', url).handlers).to.have.lengthOf(3);
      });
    })",steel
/packages/@pollyjs/core/tests/unit/server/server-test.js,Duplicate Assert,"{'line': 140, 'column': 6, 'index': 4239}","it('should concat handlers for same paths with a trailing slash', async function () {
      addHandlers('/ping');
      expect(server.lookup('GET', '/ping').handlers).to.have.lengthOf(3);

      addHandlers('/ping/');
      expect(server.lookup('GET', '/ping').handlers).to.have.lengthOf(6);
      expect(server.lookup('GET', '/ping/').handlers).to.have.lengthOf(6);

      addHandlers('http://ping.com');
      expect(server.lookup('GET', 'http://ping.com').handlers).to.have.lengthOf(
        3
      );

      addHandlers('http://ping.com/');
      expect(server.lookup('GET', 'http://ping.com').handlers).to.have.lengthOf(
        6
      );
      expect(
        server.lookup('GET', 'http://ping.com/').handlers
      ).to.have.lengthOf(6);
    })",steel
/packages/@pollyjs/core/tests/unit/server/server-test.js,Duplicate Assert,"{'line': 143, 'column': 6, 'index': 4343}","it('should concat handlers for same paths with a trailing slash', async function () {
      addHandlers('/ping');
      expect(server.lookup('GET', '/ping').handlers).to.have.lengthOf(3);

      addHandlers('/ping/');
      expect(server.lookup('GET', '/ping').handlers).to.have.lengthOf(6);
      expect(server.lookup('GET', '/ping/').handlers).to.have.lengthOf(6);

      addHandlers('http://ping.com');
      expect(server.lookup('GET', 'http://ping.com').handlers).to.have.lengthOf(
        3
      );

      addHandlers('http://ping.com/');
      expect(server.lookup('GET', 'http://ping.com').handlers).to.have.lengthOf(
        6
      );
      expect(
        server.lookup('GET', 'http://ping.com/').handlers
      ).to.have.lengthOf(6);
    })",steel
/packages/@pollyjs/core/tests/unit/server/server-test.js,Duplicate Assert,"{'line': 147, 'column': 6, 'index': 4531}","it('should concat handlers for same paths with a trailing slash', async function () {
      addHandlers('/ping');
      expect(server.lookup('GET', '/ping').handlers).to.have.lengthOf(3);

      addHandlers('/ping/');
      expect(server.lookup('GET', '/ping').handlers).to.have.lengthOf(6);
      expect(server.lookup('GET', '/ping/').handlers).to.have.lengthOf(6);

      addHandlers('http://ping.com');
      expect(server.lookup('GET', 'http://ping.com').handlers).to.have.lengthOf(
        3
      );

      addHandlers('http://ping.com/');
      expect(server.lookup('GET', 'http://ping.com').handlers).to.have.lengthOf(
        6
      );
      expect(
        server.lookup('GET', 'http://ping.com/').handlers
      ).to.have.lengthOf(6);
    })",steel
/packages/@pollyjs/core/tests/unit/server/server-test.js,Duplicate Assert,"{'line': 152, 'column': 6, 'index': 4671}","it('should concat handlers for same paths with a trailing slash', async function () {
      addHandlers('/ping');
      expect(server.lookup('GET', '/ping').handlers).to.have.lengthOf(3);

      addHandlers('/ping/');
      expect(server.lookup('GET', '/ping').handlers).to.have.lengthOf(6);
      expect(server.lookup('GET', '/ping/').handlers).to.have.lengthOf(6);

      addHandlers('http://ping.com');
      expect(server.lookup('GET', 'http://ping.com').handlers).to.have.lengthOf(
        3
      );

      addHandlers('http://ping.com/');
      expect(server.lookup('GET', 'http://ping.com').handlers).to.have.lengthOf(
        6
      );
      expect(
        server.lookup('GET', 'http://ping.com/').handlers
      ).to.have.lengthOf(6);
    })",steel
/packages/@pollyjs/core/tests/unit/server/server-test.js,Duplicate Assert,"{'line': 162, 'column': 6, 'index': 5018}","it('should concat handlers for same paths with different dynamic segment names', async function () {
      addHandlers('/ping/:id');
      expect(server.lookup('GET', '/ping/:id').handlers).to.have.lengthOf(3);

      addHandlers('/ping/:uuid');
      expect(server.lookup('GET', '/ping/:id').handlers).to.have.lengthOf(6);
      expect(server.lookup('GET', '/ping/:uuid').handlers).to.have.lengthOf(6);
    })",steel
/packages/@pollyjs/core/tests/unit/server/server-test.js,Duplicate Assert,"{'line': 165, 'column': 6, 'index': 5131}","it('should concat handlers for same paths with different dynamic segment names', async function () {
      addHandlers('/ping/:id');
      expect(server.lookup('GET', '/ping/:id').handlers).to.have.lengthOf(3);

      addHandlers('/ping/:uuid');
      expect(server.lookup('GET', '/ping/:id').handlers).to.have.lengthOf(6);
      expect(server.lookup('GET', '/ping/:uuid').handlers).to.have.lengthOf(6);
    })",steel
/packages/@pollyjs/core/tests/unit/server/server-test.js,Duplicate Assert,"{'line': 171, 'column': 6, 'index': 5434}","it('should concat handlers for same paths with different star segment names', async function () {
      addHandlers('/ping/*path');
      expect(server.lookup('GET', '/ping/*path').handlers).to.have.lengthOf(3);

      addHandlers('/ping/*rest');
      expect(server.lookup('GET', '/ping/*path').handlers).to.have.lengthOf(6);
      expect(server.lookup('GET', '/ping/*rest').handlers).to.have.lengthOf(6);
    })",steel
/packages/@pollyjs/core/tests/unit/server/server-test.js,Duplicate Assert,"{'line': 174, 'column': 6, 'index': 5549}","it('should concat handlers for same paths with different star segment names', async function () {
      addHandlers('/ping/*path');
      expect(server.lookup('GET', '/ping/*path').handlers).to.have.lengthOf(3);

      addHandlers('/ping/*rest');
      expect(server.lookup('GET', '/ping/*path').handlers).to.have.lengthOf(6);
      expect(server.lookup('GET', '/ping/*rest').handlers).to.have.lengthOf(6);
    })",steel
/packages/@pollyjs/core/tests/unit/server/server-test.js,Duplicate Assert,"{'line': 180, 'column': 6, 'index': 5875}","it('should concat handlers for same paths with different dynamic and star segment names', async function () {
      addHandlers('/ping/:id/pong/*path');
      expect(
        server.lookup('GET', '/ping/:id/pong/*path').handlers
      ).to.have.lengthOf(3);

      addHandlers('/ping/:uuid/pong/*rest');
      expect(
        server.lookup('GET', '/ping/:id/pong/*path').handlers
      ).to.have.lengthOf(6);
      expect(
        server.lookup('GET', '/ping/:uuid/pong/*rest').handlers
      ).to.have.lengthOf(6);
    })",steel
/packages/@pollyjs/core/tests/unit/server/server-test.js,Duplicate Assert,"{'line': 185, 'column': 6, 'index': 6026}","it('should concat handlers for same paths with different dynamic and star segment names', async function () {
      addHandlers('/ping/:id/pong/*path');
      expect(
        server.lookup('GET', '/ping/:id/pong/*path').handlers
      ).to.have.lengthOf(3);

      addHandlers('/ping/:uuid/pong/*rest');
      expect(
        server.lookup('GET', '/ping/:id/pong/*path').handlers
      ).to.have.lengthOf(6);
      expect(
        server.lookup('GET', '/ping/:uuid/pong/*rest').handlers
      ).to.have.lengthOf(6);
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Conditional Test Logic,"{'line': 122, 'column': 36, 'index': 4235}","it('throws when passing a non-function to intercept', function () {
      const handler = new Handler();

      [null, undefined, {}, [], ''].forEach((value) => {
        expect(() => handler.intercept(value)).to.throw(
          /Invalid intercept handler provided/
        );
      });
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Conditional Test Logic,"{'line': 132, 'column': 19, 'index': 4515}","it('throws when passing an invalid times option', function () {
      const handler = new Handler();

      ['1', -1, 0].forEach((times) => {
        expect(() => handler.intercept(() => {}, { times })).to.throw(
          /Invalid number provided/
        );
      });
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Conditional Test Logic,"{'line': 232, 'column': 31, 'index': 7491}","it('should allow setting a falsy recordingName', function () {
      const handler = new Handler();

      expect(handler.has('recordingName')).to.be.false;

      [false, undefined, null].forEach((value) => {
        handler.recordingName(value);
        expect(handler.has('recordingName')).to.be.true;
        expect(handler.get('recordingName')).to.equal(value);
      });
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Conditional Test Logic,"{'line': 242, 'column': 24, 'index': 7827}","it('throws when passing an invalid truthy recording name', function () {
      const handler = new Handler();

      [1, {}, [], true].forEach((value) => {
        expect(() => handler.recordingName(value)).to.throw(
          /Invalid recording name provided/
        );
      });
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Conditional Test Logic,"{'line': 269, 'column': 44, 'index': 8651}","it('throws when passing an invalid config', function () {
      const handler = new Handler();

      [false, true, null, undefined, 1, []].forEach((config) => {
        expect(() => handler.configure(config)).to.throw(
          /Invalid config provided/
        );
      });

      [
        'mode',
        'adapters',
        'adapterOptions',
        'persister',
        'persisterOptions'
      ].forEach((key) => {
        expect(() => handler.configure({ [key]: key })).to.throw(
          /Invalid configuration option provided/
        );
      });
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Conditional Test Logic,"{'line': 281, 'column': 8, 'index': 8915}","it('throws when passing an invalid config', function () {
      const handler = new Handler();

      [false, true, null, undefined, 1, []].forEach((config) => {
        expect(() => handler.configure(config)).to.throw(
          /Invalid config provided/
        );
      });

      [
        'mode',
        'adapters',
        'adapterOptions',
        'persister',
        'persisterOptions'
      ].forEach((key) => {
        expect(() => handler.configure({ [key]: key })).to.throw(
          /Invalid configuration option provided/
        );
      });
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Conditional Test Logic,"{'line': 310, 'column': 52, 'index': 9675}","it('throws when passing an invalid fn', function () {
      const handler = new Handler();

      [false, true, null, undefined, 1, [], {}, ''].forEach((fn) => {
        expect(() => handler.filter(fn)).to.throw(
          /Invalid filter callback provided/
        );
      });
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Conditional Test Logic,"{'line': 338, 'column': 19, 'index': 10416}","it('throws when passing an invalid times option', function () {
      const handler = new Handler();

      ['1', -1, 0].forEach((times) => {
        expect(() => handler.times(times)).to.throw(/Invalid number provided/);
      });
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 25, 'column': 6, 'index': 763}","it('registers a known event via .on()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;

      expect(eventEmitter.hasListeners('request')).to.be.false;

      handler.on('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;

      handler.on('request', () => {});
      expect(eventEmitter.listeners('request')).to.have.lengthOf(2);
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 28, 'column': 6, 'index': 867}","it('registers a known event via .on()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;

      expect(eventEmitter.hasListeners('request')).to.be.false;

      handler.on('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;

      handler.on('request', () => {});
      expect(eventEmitter.listeners('request')).to.have.lengthOf(2);
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 39, 'column': 6, 'index': 1267}","it('registers a known event via .on() with { times }', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;

      handler.on('request', () => {}, { times: 2 });
      expect(eventEmitter.hasListeners('request')).to.be.true;

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.true;

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 42, 'column': 6, 'index': 1371}","it('registers a known event via .on() with { times }', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;

      handler.on('request', () => {}, { times: 2 });
      expect(eventEmitter.hasListeners('request')).to.be.true;

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.true;

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 45, 'column': 6, 'index': 1475}","it('registers a known event via .on() with { times }', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;

      handler.on('request', () => {}, { times: 2 });
      expect(eventEmitter.hasListeners('request')).to.be.true;

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.true;

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 53, 'column': 6, 'index': 1761}","it('registers a known event via .on() with .times()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;

      handler.times(2).on('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.true;

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 56, 'column': 6, 'index': 1865}","it('registers a known event via .on() with .times()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;

      handler.times(2).on('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.true;

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 59, 'column': 6, 'index': 1969}","it('registers a known event via .on() with .times()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;

      handler.times(2).on('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.true;

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 67, 'column': 6, 'index': 2297}","it('registers a known event via .on() with .times() and override with { times }', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;

      handler.times(2).on('request', () => {}, { times: 1 });
      expect(eventEmitter.hasListeners('request')).to.be.true;

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 70, 'column': 6, 'index': 2401}","it('registers a known event via .on() with .times() and override with { times }', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;

      handler.times(2).on('request', () => {}, { times: 1 });
      expect(eventEmitter.hasListeners('request')).to.be.true;

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 77, 'column': 6, 'index': 2627}","it('registers a known event via .once()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;

      expect(eventEmitter.hasListeners('request')).to.be.false;

      handler.once('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;

      handler.once('request', () => {});
      expect(eventEmitter.listeners('request')).to.have.lengthOf(2);

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 80, 'column': 6, 'index': 2733}","it('registers a known event via .once()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;

      expect(eventEmitter.hasListeners('request')).to.be.false;

      handler.once('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;

      handler.once('request', () => {});
      expect(eventEmitter.listeners('request')).to.have.lengthOf(2);

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 86, 'column': 6, 'index': 2948}","it('registers a known event via .once()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;

      expect(eventEmitter.hasListeners('request')).to.be.false;

      handler.once('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;

      handler.once('request', () => {});
      expect(eventEmitter.listeners('request')).to.have.lengthOf(2);

      eventEmitter.emitSync('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 97, 'column': 6, 'index': 3314}","it('un-registers a known event via .off()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;
      const fn = () => {};

      handler.on('request', fn);
      handler.on('request', () => {});
      handler.on('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(3);

      handler.off('request', fn);
      expect(eventEmitter.hasListeners('request')).to.be.true;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(2);
      expect(eventEmitter.listeners('request').includes(fn)).to.be.false;

      handler.off('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 98, 'column': 6, 'index': 3377}","it('un-registers a known event via .off()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;
      const fn = () => {};

      handler.on('request', fn);
      handler.on('request', () => {});
      handler.on('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(3);

      handler.off('request', fn);
      expect(eventEmitter.hasListeners('request')).to.be.true;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(2);
      expect(eventEmitter.listeners('request').includes(fn)).to.be.false;

      handler.off('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 101, 'column': 6, 'index': 3481}","it('un-registers a known event via .off()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;
      const fn = () => {};

      handler.on('request', fn);
      handler.on('request', () => {});
      handler.on('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(3);

      handler.off('request', fn);
      expect(eventEmitter.hasListeners('request')).to.be.true;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(2);
      expect(eventEmitter.listeners('request').includes(fn)).to.be.false;

      handler.off('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 102, 'column': 6, 'index': 3544}","it('un-registers a known event via .off()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;
      const fn = () => {};

      handler.on('request', fn);
      handler.on('request', () => {});
      handler.on('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(3);

      handler.off('request', fn);
      expect(eventEmitter.hasListeners('request')).to.be.true;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(2);
      expect(eventEmitter.listeners('request').includes(fn)).to.be.false;

      handler.off('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 106, 'column': 6, 'index': 3718}","it('un-registers a known event via .off()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;
      const fn = () => {};

      handler.on('request', fn);
      handler.on('request', () => {});
      handler.on('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(3);

      handler.off('request', fn);
      expect(eventEmitter.hasListeners('request')).to.be.true;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(2);
      expect(eventEmitter.listeners('request').includes(fn)).to.be.false;

      handler.off('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 107, 'column': 6, 'index': 3782}","it('un-registers a known event via .off()', function () {
      const handler = new Handler();
      const { _eventEmitter: eventEmitter } = handler;
      const fn = () => {};

      handler.on('request', fn);
      handler.on('request', () => {});
      handler.on('request', () => {});
      expect(eventEmitter.hasListeners('request')).to.be.true;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(3);

      handler.off('request', fn);
      expect(eventEmitter.hasListeners('request')).to.be.true;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(2);
      expect(eventEmitter.listeners('request').includes(fn)).to.be.false;

      handler.off('request');
      expect(eventEmitter.hasListeners('request')).to.be.false;
      expect(eventEmitter.listeners('request')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 143, 'column': 6, 'index': 4836}","it('registers an intercept handler with { times }', function () {
      const handler = new Handler();

      handler.intercept(() => {}, { times: 2 });
      expect(handler.has('intercept')).to.be.true;

      handler.get('intercept')();
      expect(handler.has('intercept')).to.be.true;

      handler.get('intercept')();
      expect(handler.has('intercept')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 146, 'column': 6, 'index': 4922}","it('registers an intercept handler with { times }', function () {
      const handler = new Handler();

      handler.intercept(() => {}, { times: 2 });
      expect(handler.has('intercept')).to.be.true;

      handler.get('intercept')();
      expect(handler.has('intercept')).to.be.true;

      handler.get('intercept')();
      expect(handler.has('intercept')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 149, 'column': 6, 'index': 5008}","it('registers an intercept handler with { times }', function () {
      const handler = new Handler();

      handler.intercept(() => {}, { times: 2 });
      expect(handler.has('intercept')).to.be.true;

      handler.get('intercept')();
      expect(handler.has('intercept')).to.be.true;

      handler.get('intercept')();
      expect(handler.has('intercept')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 156, 'column': 6, 'index': 5220}","it('registers an intercept handler with .times()', function () {
      const handler = new Handler();

      handler.times(2).intercept(() => {});
      expect(handler.has('intercept')).to.be.true;

      handler.get('intercept')();
      expect(handler.has('intercept')).to.be.true;

      handler.get('intercept')();
      expect(handler.has('intercept')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 159, 'column': 6, 'index': 5306}","it('registers an intercept handler with .times()', function () {
      const handler = new Handler();

      handler.times(2).intercept(() => {});
      expect(handler.has('intercept')).to.be.true;

      handler.get('intercept')();
      expect(handler.has('intercept')).to.be.true;

      handler.get('intercept')();
      expect(handler.has('intercept')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 162, 'column': 6, 'index': 5392}","it('registers an intercept handler with .times()', function () {
      const handler = new Handler();

      handler.times(2).intercept(() => {});
      expect(handler.has('intercept')).to.be.true;

      handler.get('intercept')();
      expect(handler.has('intercept')).to.be.true;

      handler.get('intercept')();
      expect(handler.has('intercept')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 169, 'column': 6, 'index': 5646}","it('registers an intercept handler with .times() and override with { times }', function () {
      const handler = new Handler();

      handler.times(2).intercept(() => {}, { times: 1 });
      expect(handler.has('intercept')).to.be.true;

      handler.get('intercept')();
      expect(handler.has('intercept')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 172, 'column': 6, 'index': 5732}","it('registers an intercept handler with .times() and override with { times }', function () {
      const handler = new Handler();

      handler.times(2).intercept(() => {}, { times: 1 });
      expect(handler.has('intercept')).to.be.true;

      handler.get('intercept')();
      expect(handler.has('intercept')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 183, 'column': 6, 'index': 6000}","it('should work', function () {
      const handler = new Handler();

      expect(handler.has('passthrough')).to.be.false;

      handler.passthrough();
      expect(handler.get('passthrough')).to.be.true;

      handler.passthrough(false);
      expect(handler.get('passthrough')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 186, 'column': 6, 'index': 6088}","it('should work', function () {
      const handler = new Handler();

      expect(handler.has('passthrough')).to.be.false;

      handler.passthrough();
      expect(handler.get('passthrough')).to.be.true;

      handler.passthrough(false);
      expect(handler.get('passthrough')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 193, 'column': 6, 'index': 6293}","it('removes the intercept handler on passthrough', function () {
      const handler = new Handler();

      handler.intercept(() => {});
      expect(handler.has('intercept')).to.be.true;

      handler.passthrough();
      expect(handler.get('passthrough')).to.be.true;
      expect(handler.has('intercept')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 197, 'column': 6, 'index': 6427}","it('removes the intercept handler on passthrough', function () {
      const handler = new Handler();

      handler.intercept(() => {});
      expect(handler.has('intercept')).to.be.true;

      handler.passthrough();
      expect(handler.get('passthrough')).to.be.true;
      expect(handler.has('intercept')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 204, 'column': 6, 'index': 6613}","it('disables passthrough on intercept', function () {
      const handler = new Handler();

      handler.passthrough();
      expect(handler.get('passthrough')).to.be.true;
      expect(handler.has('intercept')).to.be.false;

      handler.intercept(() => {});
      expect(handler.has('intercept')).to.be.true;
      expect(handler.get('passthrough')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 205, 'column': 6, 'index': 6666}","it('disables passthrough on intercept', function () {
      const handler = new Handler();

      handler.passthrough();
      expect(handler.get('passthrough')).to.be.true;
      expect(handler.has('intercept')).to.be.false;

      handler.intercept(() => {});
      expect(handler.has('intercept')).to.be.true;
      expect(handler.get('passthrough')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 208, 'column': 6, 'index': 6754}","it('disables passthrough on intercept', function () {
      const handler = new Handler();

      handler.passthrough();
      expect(handler.get('passthrough')).to.be.true;
      expect(handler.has('intercept')).to.be.false;

      handler.intercept(() => {});
      expect(handler.has('intercept')).to.be.true;
      expect(handler.get('passthrough')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 209, 'column': 6, 'index': 6805}","it('disables passthrough on intercept', function () {
      const handler = new Handler();

      handler.passthrough();
      expect(handler.get('passthrough')).to.be.true;
      expect(handler.has('intercept')).to.be.false;

      handler.intercept(() => {});
      expect(handler.has('intercept')).to.be.true;
      expect(handler.get('passthrough')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 217, 'column': 6, 'index': 6993}","it('should work', function () {
      const handler = new Handler();

      expect(handler.has('recordingName')).to.be.false;

      handler.recordingName('Test');
      expect(handler.get('recordingName')).to.equal('Test');

      handler.recordingName();
      expect(handler.has('recordingName')).to.be.true;
      expect(handler.get('recordingName')).to.be.undefined;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 220, 'column': 6, 'index': 7087}","it('should work', function () {
      const handler = new Handler();

      expect(handler.has('recordingName')).to.be.false;

      handler.recordingName('Test');
      expect(handler.get('recordingName')).to.equal('Test');

      handler.recordingName();
      expect(handler.has('recordingName')).to.be.true;
      expect(handler.get('recordingName')).to.be.undefined;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 223, 'column': 6, 'index': 7180}","it('should work', function () {
      const handler = new Handler();

      expect(handler.has('recordingName')).to.be.false;

      handler.recordingName('Test');
      expect(handler.get('recordingName')).to.equal('Test');

      handler.recordingName();
      expect(handler.has('recordingName')).to.be.true;
      expect(handler.get('recordingName')).to.be.undefined;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 224, 'column': 6, 'index': 7235}","it('should work', function () {
      const handler = new Handler();

      expect(handler.has('recordingName')).to.be.false;

      handler.recordingName('Test');
      expect(handler.get('recordingName')).to.equal('Test');

      handler.recordingName();
      expect(handler.has('recordingName')).to.be.true;
      expect(handler.get('recordingName')).to.be.undefined;
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 230, 'column': 6, 'index': 7409}","it('should allow setting a falsy recordingName', function () {
      const handler = new Handler();

      expect(handler.has('recordingName')).to.be.false;

      [false, undefined, null].forEach((value) => {
        handler.recordingName(value);
        expect(handler.has('recordingName')).to.be.true;
        expect(handler.get('recordingName')).to.equal(value);
      });
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 234, 'column': 8, 'index': 7558}","it('should allow setting a falsy recordingName', function () {
      const handler = new Handler();

      expect(handler.has('recordingName')).to.be.false;

      [false, undefined, null].forEach((value) => {
        handler.recordingName(value);
        expect(handler.has('recordingName')).to.be.true;
        expect(handler.get('recordingName')).to.equal(value);
      });
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 254, 'column': 6, 'index': 8110}","it('should work', function () {
      const handler = new Handler();

      expect(handler.get('config')).to.deep.equal({});

      handler.configure({ logLevel: 'info' });
      expect(handler.get('config')).to.deep.equal({ logLevel: 'info' });

      handler.configure({ recordIfMissing: false });
      expect(handler.get('config')).to.deep.equal({ recordIfMissing: false });

      handler.configure({});
      expect(handler.get('config')).to.deep.equal({});
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 257, 'column': 6, 'index': 8213}","it('should work', function () {
      const handler = new Handler();

      expect(handler.get('config')).to.deep.equal({});

      handler.configure({ logLevel: 'info' });
      expect(handler.get('config')).to.deep.equal({ logLevel: 'info' });

      handler.configure({ recordIfMissing: false });
      expect(handler.get('config')).to.deep.equal({ recordIfMissing: false });

      handler.configure({});
      expect(handler.get('config')).to.deep.equal({});
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 260, 'column': 6, 'index': 8340}","it('should work', function () {
      const handler = new Handler();

      expect(handler.get('config')).to.deep.equal({});

      handler.configure({ logLevel: 'info' });
      expect(handler.get('config')).to.deep.equal({ logLevel: 'info' });

      handler.configure({ recordIfMissing: false });
      expect(handler.get('config')).to.deep.equal({ recordIfMissing: false });

      handler.configure({});
      expect(handler.get('config')).to.deep.equal({});
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 263, 'column': 6, 'index': 8449}","it('should work', function () {
      const handler = new Handler();

      expect(handler.get('config')).to.deep.equal({});

      handler.configure({ logLevel: 'info' });
      expect(handler.get('config')).to.deep.equal({ logLevel: 'info' });

      handler.configure({ recordIfMissing: false });
      expect(handler.get('config')).to.deep.equal({ recordIfMissing: false });

      handler.configure({});
      expect(handler.get('config')).to.deep.equal({});
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 295, 'column': 6, 'index': 9277}","it('should work', function () {
      const handler = new Handler();
      const filters = handler.get('filters');
      const fn = () => {};

      expect(filters.size).to.equal(0);

      handler.filter(fn);
      expect(filters.size).to.equal(1);

      handler.filter(fn);
      expect(filters.size).to.equal(1);

      handler.filter(() => {});
      expect(filters.size).to.equal(2);
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 298, 'column': 6, 'index': 9344}","it('should work', function () {
      const handler = new Handler();
      const filters = handler.get('filters');
      const fn = () => {};

      expect(filters.size).to.equal(0);

      handler.filter(fn);
      expect(filters.size).to.equal(1);

      handler.filter(fn);
      expect(filters.size).to.equal(1);

      handler.filter(() => {});
      expect(filters.size).to.equal(2);
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 301, 'column': 6, 'index': 9411}","it('should work', function () {
      const handler = new Handler();
      const filters = handler.get('filters');
      const fn = () => {};

      expect(filters.size).to.equal(0);

      handler.filter(fn);
      expect(filters.size).to.equal(1);

      handler.filter(fn);
      expect(filters.size).to.equal(1);

      handler.filter(() => {});
      expect(filters.size).to.equal(2);
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 304, 'column': 6, 'index': 9484}","it('should work', function () {
      const handler = new Handler();
      const filters = handler.get('filters');
      const fn = () => {};

      expect(filters.size).to.equal(0);

      handler.filter(fn);
      expect(filters.size).to.equal(1);

      handler.filter(fn);
      expect(filters.size).to.equal(1);

      handler.filter(() => {});
      expect(filters.size).to.equal(2);
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 323, 'column': 6, 'index': 10002}","it('should work', function () {
      const handler = new Handler();
      const defaultOptions = handler.get('defaultOptions');

      expect(defaultOptions).to.deep.equal({});

      handler.times(1);
      expect(defaultOptions).to.deep.equal({ times: 1 });

      handler.times(2);
      expect(defaultOptions).to.deep.equal({ times: 2 });

      handler.times();
      expect(defaultOptions).to.deep.equal({});
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 326, 'column': 6, 'index': 10075}","it('should work', function () {
      const handler = new Handler();
      const defaultOptions = handler.get('defaultOptions');

      expect(defaultOptions).to.deep.equal({});

      handler.times(1);
      expect(defaultOptions).to.deep.equal({ times: 1 });

      handler.times(2);
      expect(defaultOptions).to.deep.equal({ times: 2 });

      handler.times();
      expect(defaultOptions).to.deep.equal({});
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 329, 'column': 6, 'index': 10158}","it('should work', function () {
      const handler = new Handler();
      const defaultOptions = handler.get('defaultOptions');

      expect(defaultOptions).to.deep.equal({});

      handler.times(1);
      expect(defaultOptions).to.deep.equal({ times: 1 });

      handler.times(2);
      expect(defaultOptions).to.deep.equal({ times: 2 });

      handler.times();
      expect(defaultOptions).to.deep.equal({});
    })",steel
/packages/@pollyjs/core/tests/unit/server/handler-test.js,Duplicate Assert,"{'line': 332, 'column': 6, 'index': 10240}","it('should work', function () {
      const handler = new Handler();
      const defaultOptions = handler.get('defaultOptions');

      expect(defaultOptions).to.deep.equal({});

      handler.times(1);
      expect(defaultOptions).to.deep.equal({ times: 1 });

      handler.times(2);
      expect(defaultOptions).to.deep.equal({ times: 2 });

      handler.times();
      expect(defaultOptions).to.deep.equal({});
    })",steel
/packages/@pollyjs/core/tests/unit/-private/response-test.js,Conditional Test Logic,"{'line': 27, 'column': 31, 'index': 727}","it('.status()', function () {
      [100, '404', 500, '599'].forEach((statusCode) => {
        expect(response.status(statusCode).statusCode).to.equal(
          Number(statusCode)
        );
      });

      [null, '', 0, 99, 600, 999].forEach((statusCode) => {
        expect(() => response.status(statusCode)).to.throw(
          PollyError,
          /Invalid status code/
        );
      });
    })",steel
/packages/@pollyjs/core/tests/unit/-private/response-test.js,Conditional Test Logic,"{'line': 33, 'column': 34, 'index': 903}","it('.status()', function () {
      [100, '404', 500, '599'].forEach((statusCode) => {
        expect(response.status(statusCode).statusCode).to.equal(
          Number(statusCode)
        );
      });

      [null, '', 0, 99, 600, 999].forEach((statusCode) => {
        expect(() => response.status(statusCode)).to.throw(
          PollyError,
          /Invalid status code/
        );
      });
    })",steel
/packages/@pollyjs/core/tests/unit/-private/response-test.js,Duplicate Assert,"{'line': 54, 'column': 6, 'index': 1407}","it('.end()', function () {
      response.status(200);
      response.setHeader('foo', 'bar');

      expect(response.statusCode).to.equal(200);
      expect(response.headers).to.deep.equal({ foo: 'bar' });

      response.end();
      expect(() => response.status(404)).to.throw();
      expect(() => response.setHeader('bar', 'baz')).to.throw();

      expect(response.statusCode).to.equal(200);
      expect(response.headers).to.deep.equal({ foo: 'bar' });
    })",steel
/packages/@pollyjs/core/tests/unit/-private/response-test.js,Duplicate Assert,"{'line': 55, 'column': 6, 'index': 1456}","it('.end()', function () {
      response.status(200);
      response.setHeader('foo', 'bar');

      expect(response.statusCode).to.equal(200);
      expect(response.headers).to.deep.equal({ foo: 'bar' });

      response.end();
      expect(() => response.status(404)).to.throw();
      expect(() => response.setHeader('bar', 'baz')).to.throw();

      expect(response.statusCode).to.equal(200);
      expect(response.headers).to.deep.equal({ foo: 'bar' });
    })",steel
/packages/@pollyjs/core/tests/unit/-private/response-test.js,Duplicate Assert,"{'line': 61, 'column': 6, 'index': 1660}","it('.end()', function () {
      response.status(200);
      response.setHeader('foo', 'bar');

      expect(response.statusCode).to.equal(200);
      expect(response.headers).to.deep.equal({ foo: 'bar' });

      response.end();
      expect(() => response.status(404)).to.throw();
      expect(() => response.setHeader('bar', 'baz')).to.throw();

      expect(response.statusCode).to.equal(200);
      expect(response.headers).to.deep.equal({ foo: 'bar' });
    })",steel
/packages/@pollyjs/core/tests/unit/-private/response-test.js,Duplicate Assert,"{'line': 62, 'column': 6, 'index': 1709}","it('.end()', function () {
      response.status(200);
      response.setHeader('foo', 'bar');

      expect(response.statusCode).to.equal(200);
      expect(response.headers).to.deep.equal({ foo: 'bar' });

      response.end();
      expect(() => response.status(404)).to.throw();
      expect(() => response.setHeader('bar', 'baz')).to.throw();

      expect(response.statusCode).to.equal(200);
      expect(response.headers).to.deep.equal({ foo: 'bar' });
    })",steel
/packages/@pollyjs/core/tests/unit/-private/interceptor-test.js,Duplicate Assert,"{'line': 21, 'column': 4, 'index': 698}","it('should disable passthrough when calling abort and vise versa', function () {
    const interceptor = new Interceptor();

    expect(interceptor.shouldAbort).to.be.false;
    expect(interceptor.shouldPassthrough).to.be.false;

    interceptor.abort();
    expect(interceptor.shouldAbort).to.be.true;
    expect(interceptor.shouldPassthrough).to.be.false;

    interceptor.passthrough();
    expect(interceptor.shouldAbort).to.be.false;
    expect(interceptor.shouldPassthrough).to.be.true;
  })",steel
/packages/@pollyjs/core/tests/unit/-private/interceptor-test.js,Duplicate Assert,"{'line': 22, 'column': 4, 'index': 747}","it('should disable passthrough when calling abort and vise versa', function () {
    const interceptor = new Interceptor();

    expect(interceptor.shouldAbort).to.be.false;
    expect(interceptor.shouldPassthrough).to.be.false;

    interceptor.abort();
    expect(interceptor.shouldAbort).to.be.true;
    expect(interceptor.shouldPassthrough).to.be.false;

    interceptor.passthrough();
    expect(interceptor.shouldAbort).to.be.false;
    expect(interceptor.shouldPassthrough).to.be.true;
  })",steel
/packages/@pollyjs/core/tests/unit/-private/interceptor-test.js,Duplicate Assert,"{'line': 25, 'column': 4, 'index': 828}","it('should disable passthrough when calling abort and vise versa', function () {
    const interceptor = new Interceptor();

    expect(interceptor.shouldAbort).to.be.false;
    expect(interceptor.shouldPassthrough).to.be.false;

    interceptor.abort();
    expect(interceptor.shouldAbort).to.be.true;
    expect(interceptor.shouldPassthrough).to.be.false;

    interceptor.passthrough();
    expect(interceptor.shouldAbort).to.be.false;
    expect(interceptor.shouldPassthrough).to.be.true;
  })",steel
/packages/@pollyjs/core/tests/unit/-private/interceptor-test.js,Duplicate Assert,"{'line': 26, 'column': 4, 'index': 876}","it('should disable passthrough when calling abort and vise versa', function () {
    const interceptor = new Interceptor();

    expect(interceptor.shouldAbort).to.be.false;
    expect(interceptor.shouldPassthrough).to.be.false;

    interceptor.abort();
    expect(interceptor.shouldAbort).to.be.true;
    expect(interceptor.shouldPassthrough).to.be.false;

    interceptor.passthrough();
    expect(interceptor.shouldAbort).to.be.false;
    expect(interceptor.shouldPassthrough).to.be.true;
  })",steel
/packages/@pollyjs/core/tests/unit/-private/interceptor-test.js,Duplicate Assert,"{'line': 29, 'column': 4, 'index': 963}","it('should disable passthrough when calling abort and vise versa', function () {
    const interceptor = new Interceptor();

    expect(interceptor.shouldAbort).to.be.false;
    expect(interceptor.shouldPassthrough).to.be.false;

    interceptor.abort();
    expect(interceptor.shouldAbort).to.be.true;
    expect(interceptor.shouldPassthrough).to.be.false;

    interceptor.passthrough();
    expect(interceptor.shouldAbort).to.be.false;
    expect(interceptor.shouldPassthrough).to.be.true;
  })",steel
/packages/@pollyjs/core/tests/unit/-private/interceptor-test.js,Duplicate Assert,"{'line': 30, 'column': 4, 'index': 1012}","it('should disable passthrough when calling abort and vise versa', function () {
    const interceptor = new Interceptor();

    expect(interceptor.shouldAbort).to.be.false;
    expect(interceptor.shouldPassthrough).to.be.false;

    interceptor.abort();
    expect(interceptor.shouldAbort).to.be.true;
    expect(interceptor.shouldPassthrough).to.be.false;

    interceptor.passthrough();
    expect(interceptor.shouldAbort).to.be.false;
    expect(interceptor.shouldPassthrough).to.be.true;
  })",steel
/packages/@pollyjs/core/tests/unit/-private/interceptor-test.js,Duplicate Assert,"{'line': 36, 'column': 4, 'index': 1148}","it('.abort()', function () {
    const interceptor = new Interceptor();

    expect(interceptor.shouldAbort).to.be.false;
    expect(interceptor.shouldIntercept).to.be.true;

    interceptor.abort();

    expect(interceptor.shouldAbort).to.be.true;
    expect(interceptor.shouldIntercept).to.be.false;
  })",steel
/packages/@pollyjs/core/tests/unit/-private/interceptor-test.js,Duplicate Assert,"{'line': 37, 'column': 4, 'index': 1197}","it('.abort()', function () {
    const interceptor = new Interceptor();

    expect(interceptor.shouldAbort).to.be.false;
    expect(interceptor.shouldIntercept).to.be.true;

    interceptor.abort();

    expect(interceptor.shouldAbort).to.be.true;
    expect(interceptor.shouldIntercept).to.be.false;
  })",steel
/packages/@pollyjs/core/tests/unit/-private/interceptor-test.js,Duplicate Assert,"{'line': 41, 'column': 4, 'index': 1276}","it('.abort()', function () {
    const interceptor = new Interceptor();

    expect(interceptor.shouldAbort).to.be.false;
    expect(interceptor.shouldIntercept).to.be.true;

    interceptor.abort();

    expect(interceptor.shouldAbort).to.be.true;
    expect(interceptor.shouldIntercept).to.be.false;
  })",steel
/packages/@pollyjs/core/tests/unit/-private/interceptor-test.js,Duplicate Assert,"{'line': 42, 'column': 4, 'index': 1324}","it('.abort()', function () {
    const interceptor = new Interceptor();

    expect(interceptor.shouldAbort).to.be.false;
    expect(interceptor.shouldIntercept).to.be.true;

    interceptor.abort();

    expect(interceptor.shouldAbort).to.be.true;
    expect(interceptor.shouldIntercept).to.be.false;
  })",steel
/packages/@pollyjs/core/tests/unit/-private/interceptor-test.js,Duplicate Assert,"{'line': 48, 'column': 4, 'index': 1465}","it('.passthrough()', function () {
    const interceptor = new Interceptor();

    expect(interceptor.shouldPassthrough).to.be.false;
    expect(interceptor.shouldIntercept).to.be.true;

    interceptor.passthrough();

    expect(interceptor.shouldPassthrough).to.be.true;
    expect(interceptor.shouldIntercept).to.be.false;
  })",steel
/packages/@pollyjs/core/tests/unit/-private/interceptor-test.js,Duplicate Assert,"{'line': 49, 'column': 4, 'index': 1520}","it('.passthrough()', function () {
    const interceptor = new Interceptor();

    expect(interceptor.shouldPassthrough).to.be.false;
    expect(interceptor.shouldIntercept).to.be.true;

    interceptor.passthrough();

    expect(interceptor.shouldPassthrough).to.be.true;
    expect(interceptor.shouldIntercept).to.be.false;
  })",steel
/packages/@pollyjs/core/tests/unit/-private/interceptor-test.js,Duplicate Assert,"{'line': 53, 'column': 4, 'index': 1605}","it('.passthrough()', function () {
    const interceptor = new Interceptor();

    expect(interceptor.shouldPassthrough).to.be.false;
    expect(interceptor.shouldIntercept).to.be.true;

    interceptor.passthrough();

    expect(interceptor.shouldPassthrough).to.be.true;
    expect(interceptor.shouldIntercept).to.be.false;
  })",steel
/packages/@pollyjs/core/tests/unit/-private/interceptor-test.js,Duplicate Assert,"{'line': 54, 'column': 4, 'index': 1659}","it('.passthrough()', function () {
    const interceptor = new Interceptor();

    expect(interceptor.shouldPassthrough).to.be.false;
    expect(interceptor.shouldIntercept).to.be.true;

    interceptor.passthrough();

    expect(interceptor.shouldPassthrough).to.be.true;
    expect(interceptor.shouldIntercept).to.be.false;
  })",steel
/packages/@pollyjs/core/tests/unit/-private/interceptor-test.js,Duplicate Assert,"{'line': 60, 'column': 4, 'index': 1804}","it('.stopPropagation()', function () {
    const interceptor = new Interceptor();

    expect(interceptor.shouldStopPropagating).to.be.false;
    interceptor.stopPropagation();
    expect(interceptor.shouldStopPropagating).to.be.true;
  })",steel
/packages/@pollyjs/core/tests/unit/-private/interceptor-test.js,Duplicate Assert,"{'line': 62, 'column': 4, 'index': 1898}","it('.stopPropagation()', function () {
    const interceptor = new Interceptor();

    expect(interceptor.shouldStopPropagating).to.be.false;
    interceptor.stopPropagation();
    expect(interceptor.shouldStopPropagating).to.be.true;
  })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Conditional Test Logic,"{'line': 110, 'column': 22, 'index': 2979}","it('.send() - boolean, number, & object', function () {
      [true, 200, {}].forEach((body) => {
        base.type();
        base.send(body);

        expect(base.body).to.equal(stringify(body));
        expect(base.getHeader('Content-Type')).to.equal(
          'application/json; charset=utf-8'
        );
      });
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 24, 'column': 6, 'index': 552}","it('.getHeader()', function () {
      const { headers } = base;

      base.setHeader('One', '1');
      expect(headers).to.deep.equal({ one: '1' });

      expect(base.getHeader('One')).to.equal('1');
      expect(base.getHeader('one')).to.equal('1');
      expect(base.getHeader('Two')).to.be.undefined;

      base.removeHeader('One');
      expect(base.getHeader('One')).to.be.undefined;
      expect(base.getHeader('one')).to.be.undefined;
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 25, 'column': 6, 'index': 603}","it('.getHeader()', function () {
      const { headers } = base;

      base.setHeader('One', '1');
      expect(headers).to.deep.equal({ one: '1' });

      expect(base.getHeader('One')).to.equal('1');
      expect(base.getHeader('one')).to.equal('1');
      expect(base.getHeader('Two')).to.be.undefined;

      base.removeHeader('One');
      expect(base.getHeader('One')).to.be.undefined;
      expect(base.getHeader('one')).to.be.undefined;
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 29, 'column': 6, 'index': 740}","it('.getHeader()', function () {
      const { headers } = base;

      base.setHeader('One', '1');
      expect(headers).to.deep.equal({ one: '1' });

      expect(base.getHeader('One')).to.equal('1');
      expect(base.getHeader('one')).to.equal('1');
      expect(base.getHeader('Two')).to.be.undefined;

      base.removeHeader('One');
      expect(base.getHeader('One')).to.be.undefined;
      expect(base.getHeader('one')).to.be.undefined;
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 30, 'column': 6, 'index': 793}","it('.getHeader()', function () {
      const { headers } = base;

      base.setHeader('One', '1');
      expect(headers).to.deep.equal({ one: '1' });

      expect(base.getHeader('One')).to.equal('1');
      expect(base.getHeader('one')).to.equal('1');
      expect(base.getHeader('Two')).to.be.undefined;

      base.removeHeader('One');
      expect(base.getHeader('One')).to.be.undefined;
      expect(base.getHeader('one')).to.be.undefined;
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 39, 'column': 6, 'index': 1011}","it('.hasHeader()', function () {
      const { headers } = base;

      base.setHeader('One', '1');
      expect(headers).to.deep.equal({ one: '1' });

      expect(base.hasHeader('One')).to.be.true;
      expect(base.hasHeader('one')).to.be.true;
      expect(base.hasHeader('Two')).to.be.false;

      base.removeHeader('One');
      expect(base.hasHeader('One')).to.be.false;
      expect(base.hasHeader('one')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 40, 'column': 6, 'index': 1059}","it('.hasHeader()', function () {
      const { headers } = base;

      base.setHeader('One', '1');
      expect(headers).to.deep.equal({ one: '1' });

      expect(base.hasHeader('One')).to.be.true;
      expect(base.hasHeader('one')).to.be.true;
      expect(base.hasHeader('Two')).to.be.false;

      base.removeHeader('One');
      expect(base.hasHeader('One')).to.be.false;
      expect(base.hasHeader('one')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 44, 'column': 6, 'index': 1189}","it('.hasHeader()', function () {
      const { headers } = base;

      base.setHeader('One', '1');
      expect(headers).to.deep.equal({ one: '1' });

      expect(base.hasHeader('One')).to.be.true;
      expect(base.hasHeader('one')).to.be.true;
      expect(base.hasHeader('Two')).to.be.false;

      base.removeHeader('One');
      expect(base.hasHeader('One')).to.be.false;
      expect(base.hasHeader('one')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 45, 'column': 6, 'index': 1238}","it('.hasHeader()', function () {
      const { headers } = base;

      base.setHeader('One', '1');
      expect(headers).to.deep.equal({ one: '1' });

      expect(base.hasHeader('One')).to.be.true;
      expect(base.hasHeader('one')).to.be.true;
      expect(base.hasHeader('Two')).to.be.false;

      base.removeHeader('One');
      expect(base.hasHeader('One')).to.be.false;
      expect(base.hasHeader('one')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 52, 'column': 6, 'index': 1400}","it('.setHeader()', function () {
      const { headers } = base;

      base.setHeader('One', '1');
      expect(headers).to.deep.equal({ one: '1' });

      base.setHeader('two', '2');
      expect(headers).to.deep.equal({ one: '1', two: '2' });

      base.setHeader('Two', null);
      expect(headers).to.deep.equal({ one: '1' });
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 55, 'column': 6, 'index': 1486}","it('.setHeader()', function () {
      const { headers } = base;

      base.setHeader('One', '1');
      expect(headers).to.deep.equal({ one: '1' });

      base.setHeader('two', '2');
      expect(headers).to.deep.equal({ one: '1', two: '2' });

      base.setHeader('Two', null);
      expect(headers).to.deep.equal({ one: '1' });
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 58, 'column': 6, 'index': 1583}","it('.setHeader()', function () {
      const { headers } = base;

      base.setHeader('One', '1');
      expect(headers).to.deep.equal({ one: '1' });

      base.setHeader('two', '2');
      expect(headers).to.deep.equal({ one: '1', two: '2' });

      base.setHeader('Two', null);
      expect(headers).to.deep.equal({ one: '1' });
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 65, 'column': 6, 'index': 1761}","it('.setHeaders()', function () {
      const { headers } = base;

      base.setHeaders({ One: '1', two: '2' });
      expect(headers).to.deep.equal({ one: '1', two: '2' });

      base.setHeaders({ Three: '3' });
      expect(headers).to.deep.equal({ one: '1', two: '2', three: '3' });

      base.setHeaders({ Three: null });
      expect(headers).to.deep.equal({ one: '1', two: '2' });
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 68, 'column': 6, 'index': 1862}","it('.setHeaders()', function () {
      const { headers } = base;

      base.setHeaders({ One: '1', two: '2' });
      expect(headers).to.deep.equal({ one: '1', two: '2' });

      base.setHeaders({ Three: '3' });
      expect(headers).to.deep.equal({ one: '1', two: '2', three: '3' });

      base.setHeaders({ Three: null });
      expect(headers).to.deep.equal({ one: '1', two: '2' });
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 71, 'column': 6, 'index': 1976}","it('.setHeaders()', function () {
      const { headers } = base;

      base.setHeaders({ One: '1', two: '2' });
      expect(headers).to.deep.equal({ one: '1', two: '2' });

      base.setHeaders({ Three: '3' });
      expect(headers).to.deep.equal({ one: '1', two: '2', three: '3' });

      base.setHeaders({ Three: null });
      expect(headers).to.deep.equal({ one: '1', two: '2' });
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 80, 'column': 6, 'index': 2199}","it('.removeHeader()', function () {
      const { headers } = base;

      base.setHeaders({ One: '1', Two: '2' });

      base.removeHeader('One');
      expect(headers).to.deep.equal({ two: '2' });

      base.removeHeader('two');
      expect(headers).to.deep.equal({});
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 83, 'column': 6, 'index': 2283}","it('.removeHeader()', function () {
      const { headers } = base;

      base.setHeaders({ One: '1', Two: '2' });

      base.removeHeader('One');
      expect(headers).to.deep.equal({ two: '2' });

      base.removeHeader('two');
      expect(headers).to.deep.equal({});
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 124, 'column': 6, 'index': 3329}","it('.send() - null & undefined', function () {
      base.type();
      base.send(null);
      expect(base.body).to.equal('');
      expect(base.hasHeader('Content-Type')).to.be.false;

      base.type();
      base.send();
      expect(base.body).to.be.undefined;
      expect(base.hasHeader('Content-Type')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 125, 'column': 6, 'index': 3367}","it('.send() - null & undefined', function () {
      base.type();
      base.send(null);
      expect(base.body).to.equal('');
      expect(base.hasHeader('Content-Type')).to.be.false;

      base.type();
      base.send();
      expect(base.body).to.be.undefined;
      expect(base.hasHeader('Content-Type')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 129, 'column': 6, 'index': 3464}","it('.send() - null & undefined', function () {
      base.type();
      base.send(null);
      expect(base.body).to.equal('');
      expect(base.hasHeader('Content-Type')).to.be.false;

      base.type();
      base.send();
      expect(base.body).to.be.undefined;
      expect(base.hasHeader('Content-Type')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 130, 'column': 6, 'index': 3505}","it('.send() - null & undefined', function () {
      base.type();
      base.send(null);
      expect(base.body).to.equal('');
      expect(base.hasHeader('Content-Type')).to.be.false;

      base.type();
      base.send();
      expect(base.body).to.be.undefined;
      expect(base.hasHeader('Content-Type')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 178, 'column': 6, 'index': 4733}","it('.end()', function () {
      base.setHeader('foo', 'bar');

      expect(base.headers).to.deep.equal({ foo: 'bar' });

      base.end();
      expect(() => base.setHeader('bar', 'baz')).to.throw();
      expect(base.headers).to.deep.equal({ foo: 'bar' });
    })",steel
/packages/@pollyjs/core/tests/unit/-private/http-base-test.js,Duplicate Assert,"{'line': 182, 'column': 6, 'index': 4871}","it('.end()', function () {
      base.setHeader('foo', 'bar');

      expect(base.headers).to.deep.equal({ foo: 'bar' });

      base.end();
      expect(() => base.setHeader('bar', 'baz')).to.throw();
      expect(base.headers).to.deep.equal({ foo: 'bar' });
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-test.js,Duplicate Assert,"{'line': 40, 'column': 4, 'index': 1090}","it('.stopPropagation()', function () {
    const event = new Event(EVENT_TYPE);

    expect(event.shouldStopPropagating).to.be.false;
    event.stopPropagation();
    expect(event.shouldStopPropagating).to.be.true;
  })",steel
/packages/@pollyjs/core/tests/unit/-private/event-test.js,Duplicate Assert,"{'line': 42, 'column': 4, 'index': 1172}","it('.stopPropagation()', function () {
    const event = new Event(EVENT_TYPE);

    expect(event.shouldStopPropagating).to.be.false;
    event.stopPropagation();
    expect(event.shouldStopPropagating).to.be.true;
  })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 49, 'column': 6, 'index': 1247}","it('.eventNames()', function () {
      const listener = () => {};

      expect(emitter.eventNames()).to.have.lengthOf(0);

      emitter.on('a', listener);
      emitter.on('b', listener);
      expect(emitter.eventNames()).to.have.ordered.members(['a', 'b']);

      emitter.off('a', listener);
      expect(emitter.eventNames()).to.have.ordered.members(['b']);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 53, 'column': 6, 'index': 1370}","it('.eventNames()', function () {
      const listener = () => {};

      expect(emitter.eventNames()).to.have.lengthOf(0);

      emitter.on('a', listener);
      emitter.on('b', listener);
      expect(emitter.eventNames()).to.have.ordered.members(['a', 'b']);

      emitter.off('a', listener);
      expect(emitter.eventNames()).to.have.ordered.members(['b']);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 56, 'column': 6, 'index': 1477}","it('.eventNames()', function () {
      const listener = () => {};

      expect(emitter.eventNames()).to.have.lengthOf(0);

      emitter.on('a', listener);
      emitter.on('b', listener);
      expect(emitter.eventNames()).to.have.ordered.members(['a', 'b']);

      emitter.off('a', listener);
      expect(emitter.eventNames()).to.have.ordered.members(['b']);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 68, 'column': 6, 'index': 1791}","it('.on()', async function () {
      assertEventName('on');
      assertListener('on');

      let listenerCalled = 0;
      const listener = () => listenerCalled++;

      emitter.on('a', listener);
      emitter.on('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.on('a', () => {});
      expect(emitter.listeners('a')).to.have.lengthOf(2);

      await emitter.emit('a');
      expect(listenerCalled).to.equal(1);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 71, 'column': 6, 'index': 1883}","it('.on()', async function () {
      assertEventName('on');
      assertListener('on');

      let listenerCalled = 0;
      const listener = () => listenerCalled++;

      emitter.on('a', listener);
      emitter.on('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.on('a', () => {});
      expect(emitter.listeners('a')).to.have.lengthOf(2);

      await emitter.emit('a');
      expect(listenerCalled).to.equal(1);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 96, 'column': 6, 'index': 2590}","it('.on(listener, { times })', async function () {
      assertEventName('on');
      assertListener('on');

      let listenerCalled = 0;
      const listener = () => listenerCalled++;

      expect(() => emitter.on('a', listener, { times: '1' })).to.throw(
        PollyError,
        /Invalid number provided/
      );

      expect(() => emitter.on('a', listener, { times: -1 })).to.throw(
        PollyError,
        /The number must be greater than 0/
      );

      emitter.on('a', listener, { times: 1 });
      emitter.on('a', listener, { times: 2 });
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      await emitter.emit('a');
      await emitter.emit('a');
      await emitter.emit('a');

      expect(listenerCalled).to.equal(2);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 103, 'column': 6, 'index': 2785}","it('.on(listener, { times })', async function () {
      assertEventName('on');
      assertListener('on');

      let listenerCalled = 0;
      const listener = () => listenerCalled++;

      expect(() => emitter.on('a', listener, { times: '1' })).to.throw(
        PollyError,
        /Invalid number provided/
      );

      expect(() => emitter.on('a', listener, { times: -1 })).to.throw(
        PollyError,
        /The number must be greater than 0/
      );

      emitter.on('a', listener, { times: 1 });
      emitter.on('a', listener, { times: 2 });
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      await emitter.emit('a');
      await emitter.emit('a');
      await emitter.emit('a');

      expect(listenerCalled).to.equal(2);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 114, 'column': 6, 'index': 3065}","it('.once()', async function () {
      assertEventName('once');
      assertListener('once');

      let listenerCalled = 0;
      const listener = () => listenerCalled++;

      emitter.once('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      await emitter.emit('a');
      expect(listenerCalled).to.equal(1);
      expect(emitter.listeners('a')).to.have.lengthOf(0);

      await emitter.emit('a');
      expect(listenerCalled).to.equal(1);

      emitter.once('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 117, 'column': 6, 'index': 3155}","it('.once()', async function () {
      assertEventName('once');
      assertListener('once');

      let listenerCalled = 0;
      const listener = () => listenerCalled++;

      emitter.once('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      await emitter.emit('a');
      expect(listenerCalled).to.equal(1);
      expect(emitter.listeners('a')).to.have.lengthOf(0);

      await emitter.emit('a');
      expect(listenerCalled).to.equal(1);

      emitter.once('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 118, 'column': 6, 'index': 3197}","it('.once()', async function () {
      assertEventName('once');
      assertListener('once');

      let listenerCalled = 0;
      const listener = () => listenerCalled++;

      emitter.once('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      await emitter.emit('a');
      expect(listenerCalled).to.equal(1);
      expect(emitter.listeners('a')).to.have.lengthOf(0);

      await emitter.emit('a');
      expect(listenerCalled).to.equal(1);

      emitter.once('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 121, 'column': 6, 'index': 3287}","it('.once()', async function () {
      assertEventName('once');
      assertListener('once');

      let listenerCalled = 0;
      const listener = () => listenerCalled++;

      emitter.once('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      await emitter.emit('a');
      expect(listenerCalled).to.equal(1);
      expect(emitter.listeners('a')).to.have.lengthOf(0);

      await emitter.emit('a');
      expect(listenerCalled).to.equal(1);

      emitter.once('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 124, 'column': 6, 'index': 3365}","it('.once()', async function () {
      assertEventName('once');
      assertListener('once');

      let listenerCalled = 0;
      const listener = () => listenerCalled++;

      emitter.once('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      await emitter.emit('a');
      expect(listenerCalled).to.equal(1);
      expect(emitter.listeners('a')).to.have.lengthOf(0);

      await emitter.emit('a');
      expect(listenerCalled).to.equal(1);

      emitter.once('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 127, 'column': 6, 'index': 3458}","it('.once()', async function () {
      assertEventName('once');
      assertListener('once');

      let listenerCalled = 0;
      const listener = () => listenerCalled++;

      emitter.once('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      await emitter.emit('a');
      expect(listenerCalled).to.equal(1);
      expect(emitter.listeners('a')).to.have.lengthOf(0);

      await emitter.emit('a');
      expect(listenerCalled).to.equal(1);

      emitter.once('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 138, 'column': 6, 'index': 3726}","it('.off()', async function () {
      assertEventName('off');

      const listener = () => {};

      emitter.on('a', listener);
      emitter.on('a', () => {});
      emitter.on('a', () => {});
      expect(emitter.listeners('a')).to.have.lengthOf(3);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(2);

      emitter.off('a');
      expect(emitter.listeners('a')).to.have.lengthOf(0);

      emitter.on('a', listener, { times: 3 });
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 141, 'column': 6, 'index': 3819}","it('.off()', async function () {
      assertEventName('off');

      const listener = () => {};

      emitter.on('a', listener);
      emitter.on('a', () => {});
      emitter.on('a', () => {});
      expect(emitter.listeners('a')).to.have.lengthOf(3);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(2);

      emitter.off('a');
      expect(emitter.listeners('a')).to.have.lengthOf(0);

      emitter.on('a', listener, { times: 3 });
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 144, 'column': 6, 'index': 3902}","it('.off()', async function () {
      assertEventName('off');

      const listener = () => {};

      emitter.on('a', listener);
      emitter.on('a', () => {});
      emitter.on('a', () => {});
      expect(emitter.listeners('a')).to.have.lengthOf(3);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(2);

      emitter.off('a');
      expect(emitter.listeners('a')).to.have.lengthOf(0);

      emitter.on('a', listener, { times: 3 });
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 147, 'column': 6, 'index': 4008}","it('.off()', async function () {
      assertEventName('off');

      const listener = () => {};

      emitter.on('a', listener);
      emitter.on('a', () => {});
      emitter.on('a', () => {});
      expect(emitter.listeners('a')).to.have.lengthOf(3);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(2);

      emitter.off('a');
      expect(emitter.listeners('a')).to.have.lengthOf(0);

      emitter.on('a', listener, { times: 3 });
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 150, 'column': 6, 'index': 4101}","it('.off()', async function () {
      assertEventName('off');

      const listener = () => {};

      emitter.on('a', listener);
      emitter.on('a', () => {});
      emitter.on('a', () => {});
      expect(emitter.listeners('a')).to.have.lengthOf(3);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(2);

      emitter.off('a');
      expect(emitter.listeners('a')).to.have.lengthOf(0);

      emitter.on('a', listener, { times: 3 });
      expect(emitter.listeners('a')).to.have.lengthOf(1);

      emitter.off('a', listener);
      expect(emitter.listeners('a')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 156, 'column': 6, 'index': 4248}","it('.listeners()', async function () {
      assertEventName('listeners');

      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.deep.equal([]);

      emitter.on('a', () => {});
      emitter.on('b', () => {});
      emitter.on('b', () => {});
      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.have.lengthOf(1);
      expect(emitter.listeners('b')).to.have.lengthOf(2);

      emitter.off('b');
      expect(emitter.listeners('b')).to.be.an('array');
      expect(emitter.listeners('b')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 157, 'column': 6, 'index': 4304}","it('.listeners()', async function () {
      assertEventName('listeners');

      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.deep.equal([]);

      emitter.on('a', () => {});
      emitter.on('b', () => {});
      emitter.on('b', () => {});
      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.have.lengthOf(1);
      expect(emitter.listeners('b')).to.have.lengthOf(2);

      emitter.off('b');
      expect(emitter.listeners('b')).to.be.an('array');
      expect(emitter.listeners('b')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 162, 'column': 6, 'index': 4460}","it('.listeners()', async function () {
      assertEventName('listeners');

      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.deep.equal([]);

      emitter.on('a', () => {});
      emitter.on('b', () => {});
      emitter.on('b', () => {});
      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.have.lengthOf(1);
      expect(emitter.listeners('b')).to.have.lengthOf(2);

      emitter.off('b');
      expect(emitter.listeners('b')).to.be.an('array');
      expect(emitter.listeners('b')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 163, 'column': 6, 'index': 4516}","it('.listeners()', async function () {
      assertEventName('listeners');

      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.deep.equal([]);

      emitter.on('a', () => {});
      emitter.on('b', () => {});
      emitter.on('b', () => {});
      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.have.lengthOf(1);
      expect(emitter.listeners('b')).to.have.lengthOf(2);

      emitter.off('b');
      expect(emitter.listeners('b')).to.be.an('array');
      expect(emitter.listeners('b')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 164, 'column': 6, 'index': 4574}","it('.listeners()', async function () {
      assertEventName('listeners');

      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.deep.equal([]);

      emitter.on('a', () => {});
      emitter.on('b', () => {});
      emitter.on('b', () => {});
      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.have.lengthOf(1);
      expect(emitter.listeners('b')).to.have.lengthOf(2);

      emitter.off('b');
      expect(emitter.listeners('b')).to.be.an('array');
      expect(emitter.listeners('b')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 167, 'column': 6, 'index': 4657}","it('.listeners()', async function () {
      assertEventName('listeners');

      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.deep.equal([]);

      emitter.on('a', () => {});
      emitter.on('b', () => {});
      emitter.on('b', () => {});
      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.have.lengthOf(1);
      expect(emitter.listeners('b')).to.have.lengthOf(2);

      emitter.off('b');
      expect(emitter.listeners('b')).to.be.an('array');
      expect(emitter.listeners('b')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 168, 'column': 6, 'index': 4713}","it('.listeners()', async function () {
      assertEventName('listeners');

      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.deep.equal([]);

      emitter.on('a', () => {});
      emitter.on('b', () => {});
      emitter.on('b', () => {});
      expect(emitter.listeners('a')).to.be.an('array');
      expect(emitter.listeners('a')).to.have.lengthOf(1);
      expect(emitter.listeners('b')).to.have.lengthOf(2);

      emitter.off('b');
      expect(emitter.listeners('b')).to.be.an('array');
      expect(emitter.listeners('b')).to.have.lengthOf(0);
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 174, 'column': 6, 'index': 4866}","it('.hasListeners()', async function () {
      assertEventName('hasListeners');

      expect(emitter.hasListeners('a')).to.be.false;

      emitter.on('a', () => {});
      expect(emitter.hasListeners('a')).to.be.true;

      emitter.off('a');
      expect(emitter.hasListeners('a')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 177, 'column': 6, 'index': 4953}","it('.hasListeners()', async function () {
      assertEventName('hasListeners');

      expect(emitter.hasListeners('a')).to.be.false;

      emitter.on('a', () => {});
      expect(emitter.hasListeners('a')).to.be.true;

      emitter.off('a');
      expect(emitter.hasListeners('a')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/-private/event-emitter-test.js,Duplicate Assert,"{'line': 180, 'column': 6, 'index': 5030}","it('.hasListeners()', async function () {
      assertEventName('hasListeners');

      expect(emitter.hasListeners('a')).to.be.false;

      emitter.on('a', () => {});
      expect(emitter.hasListeners('a')).to.be.true;

      emitter.off('a');
      expect(emitter.hasListeners('a')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/-private/container-test.js,Duplicate Assert,"{'line': 62, 'column': 6, 'index': 1400}","it('.unregister() - by key', function () {
      container.register(Factory);
      expect(container.has('factory:factory-id')).to.be.true;

      container.unregister('factory:factory-id');
      expect(container.has('factory:factory-id')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/-private/container-test.js,Duplicate Assert,"{'line': 65, 'column': 6, 'index': 1513}","it('.unregister() - by key', function () {
      container.register(Factory);
      expect(container.has('factory:factory-id')).to.be.true;

      container.unregister('factory:factory-id');
      expect(container.has('factory:factory-id')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/-private/container-test.js,Duplicate Assert,"{'line': 70, 'column': 6, 'index': 1671}","it('.unregister() - by factory', function () {
      container.register(Factory);
      expect(container.has('factory:factory-id')).to.be.true;

      container.unregister(Factory);
      expect(container.has('factory:factory-id')).to.be.false;
    })",steel
/packages/@pollyjs/core/tests/unit/-private/container-test.js,Duplicate Assert,"{'line': 73, 'column': 6, 'index': 1771}","it('.unregister() - by factory', function () {
      container.register(Factory);
      expect(container.has('factory:factory-id')).to.be.true;

      container.unregister(Factory);
      expect(container.has('factory:factory-id')).to.be.false;
    })",steel
/packages/@pollyjs/adapter-xhr/tests/integration/adapter-test.js,Conditional Test Logic,"{'line': 68, 'column': 34, 'index': 1933}","describe('Integration | XHR Adapter', function () {
  setupPolly.beforeEach({
    recordFailedRequests: true,
    adapters: [XHRAdapter],
    persister: InMemoryPersister
  });

  setupFetchRecord({ fetch: xhrRequest });
  setupPolly.afterEach();

  adapterTests();
  adapterBrowserTests();
  adapterIdentifierTests();

  it('should handle aborting a request', async function () {
    const { server } = this.polly;
    const xhr = new XMLHttpRequest();
    let abortEventCalled;

    server
      .any(this.recordUrl())
      .on('request', () => xhr.abort())
      .on('abort', () => (abortEventCalled = true))
      .intercept((_, res) => {
        res.sendStatus(200);
      });

    await this.fetchRecord({ xhr });
    await this.polly.flush();

    expect(abortEventCalled).to.equal(true);
  });

  it('should handle immediately aborting a request', async function () {
    const { server } = this.polly;
    const xhr = new XMLHttpRequest();
    let abortEventCalled;

    server
      .any(this.recordUrl())
      .on('abort', () => (abortEventCalled = true))
      .intercept((_, res) => {
        res.sendStatus(200);
      });

    const promise = this.fetchRecord({ xhr });

    xhr.abort();
    await promise;
    await this.polly.flush();

    expect(abortEventCalled).to.equal(true);
  });

  ['arraybuffer', 'blob', 'text'].forEach((responseType) =>
    it(`should be able to download binary content (${responseType})`, async function () {
      const fetch = async () =>
        Buffer.from(
          await this.fetch('/assets/32x32.png', {
            responseType
          }).then((res) => res.arrayBuffer())
        );

      this.polly.disconnectFrom(XHRAdapter);

      const nativeResponseBuffer = await fetch();

      this.polly.connectTo(XHRAdapter);

      const recordedResponseBuffer = await fetch();

      const { recordingName, config } = this.polly;

      await this.polly.stop();
      this.polly = new Polly(recordingName, config);
      this.polly.replay();

      const replayedResponseBuffer = await fetch();

      expect(nativeResponseBuffer.equals(recordedResponseBuffer)).to.equal(
        true
      );
      expect(recordedResponseBuffer.equals(replayedResponseBuffer)).to.equal(
        true
      );
      expect(nativeResponseBuffer.equals(replayedResponseBuffer)).to.equal(
        true
      );
    })
  );
})",steel
/packages/@pollyjs/adapter-puppeteer/tests/integration/adapter-test.js,Conditional Test Logic,"{'line': 99, 'column': 4, 'index': 2704}","it('should have resolved requests after flushing', async function () {
    // Timeout after 500ms since we could have a hanging while loop
    this.timeout(500);

    const { server } = this.polly;
    const requests = [];
    const resolved = [];
    let i = 1;

    server
      .get(this.recordUrl())
      .intercept(async (req, res) => {
        await server.timeout(5);
        res.sendStatus(200);
      })
      .on('request', (req) => requests.push(req));

    this.page.on('requestfinished', () => resolved.push(i++));

    this.fetchRecord();
    this.fetchRecord();
    this.fetchRecord();

    // Since it takes time for Puppeteer to execute the request in the browser's
    // context, we have to wait until the requests have been made.
    while (requests.length !== 3) {
      await server.timeout(5);
    }

    await this.polly.flush();

    expect(requests).to.have.lengthOf(3);
    requests.forEach((request) => expect(request.didRespond).to.be.true);
    expect(resolved).to.have.members([1, 2, 3]);
  })",steel
/packages/@pollyjs/adapter-node-http/tests/unit/utils/merge-chunks-test.js,Conditional Test Logic,"{'line': 9, 'column': 15, 'index': 249}","it('should work', function () {
    [null, []].forEach((chunks) => {
      const buffer = mergeChunks(chunks);

      expect(Buffer.isBuffer(buffer)).to.be.true;
      expect(buffer.toString()).to.have.lengthOf(0);
    });

    const str = mergeChunks(['T', 'e', 's', 't']);

    expect(Buffer.isBuffer(str)).to.be.false;
    expect(str).to.equal('Test');

    const buffer = mergeChunks(['T', 'e', 's', 't'].map((c) => Buffer.from(c)));

    expect(Buffer.isBuffer(buffer)).to.be.true;
    expect(buffer.toString()).to.equal('Test');
  })",steel
/packages/@pollyjs/adapter-node-http/tests/unit/utils/merge-chunks-test.js,Duplicate Assert,"{'line': 12, 'column': 6, 'index': 320}","it('should work', function () {
    [null, []].forEach((chunks) => {
      const buffer = mergeChunks(chunks);

      expect(Buffer.isBuffer(buffer)).to.be.true;
      expect(buffer.toString()).to.have.lengthOf(0);
    });

    const str = mergeChunks(['T', 'e', 's', 't']);

    expect(Buffer.isBuffer(str)).to.be.false;
    expect(str).to.equal('Test');

    const buffer = mergeChunks(['T', 'e', 's', 't'].map((c) => Buffer.from(c)));

    expect(Buffer.isBuffer(buffer)).to.be.true;
    expect(buffer.toString()).to.equal('Test');
  })",steel
/packages/@pollyjs/adapter-node-http/tests/unit/utils/merge-chunks-test.js,Duplicate Assert,"{'line': 13, 'column': 6, 'index': 370}","it('should work', function () {
    [null, []].forEach((chunks) => {
      const buffer = mergeChunks(chunks);

      expect(Buffer.isBuffer(buffer)).to.be.true;
      expect(buffer.toString()).to.have.lengthOf(0);
    });

    const str = mergeChunks(['T', 'e', 's', 't']);

    expect(Buffer.isBuffer(str)).to.be.false;
    expect(str).to.equal('Test');

    const buffer = mergeChunks(['T', 'e', 's', 't'].map((c) => Buffer.from(c)));

    expect(Buffer.isBuffer(buffer)).to.be.true;
    expect(buffer.toString()).to.equal('Test');
  })",steel
/packages/@pollyjs/adapter-node-http/tests/unit/utils/merge-chunks-test.js,Duplicate Assert,"{'line': 23, 'column': 4, 'index': 645}","it('should work', function () {
    [null, []].forEach((chunks) => {
      const buffer = mergeChunks(chunks);

      expect(Buffer.isBuffer(buffer)).to.be.true;
      expect(buffer.toString()).to.have.lengthOf(0);
    });

    const str = mergeChunks(['T', 'e', 's', 't']);

    expect(Buffer.isBuffer(str)).to.be.false;
    expect(str).to.equal('Test');

    const buffer = mergeChunks(['T', 'e', 's', 't'].map((c) => Buffer.from(c)));

    expect(Buffer.isBuffer(buffer)).to.be.true;
    expect(buffer.toString()).to.equal('Test');
  })",steel
/packages/@pollyjs/adapter-node-http/tests/unit/utils/merge-chunks-test.js,Duplicate Assert,"{'line': 24, 'column': 4, 'index': 693}","it('should work', function () {
    [null, []].forEach((chunks) => {
      const buffer = mergeChunks(chunks);

      expect(Buffer.isBuffer(buffer)).to.be.true;
      expect(buffer.toString()).to.have.lengthOf(0);
    });

    const str = mergeChunks(['T', 'e', 's', 't']);

    expect(Buffer.isBuffer(str)).to.be.false;
    expect(str).to.equal('Test');

    const buffer = mergeChunks(['T', 'e', 's', 't'].map((c) => Buffer.from(c)));

    expect(Buffer.isBuffer(buffer)).to.be.true;
    expect(buffer.toString()).to.equal('Test');
  })",steel
/packages/@pollyjs/adapter-node-http/tests/jest/integration/xhr-test.js,Magic Number,"{'line': 33, 'column': 55, 'index': 755}","test('it works', async () => {
    polly.recordingName += '/it works';

    const { persister, recordingId } = polly;

    expect((await request('/api/db/foo')).status).toBe(404);
    await persister.persist();

    const har = await persister.findRecording(recordingId);

    expect(har).toBeDefined();
    expect(har.log.entries.length).toBe(1);
    expect(har.log.entries[0].request.url.includes('/api/db/foo')).toBe(true);
    expect(har.log.entries[0].response.status).toBe(404);

    await persister.deleteRecording(recordingId);
    expect(persister.findRecording(recordingId)).resolves.toBeNull();
  })",steel
/packages/@pollyjs/adapter-node-http/tests/jest/integration/xhr-test.js,Magic Number,"{'line': 39, 'column': 40, 'index': 925}","test('it works', async () => {
    polly.recordingName += '/it works';

    const { persister, recordingId } = polly;

    expect((await request('/api/db/foo')).status).toBe(404);
    await persister.persist();

    const har = await persister.findRecording(recordingId);

    expect(har).toBeDefined();
    expect(har.log.entries.length).toBe(1);
    expect(har.log.entries[0].request.url.includes('/api/db/foo')).toBe(true);
    expect(har.log.entries[0].response.status).toBe(404);

    await persister.deleteRecording(recordingId);
    expect(persister.findRecording(recordingId)).resolves.toBeNull();
  })",steel
/packages/@pollyjs/adapter-node-http/tests/jest/integration/xhr-test.js,Magic Number,"{'line': 41, 'column': 52, 'index': 1060}","test('it works', async () => {
    polly.recordingName += '/it works';

    const { persister, recordingId } = polly;

    expect((await request('/api/db/foo')).status).toBe(404);
    await persister.persist();

    const har = await persister.findRecording(recordingId);

    expect(har).toBeDefined();
    expect(har.log.entries.length).toBe(1);
    expect(har.log.entries[0].request.url.includes('/api/db/foo')).toBe(true);
    expect(har.log.entries[0].response.status).toBe(404);

    await persister.deleteRecording(recordingId);
    expect(persister.findRecording(recordingId)).resolves.toBeNull();
  })",steel
/packages/@pollyjs/adapter-node-http/tests/jest/integration/fetch-test.js,Magic Number,"{'line': 21, 'column': 74, 'index': 547}","test('it works', async () => {
    polly.recordingName += '/it works';

    const { persister, recordingId } = polly;

    expect((await fetch('http://localhost:4000/api/db/foo')).status).toBe(404);
    await persister.persist();

    const har = await persister.findRecording(recordingId);

    expect(har).toBeDefined();
    expect(har.log.entries.length).toBe(1);
    expect(har.log.entries[0].request.url.includes('/api/db/foo')).toBe(true);
    expect(har.log.entries[0].response.status).toBe(404);

    await persister.deleteRecording(recordingId);
    expect(persister.findRecording(recordingId)).resolves.toBeNull();
  })",steel
/packages/@pollyjs/adapter-node-http/tests/jest/integration/fetch-test.js,Magic Number,"{'line': 27, 'column': 40, 'index': 717}","test('it works', async () => {
    polly.recordingName += '/it works';

    const { persister, recordingId } = polly;

    expect((await fetch('http://localhost:4000/api/db/foo')).status).toBe(404);
    await persister.persist();

    const har = await persister.findRecording(recordingId);

    expect(har).toBeDefined();
    expect(har.log.entries.length).toBe(1);
    expect(har.log.entries[0].request.url.includes('/api/db/foo')).toBe(true);
    expect(har.log.entries[0].response.status).toBe(404);

    await persister.deleteRecording(recordingId);
    expect(persister.findRecording(recordingId)).resolves.toBeNull();
  })",steel
/packages/@pollyjs/adapter-node-http/tests/jest/integration/fetch-test.js,Magic Number,"{'line': 29, 'column': 52, 'index': 852}","test('it works', async () => {
    polly.recordingName += '/it works';

    const { persister, recordingId } = polly;

    expect((await fetch('http://localhost:4000/api/db/foo')).status).toBe(404);
    await persister.persist();

    const har = await persister.findRecording(recordingId);

    expect(har).toBeDefined();
    expect(har.log.entries.length).toBe(1);
    expect(har.log.entries[0].request.url.includes('/api/db/foo')).toBe(true);
    expect(har.log.entries[0].response.status).toBe(404);

    await persister.deleteRecording(recordingId);
    expect(persister.findRecording(recordingId)).resolves.toBeNull();
  })",steel
/packages/@pollyjs/adapter-node-http/tests/integration/adapter-test.js,Exception Handling,"{'line': 180, 'column': 4, 'index': 5068}","it('should handle aborting a request', async function () {
    const { server } = this.polly;
    const url = `${protocol}//example.com`;
    const req = transport.request(url);
    let abortEventCalled = false;

    server
      .any(url)
      .on('abort', () => (abortEventCalled = true))
      .intercept(async (_, res) => {
        await server.timeout(50);
        res.sendStatus(200);
      });

    req.on('socket', () => {
      setTimeout(() => {
        req.abort();
      }, 10);
    });

    try {
      await getResponseFromRequest(req);
    } catch (e) {
      // no-op
    }

    await this.polly.flush();
    expect(abortEventCalled).to.equal(true);
  })",steel
/packages/@pollyjs/adapter-node-http/tests/integration/adapter-test.js,Exception Handling,"{'line': 209, 'column': 4, 'index': 5763}","it('should handle immediately aborting a request', async function () {
    const { server } = this.polly;
    const url = `${protocol}//example.com`;
    const req = transport.request(url);
    let requestIntercepted = false;
    let abortEventCalled = false;

    server
      .any(url)
      .on('abort', () => (abortEventCalled = true))
      .intercept(async (_, res) => {
        requestIntercepted = true;
        res.sendStatus(200);
      });

    const promise = getResponseFromRequest(req);

    req.abort();

    try {
      await promise;
    } catch (e) {
      // no-op
    }

    await this.polly.flush();

    // Nock will completely ignore requests that have been immediately aborted
    expect(requestIntercepted).to.equal(false);
    expect(abortEventCalled).to.equal(false);
  })",steel
/packages/@pollyjs/adapter-node-http/tests/integration/adapter-test.js,Sleepy Test,"{'line': 175, 'column': 6, 'index': 5001}","it('should handle aborting a request', async function () {
    const { server } = this.polly;
    const url = `${protocol}//example.com`;
    const req = transport.request(url);
    let abortEventCalled = false;

    server
      .any(url)
      .on('abort', () => (abortEventCalled = true))
      .intercept(async (_, res) => {
        await server.timeout(50);
        res.sendStatus(200);
      });

    req.on('socket', () => {
      setTimeout(() => {
        req.abort();
      }, 10);
    });

    try {
      await getResponseFromRequest(req);
    } catch (e) {
      // no-op
    }

    await this.polly.flush();
    expect(abortEventCalled).to.equal(true);
  })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Conditional Test Logic,"{'line': 82, 'column': 8, 'index': 2381}","it('.configure() - should throw when trying to override certain options', async function () {
      const { server } = this.polly;

      // The following options cannot be overridden on a per request basis
      [
        'mode',
        'adapters',
        'adapterOptions',
        'persister',
        'persisterOptions'
      ].forEach((key) =>
        expect(() => server.any().configure({ [key]: 'foo' })).to.throw(
          PollyError,
          /Invalid configuration option/
        )
      );
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 217, 'column': 6, 'index': 6144}","it('.times()', async function () {
      const { server } = this.polly;
      let callCount = 0;

      server
        .get('/ping')
        .times(1)
        .on('request', () => callCount++)
        .times()
        .intercept((req, res) => res.sendStatus(200));

      expect((await fetch('/ping')).status).to.equal(200);
      expect(callCount).to.equal(1);

      expect((await fetch('/ping')).status).to.equal(200);
      expect(callCount).to.equal(1);
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 218, 'column': 6, 'index': 6203}","it('.times()', async function () {
      const { server } = this.polly;
      let callCount = 0;

      server
        .get('/ping')
        .times(1)
        .on('request', () => callCount++)
        .times()
        .intercept((req, res) => res.sendStatus(200));

      expect((await fetch('/ping')).status).to.equal(200);
      expect(callCount).to.equal(1);

      expect((await fetch('/ping')).status).to.equal(200);
      expect(callCount).to.equal(1);
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 220, 'column': 6, 'index': 6241}","it('.times()', async function () {
      const { server } = this.polly;
      let callCount = 0;

      server
        .get('/ping')
        .times(1)
        .on('request', () => callCount++)
        .times()
        .intercept((req, res) => res.sendStatus(200));

      expect((await fetch('/ping')).status).to.equal(200);
      expect(callCount).to.equal(1);

      expect((await fetch('/ping')).status).to.equal(200);
      expect(callCount).to.equal(1);
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 221, 'column': 6, 'index': 6300}","it('.times()', async function () {
      const { server } = this.polly;
      let callCount = 0;

      server
        .get('/ping')
        .times(1)
        .on('request', () => callCount++)
        .times()
        .intercept((req, res) => res.sendStatus(200));

      expect((await fetch('/ping')).status).to.equal(200);
      expect(callCount).to.equal(1);

      expect((await fetch('/ping')).status).to.equal(200);
      expect(callCount).to.equal(1);
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 233, 'column': 6, 'index': 6661}","it('.intercept(_, { times }) & .on(_, { times })', async function () {
      const { server } = this.polly;
      let callCount = 0;

      const handler = server
        .get('/ping')
        .on('request', () => callCount++, { times: 1 })
        .intercept((req, res) => res.sendStatus(200), { times: 2 });

      expect((await fetch('/ping')).status).to.equal(200);
      expect(callCount).to.equal(1);

      expect((await fetch('/ping')).status).to.equal(200);
      expect(callCount).to.equal(1);

      expect(handler.has('intercept')).to.be.false;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 234, 'column': 6, 'index': 6720}","it('.intercept(_, { times }) & .on(_, { times })', async function () {
      const { server } = this.polly;
      let callCount = 0;

      const handler = server
        .get('/ping')
        .on('request', () => callCount++, { times: 1 })
        .intercept((req, res) => res.sendStatus(200), { times: 2 });

      expect((await fetch('/ping')).status).to.equal(200);
      expect(callCount).to.equal(1);

      expect((await fetch('/ping')).status).to.equal(200);
      expect(callCount).to.equal(1);

      expect(handler.has('intercept')).to.be.false;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 236, 'column': 6, 'index': 6758}","it('.intercept(_, { times }) & .on(_, { times })', async function () {
      const { server } = this.polly;
      let callCount = 0;

      const handler = server
        .get('/ping')
        .on('request', () => callCount++, { times: 1 })
        .intercept((req, res) => res.sendStatus(200), { times: 2 });

      expect((await fetch('/ping')).status).to.equal(200);
      expect(callCount).to.equal(1);

      expect((await fetch('/ping')).status).to.equal(200);
      expect(callCount).to.equal(1);

      expect(handler.has('intercept')).to.be.false;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 237, 'column': 6, 'index': 6817}","it('.intercept(_, { times }) & .on(_, { times })', async function () {
      const { server } = this.polly;
      let callCount = 0;

      const handler = server
        .get('/ping')
        .on('request', () => callCount++, { times: 1 })
        .intercept((req, res) => res.sendStatus(200), { times: 2 });

      expect((await fetch('/ping')).status).to.equal(200);
      expect(callCount).to.equal(1);

      expect((await fetch('/ping')).status).to.equal(200);
      expect(callCount).to.equal(1);

      expect(handler.has('intercept')).to.be.false;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 251, 'column': 10, 'index': 7160}","it('event: request', async function () {
      const { server } = this.polly;
      let requestCalled = false;

      server
        .get('/ping')
        .intercept((req, res) => {
          expect(requestCalled).to.be.true;
          res.sendStatus(200);
        })
        .on('request', (req) => {
          expect(requestCalled).to.be.false;

          // Validate that we can modify the request
          req.body = 'test';
          expect(req.body).to.equal('test');

          requestCalled = true;
        });

      expect((await fetch('/ping')).status).to.equal(200);
      expect(requestCalled).to.be.true;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 255, 'column': 10, 'index': 7280}","it('event: request', async function () {
      const { server } = this.polly;
      let requestCalled = false;

      server
        .get('/ping')
        .intercept((req, res) => {
          expect(requestCalled).to.be.true;
          res.sendStatus(200);
        })
        .on('request', (req) => {
          expect(requestCalled).to.be.false;

          // Validate that we can modify the request
          req.body = 'test';
          expect(req.body).to.equal('test');

          requestCalled = true;
        });

      expect((await fetch('/ping')).status).to.equal(200);
      expect(requestCalled).to.be.true;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 265, 'column': 6, 'index': 7554}","it('event: request', async function () {
      const { server } = this.polly;
      let requestCalled = false;

      server
        .get('/ping')
        .intercept((req, res) => {
          expect(requestCalled).to.be.true;
          res.sendStatus(200);
        })
        .on('request', (req) => {
          expect(requestCalled).to.be.false;

          // Validate that we can modify the request
          req.body = 'test';
          expect(req.body).to.equal('test');

          requestCalled = true;
        });

      expect((await fetch('/ping')).status).to.equal(200);
      expect(requestCalled).to.be.true;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 275, 'column': 10, 'index': 7807}","it('event: beforeResponse', async function () {
      const { server } = this.polly;
      let beforeResponseCalled = false;

      server
        .get('/ping')
        .intercept((req, res) => {
          expect(beforeResponseCalled).to.be.false;
          res.sendStatus(200);
        })
        .on('beforeResponse', (req, res) => {
          expect(beforeResponseCalled).to.be.false;
          expect(res.statusCode).to.equal(200);

          res.sendStatus(201);
          beforeResponseCalled = true;
        });

      expect((await fetch('/ping')).status).to.equal(201);
      expect(beforeResponseCalled).to.be.true;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 279, 'column': 10, 'index': 7947}","it('event: beforeResponse', async function () {
      const { server } = this.polly;
      let beforeResponseCalled = false;

      server
        .get('/ping')
        .intercept((req, res) => {
          expect(beforeResponseCalled).to.be.false;
          res.sendStatus(200);
        })
        .on('beforeResponse', (req, res) => {
          expect(beforeResponseCalled).to.be.false;
          expect(res.statusCode).to.equal(200);

          res.sendStatus(201);
          beforeResponseCalled = true;
        });

      expect((await fetch('/ping')).status).to.equal(201);
      expect(beforeResponseCalled).to.be.true;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 287, 'column': 6, 'index': 8186}","it('event: beforeResponse', async function () {
      const { server } = this.polly;
      let beforeResponseCalled = false;

      server
        .get('/ping')
        .intercept((req, res) => {
          expect(beforeResponseCalled).to.be.false;
          res.sendStatus(200);
        })
        .on('beforeResponse', (req, res) => {
          expect(beforeResponseCalled).to.be.false;
          expect(res.statusCode).to.equal(200);

          res.sendStatus(201);
          beforeResponseCalled = true;
        });

      expect((await fetch('/ping')).status).to.equal(201);
      expect(beforeResponseCalled).to.be.true;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 297, 'column': 10, 'index': 8434}","it('event: response', async function () {
      const { server } = this.polly;
      let responseCalled = false;

      server
        .get('/ping')
        .intercept((req, res) => {
          expect(responseCalled).to.be.false;
          res.sendStatus(200);
        })
        .on('response', (req, res) => {
          expect(responseCalled).to.be.false;
          expect(req.didRespond).to.be.true;
          expect(res.statusCode).to.equal(200);

          // Validate that the req cant be modified
          expect(() => (req.body = 'test')).to.throw(Error);

          responseCalled = true;
        });

      expect((await fetch('/ping')).status).to.equal(200);
      expect(responseCalled).to.be.true;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 301, 'column': 10, 'index': 8562}","it('event: response', async function () {
      const { server } = this.polly;
      let responseCalled = false;

      server
        .get('/ping')
        .intercept((req, res) => {
          expect(responseCalled).to.be.false;
          res.sendStatus(200);
        })
        .on('response', (req, res) => {
          expect(responseCalled).to.be.false;
          expect(req.didRespond).to.be.true;
          expect(res.statusCode).to.equal(200);

          // Validate that the req cant be modified
          expect(() => (req.body = 'test')).to.throw(Error);

          responseCalled = true;
        });

      expect((await fetch('/ping')).status).to.equal(200);
      expect(responseCalled).to.be.true;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 312, 'column': 6, 'index': 8917}","it('event: response', async function () {
      const { server } = this.polly;
      let responseCalled = false;

      server
        .get('/ping')
        .intercept((req, res) => {
          expect(responseCalled).to.be.false;
          res.sendStatus(200);
        })
        .on('response', (req, res) => {
          expect(responseCalled).to.be.false;
          expect(req.didRespond).to.be.true;
          expect(res.statusCode).to.equal(200);

          // Validate that the req cant be modified
          expect(() => (req.body = 'test')).to.throw(Error);

          responseCalled = true;
        });

      expect((await fetch('/ping')).status).to.equal(200);
      expect(responseCalled).to.be.true;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 344, 'column': 6, 'index': 9968}","it('can turn off events', async function () {
      const { server } = this.polly;
      let requestCalled,
        beforeResponseCalled = false;

      const handler = server
        .get('/ping')
        .intercept((req, res) => res.sendStatus(200))
        .on('request', () => (requestCalled = true))
        .on('beforeResponse', () => (beforeResponseCalled = true));

      expect((await fetch('/ping')).status).to.equal(200);
      expect(requestCalled).to.be.true;
      expect(beforeResponseCalled).to.be.true;

      requestCalled = beforeResponseCalled = false;
      handler.off('request').off('beforeResponse');

      expect((await fetch('/ping')).status).to.equal(200);
      expect(requestCalled).to.be.false;
      expect(beforeResponseCalled).to.be.false;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 345, 'column': 6, 'index': 10027}","it('can turn off events', async function () {
      const { server } = this.polly;
      let requestCalled,
        beforeResponseCalled = false;

      const handler = server
        .get('/ping')
        .intercept((req, res) => res.sendStatus(200))
        .on('request', () => (requestCalled = true))
        .on('beforeResponse', () => (beforeResponseCalled = true));

      expect((await fetch('/ping')).status).to.equal(200);
      expect(requestCalled).to.be.true;
      expect(beforeResponseCalled).to.be.true;

      requestCalled = beforeResponseCalled = false;
      handler.off('request').off('beforeResponse');

      expect((await fetch('/ping')).status).to.equal(200);
      expect(requestCalled).to.be.false;
      expect(beforeResponseCalled).to.be.false;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 346, 'column': 6, 'index': 10067}","it('can turn off events', async function () {
      const { server } = this.polly;
      let requestCalled,
        beforeResponseCalled = false;

      const handler = server
        .get('/ping')
        .intercept((req, res) => res.sendStatus(200))
        .on('request', () => (requestCalled = true))
        .on('beforeResponse', () => (beforeResponseCalled = true));

      expect((await fetch('/ping')).status).to.equal(200);
      expect(requestCalled).to.be.true;
      expect(beforeResponseCalled).to.be.true;

      requestCalled = beforeResponseCalled = false;
      handler.off('request').off('beforeResponse');

      expect((await fetch('/ping')).status).to.equal(200);
      expect(requestCalled).to.be.false;
      expect(beforeResponseCalled).to.be.false;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 351, 'column': 6, 'index': 10220}","it('can turn off events', async function () {
      const { server } = this.polly;
      let requestCalled,
        beforeResponseCalled = false;

      const handler = server
        .get('/ping')
        .intercept((req, res) => res.sendStatus(200))
        .on('request', () => (requestCalled = true))
        .on('beforeResponse', () => (beforeResponseCalled = true));

      expect((await fetch('/ping')).status).to.equal(200);
      expect(requestCalled).to.be.true;
      expect(beforeResponseCalled).to.be.true;

      requestCalled = beforeResponseCalled = false;
      handler.off('request').off('beforeResponse');

      expect((await fetch('/ping')).status).to.equal(200);
      expect(requestCalled).to.be.false;
      expect(beforeResponseCalled).to.be.false;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 352, 'column': 6, 'index': 10279}","it('can turn off events', async function () {
      const { server } = this.polly;
      let requestCalled,
        beforeResponseCalled = false;

      const handler = server
        .get('/ping')
        .intercept((req, res) => res.sendStatus(200))
        .on('request', () => (requestCalled = true))
        .on('beforeResponse', () => (beforeResponseCalled = true));

      expect((await fetch('/ping')).status).to.equal(200);
      expect(requestCalled).to.be.true;
      expect(beforeResponseCalled).to.be.true;

      requestCalled = beforeResponseCalled = false;
      handler.off('request').off('beforeResponse');

      expect((await fetch('/ping')).status).to.equal(200);
      expect(requestCalled).to.be.false;
      expect(beforeResponseCalled).to.be.false;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 353, 'column': 6, 'index': 10320}","it('can turn off events', async function () {
      const { server } = this.polly;
      let requestCalled,
        beforeResponseCalled = false;

      const handler = server
        .get('/ping')
        .intercept((req, res) => res.sendStatus(200))
        .on('request', () => (requestCalled = true))
        .on('beforeResponse', () => (beforeResponseCalled = true));

      expect((await fetch('/ping')).status).to.equal(200);
      expect(requestCalled).to.be.true;
      expect(beforeResponseCalled).to.be.true;

      requestCalled = beforeResponseCalled = false;
      handler.off('request').off('beforeResponse');

      expect((await fetch('/ping')).status).to.equal(200);
      expect(requestCalled).to.be.false;
      expect(beforeResponseCalled).to.be.false;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 362, 'column': 10, 'index': 10540}","it('events receive params', async function () {
      const { server } = this.polly;

      server
        .any('/ping')
        .on('request', (req) => {
          expect(req.params).to.deep.equal({});
        })
        .on('beforeResponse', (req) => {
          expect(req.params).to.deep.equal({});
        });

      server
        .any('/ping/:id')
        .on('request', (req) => {
          expect(req.params).to.deep.equal({ id: '1' });
        })
        .on('beforeResponse', (req) => {
          expect(req.params).to.deep.equal({ id: '1' });
        });

      server
        .get('/ping/:id/:id2/*path')
        .intercept((req, res) => res.sendStatus(200))
        .on('request', (req) => {
          expect(req.params).to.deep.equal({
            id: '1',
            id2: '2',
            path: 'foo/bar'
          });
        })
        .on('beforeResponse', (req) => {
          expect(req.params).to.deep.equal({
            id: '1',
            id2: '2',
            path: 'foo/bar'
          });
        });

      expect((await fetch('/ping/1/2/foo/bar')).status).to.equal(200);
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 365, 'column': 10, 'index': 10640}","it('events receive params', async function () {
      const { server } = this.polly;

      server
        .any('/ping')
        .on('request', (req) => {
          expect(req.params).to.deep.equal({});
        })
        .on('beforeResponse', (req) => {
          expect(req.params).to.deep.equal({});
        });

      server
        .any('/ping/:id')
        .on('request', (req) => {
          expect(req.params).to.deep.equal({ id: '1' });
        })
        .on('beforeResponse', (req) => {
          expect(req.params).to.deep.equal({ id: '1' });
        });

      server
        .get('/ping/:id/:id2/*path')
        .intercept((req, res) => res.sendStatus(200))
        .on('request', (req) => {
          expect(req.params).to.deep.equal({
            id: '1',
            id2: '2',
            path: 'foo/bar'
          });
        })
        .on('beforeResponse', (req) => {
          expect(req.params).to.deep.equal({
            id: '1',
            id2: '2',
            path: 'foo/bar'
          });
        });

      expect((await fetch('/ping/1/2/foo/bar')).status).to.equal(200);
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 371, 'column': 10, 'index': 10774}","it('events receive params', async function () {
      const { server } = this.polly;

      server
        .any('/ping')
        .on('request', (req) => {
          expect(req.params).to.deep.equal({});
        })
        .on('beforeResponse', (req) => {
          expect(req.params).to.deep.equal({});
        });

      server
        .any('/ping/:id')
        .on('request', (req) => {
          expect(req.params).to.deep.equal({ id: '1' });
        })
        .on('beforeResponse', (req) => {
          expect(req.params).to.deep.equal({ id: '1' });
        });

      server
        .get('/ping/:id/:id2/*path')
        .intercept((req, res) => res.sendStatus(200))
        .on('request', (req) => {
          expect(req.params).to.deep.equal({
            id: '1',
            id2: '2',
            path: 'foo/bar'
          });
        })
        .on('beforeResponse', (req) => {
          expect(req.params).to.deep.equal({
            id: '1',
            id2: '2',
            path: 'foo/bar'
          });
        });

      expect((await fetch('/ping/1/2/foo/bar')).status).to.equal(200);
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 374, 'column': 10, 'index': 10883}","it('events receive params', async function () {
      const { server } = this.polly;

      server
        .any('/ping')
        .on('request', (req) => {
          expect(req.params).to.deep.equal({});
        })
        .on('beforeResponse', (req) => {
          expect(req.params).to.deep.equal({});
        });

      server
        .any('/ping/:id')
        .on('request', (req) => {
          expect(req.params).to.deep.equal({ id: '1' });
        })
        .on('beforeResponse', (req) => {
          expect(req.params).to.deep.equal({ id: '1' });
        });

      server
        .get('/ping/:id/:id2/*path')
        .intercept((req, res) => res.sendStatus(200))
        .on('request', (req) => {
          expect(req.params).to.deep.equal({
            id: '1',
            id2: '2',
            path: 'foo/bar'
          });
        })
        .on('beforeResponse', (req) => {
          expect(req.params).to.deep.equal({
            id: '1',
            id2: '2',
            path: 'foo/bar'
          });
        });

      expect((await fetch('/ping/1/2/foo/bar')).status).to.equal(200);
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 381, 'column': 10, 'index': 11091}","it('events receive params', async function () {
      const { server } = this.polly;

      server
        .any('/ping')
        .on('request', (req) => {
          expect(req.params).to.deep.equal({});
        })
        .on('beforeResponse', (req) => {
          expect(req.params).to.deep.equal({});
        });

      server
        .any('/ping/:id')
        .on('request', (req) => {
          expect(req.params).to.deep.equal({ id: '1' });
        })
        .on('beforeResponse', (req) => {
          expect(req.params).to.deep.equal({ id: '1' });
        });

      server
        .get('/ping/:id/:id2/*path')
        .intercept((req, res) => res.sendStatus(200))
        .on('request', (req) => {
          expect(req.params).to.deep.equal({
            id: '1',
            id2: '2',
            path: 'foo/bar'
          });
        })
        .on('beforeResponse', (req) => {
          expect(req.params).to.deep.equal({
            id: '1',
            id2: '2',
            path: 'foo/bar'
          });
        });

      expect((await fetch('/ping/1/2/foo/bar')).status).to.equal(200);
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 388, 'column': 10, 'index': 11273}","it('events receive params', async function () {
      const { server } = this.polly;

      server
        .any('/ping')
        .on('request', (req) => {
          expect(req.params).to.deep.equal({});
        })
        .on('beforeResponse', (req) => {
          expect(req.params).to.deep.equal({});
        });

      server
        .any('/ping/:id')
        .on('request', (req) => {
          expect(req.params).to.deep.equal({ id: '1' });
        })
        .on('beforeResponse', (req) => {
          expect(req.params).to.deep.equal({ id: '1' });
        });

      server
        .get('/ping/:id/:id2/*path')
        .intercept((req, res) => res.sendStatus(200))
        .on('request', (req) => {
          expect(req.params).to.deep.equal({
            id: '1',
            id2: '2',
            path: 'foo/bar'
          });
        })
        .on('beforeResponse', (req) => {
          expect(req.params).to.deep.equal({
            id: '1',
            id2: '2',
            path: 'foo/bar'
          });
        });

      expect((await fetch('/ping/1/2/foo/bar')).status).to.equal(200);
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 481, 'column': 6, 'index': 13875}","it('can control flow with .times() & .stopPropagation()', async function () {
      const { server } = this.polly;
      let calledBeforeDelete = false;
      let calledAfterDelete = false;

      // First call should return the user and not enter the 2nd handler
      server
        .get('/users/1')
        .times(1)
        .on('request', (req, e) => {
          e.stopPropagation();
          calledBeforeDelete = true;
        })
        .intercept((req, res, interceptor) => {
          interceptor.stopPropagation();
          res.sendStatus(200);
        });

      server.delete('/users/1').intercept((req, res) => res.status(204));

      // Second call should 404 since the user no longer exists
      server
        .get('/users/1')
        .times(1)
        .on('request', () => (calledAfterDelete = true))
        .intercept((req, res) => res.sendStatus(404));

      expect((await fetch('/users/1')).status).to.equal(200);
      expect(calledBeforeDelete).to.be.true;
      expect(calledAfterDelete).to.be.false;

      calledBeforeDelete = false;
      expect((await fetch('/users/1', { method: 'DELETE' })).status).to.equal(
        204
      );

      expect((await fetch('/users/1')).status).to.equal(404);
      expect(calledBeforeDelete).to.be.false;
      expect(calledAfterDelete).to.be.true;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 482, 'column': 6, 'index': 13937}","it('can control flow with .times() & .stopPropagation()', async function () {
      const { server } = this.polly;
      let calledBeforeDelete = false;
      let calledAfterDelete = false;

      // First call should return the user and not enter the 2nd handler
      server
        .get('/users/1')
        .times(1)
        .on('request', (req, e) => {
          e.stopPropagation();
          calledBeforeDelete = true;
        })
        .intercept((req, res, interceptor) => {
          interceptor.stopPropagation();
          res.sendStatus(200);
        });

      server.delete('/users/1').intercept((req, res) => res.status(204));

      // Second call should 404 since the user no longer exists
      server
        .get('/users/1')
        .times(1)
        .on('request', () => (calledAfterDelete = true))
        .intercept((req, res) => res.sendStatus(404));

      expect((await fetch('/users/1')).status).to.equal(200);
      expect(calledBeforeDelete).to.be.true;
      expect(calledAfterDelete).to.be.false;

      calledBeforeDelete = false;
      expect((await fetch('/users/1', { method: 'DELETE' })).status).to.equal(
        204
      );

      expect((await fetch('/users/1')).status).to.equal(404);
      expect(calledBeforeDelete).to.be.false;
      expect(calledAfterDelete).to.be.true;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 483, 'column': 6, 'index': 13982}","it('can control flow with .times() & .stopPropagation()', async function () {
      const { server } = this.polly;
      let calledBeforeDelete = false;
      let calledAfterDelete = false;

      // First call should return the user and not enter the 2nd handler
      server
        .get('/users/1')
        .times(1)
        .on('request', (req, e) => {
          e.stopPropagation();
          calledBeforeDelete = true;
        })
        .intercept((req, res, interceptor) => {
          interceptor.stopPropagation();
          res.sendStatus(200);
        });

      server.delete('/users/1').intercept((req, res) => res.status(204));

      // Second call should 404 since the user no longer exists
      server
        .get('/users/1')
        .times(1)
        .on('request', () => (calledAfterDelete = true))
        .intercept((req, res) => res.sendStatus(404));

      expect((await fetch('/users/1')).status).to.equal(200);
      expect(calledBeforeDelete).to.be.true;
      expect(calledAfterDelete).to.be.false;

      calledBeforeDelete = false;
      expect((await fetch('/users/1', { method: 'DELETE' })).status).to.equal(
        204
      );

      expect((await fetch('/users/1')).status).to.equal(404);
      expect(calledBeforeDelete).to.be.false;
      expect(calledAfterDelete).to.be.true;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 490, 'column': 6, 'index': 14163}","it('can control flow with .times() & .stopPropagation()', async function () {
      const { server } = this.polly;
      let calledBeforeDelete = false;
      let calledAfterDelete = false;

      // First call should return the user and not enter the 2nd handler
      server
        .get('/users/1')
        .times(1)
        .on('request', (req, e) => {
          e.stopPropagation();
          calledBeforeDelete = true;
        })
        .intercept((req, res, interceptor) => {
          interceptor.stopPropagation();
          res.sendStatus(200);
        });

      server.delete('/users/1').intercept((req, res) => res.status(204));

      // Second call should 404 since the user no longer exists
      server
        .get('/users/1')
        .times(1)
        .on('request', () => (calledAfterDelete = true))
        .intercept((req, res) => res.sendStatus(404));

      expect((await fetch('/users/1')).status).to.equal(200);
      expect(calledBeforeDelete).to.be.true;
      expect(calledAfterDelete).to.be.false;

      calledBeforeDelete = false;
      expect((await fetch('/users/1', { method: 'DELETE' })).status).to.equal(
        204
      );

      expect((await fetch('/users/1')).status).to.equal(404);
      expect(calledBeforeDelete).to.be.false;
      expect(calledAfterDelete).to.be.true;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 491, 'column': 6, 'index': 14225}","it('can control flow with .times() & .stopPropagation()', async function () {
      const { server } = this.polly;
      let calledBeforeDelete = false;
      let calledAfterDelete = false;

      // First call should return the user and not enter the 2nd handler
      server
        .get('/users/1')
        .times(1)
        .on('request', (req, e) => {
          e.stopPropagation();
          calledBeforeDelete = true;
        })
        .intercept((req, res, interceptor) => {
          interceptor.stopPropagation();
          res.sendStatus(200);
        });

      server.delete('/users/1').intercept((req, res) => res.status(204));

      // Second call should 404 since the user no longer exists
      server
        .get('/users/1')
        .times(1)
        .on('request', () => (calledAfterDelete = true))
        .intercept((req, res) => res.sendStatus(404));

      expect((await fetch('/users/1')).status).to.equal(200);
      expect(calledBeforeDelete).to.be.true;
      expect(calledAfterDelete).to.be.false;

      calledBeforeDelete = false;
      expect((await fetch('/users/1', { method: 'DELETE' })).status).to.equal(
        204
      );

      expect((await fetch('/users/1')).status).to.equal(404);
      expect(calledBeforeDelete).to.be.false;
      expect(calledAfterDelete).to.be.true;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/server-test.js,Duplicate Assert,"{'line': 492, 'column': 6, 'index': 14271}","it('can control flow with .times() & .stopPropagation()', async function () {
      const { server } = this.polly;
      let calledBeforeDelete = false;
      let calledAfterDelete = false;

      // First call should return the user and not enter the 2nd handler
      server
        .get('/users/1')
        .times(1)
        .on('request', (req, e) => {
          e.stopPropagation();
          calledBeforeDelete = true;
        })
        .intercept((req, res, interceptor) => {
          interceptor.stopPropagation();
          res.sendStatus(200);
        });

      server.delete('/users/1').intercept((req, res) => res.status(204));

      // Second call should 404 since the user no longer exists
      server
        .get('/users/1')
        .times(1)
        .on('request', () => (calledAfterDelete = true))
        .intercept((req, res) => res.sendStatus(404));

      expect((await fetch('/users/1')).status).to.equal(200);
      expect(calledBeforeDelete).to.be.true;
      expect(calledAfterDelete).to.be.false;

      calledBeforeDelete = false;
      expect((await fetch('/users/1', { method: 'DELETE' })).status).to.equal(
        204
      );

      expect((await fetch('/users/1')).status).to.equal(404);
      expect(calledBeforeDelete).to.be.false;
      expect(calledAfterDelete).to.be.true;
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/adapter-test.js,Duplicate Assert,"{'line': 163, 'column': 6, 'index': 4753}","it('should set bodyUsed to true if a body is present', async function () {
      const { server } = this.polly;
      const request = new Request('/', { method: 'POST', body: '{}' });

      server.any().intercept((_, res) => res.sendStatus(200));

      expect(request.bodyUsed).to.equal(false);
      await this.fetch(request);
      expect(request.bodyUsed).to.equal(true);
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/adapter-test.js,Duplicate Assert,"{'line': 165, 'column': 6, 'index': 4834}","it('should set bodyUsed to true if a body is present', async function () {
      const { server } = this.polly;
      const request = new Request('/', { method: 'POST', body: '{}' });

      server.any().intercept((_, res) => res.sendStatus(200));

      expect(request.bodyUsed).to.equal(false);
      await this.fetch(request);
      expect(request.bodyUsed).to.equal(true);
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/adapter-test.js,Duplicate Assert,"{'line': 174, 'column': 6, 'index': 5119}","it('should not set bodyUsed to true if a body is not present', async function () {
      const { server } = this.polly;
      const request = new Request('/');

      server.any().intercept((_, res) => res.sendStatus(200));

      expect(request.bodyUsed).to.equal(false);
      await this.fetch(request);
      expect(request.bodyUsed).to.equal(false);
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/adapter-test.js,Duplicate Assert,"{'line': 176, 'column': 6, 'index': 5200}","it('should not set bodyUsed to true if a body is not present', async function () {
      const { server } = this.polly;
      const request = new Request('/');

      server.any().intercept((_, res) => res.sendStatus(200));

      expect(request.bodyUsed).to.equal(false);
      await this.fetch(request);
      expect(request.bodyUsed).to.equal(false);
    })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/adapter-test.js,Exception Handling,"{'line': 71, 'column': 4, 'index': 2125}","it('should handle aborting a request', async function () {
    const { server } = this.polly;
    const controller = new AbortController();
    let abortEventCalled = false;
    let error;

    server
      .any(this.recordUrl())
      .on('request', () => controller.abort())
      .on('abort', () => (abortEventCalled = true))
      .intercept((_, res) => {
        res.sendStatus(200);
      });

    try {
      await this.fetchRecord({ signal: controller.signal });
    } catch (e) {
      error = e;
    }

    expect(abortEventCalled).to.equal(true);
    expect(error.message).to.contain('The user aborted a request.');
  })",steel
/packages/@pollyjs/adapter-fetch/tests/integration/adapter-test.js,Exception Handling,"{'line': 94, 'column': 4, 'index': 2726}","it('should handle immediately aborting a request', async function () {
    const { server } = this.polly;
    const controller = new AbortController();
    let abortEventCalled = false;
    let error;

    server
      .any(this.recordUrl())
      .on('abort', () => (abortEventCalled = true))
      .intercept((_, res) => {
        res.sendStatus(200);
      });

    try {
      const promise = this.fetchRecord({ signal: controller.signal });

      controller.abort();
      await promise;
    } catch (e) {
      error = e;
    }

    expect(abortEventCalled).to.equal(true);
    expect(error.message).to.contain('The user aborted a request.');
  })",steel
/packages/@pollyjs/adapter/tests/unit/utils/is-expired-test.js,Conditional Test Logic,"{'line': 18, 'column': 6, 'index': 549}","it('should work', function () {
    [
      [undefined, undefined, false],
      [null, null, false],
      [new Date(), undefined, false],
      [undefined, '1 day', false],
      [new Date(), '1 day', false],
      [new Date('1/1/2018'), '100 years', false],
      [new Date('1/1/2017'), '1y', true],
      [new Date('1/1/2018'), '1m5d10h', true]
    ].forEach(([recordedOn, expiresIn, value]) => {
      expect(isExpired(recordedOn, expiresIn)).to.equal(value);
    });
  })",steel
/packages/@pollyjs/adapter/tests/unit/utils/dehumanize-time-test.js,Conditional Test Logic,"{'line': 32, 'column': 6, 'index': 1258}","it('should work', function () {
    expect(dehumanizeTime(null)).to.be.NaN;
    expect(dehumanizeTime(undefined)).to.be.NaN;
    expect(dehumanizeTime(true)).to.be.NaN;
    expect(dehumanizeTime(false)).to.be.NaN;

    [
      [['1ms', '1millisecond', '1 milliseconds'], 1],
      [['10ms', '10millisecond', '10 milliseconds'], 10],
      [['100ms', '100millisecond', '100 milliseconds'], 100],
      [['1s', '1sec', '1secs', '1 second', '1 seconds'], 1000],
      [['1.5s', '1.5sec', '1.5secs', '1.5 second', '1.5 seconds'], 1500],
      [['1m', '1min', '1mins', '1 minute', '1 minutes'], 1000 * 60],
      [['1h', '1hr', '1hrs', '1 hour', '1 hours'], 1000 * 60 * 60],
      [['1d', '1day', '1 days'], 1000 * 60 * 60 * 24],
      [['1w', '1wk', '1wks', '1 week', '1 weeks'], 1000 * 60 * 60 * 24 * 7],
      [['1y', '1yr', '1 yrs', '1 year', '1 years'], 1000 * 60 * 60 * 24 * 365],
      [
        [
          '1y 2 wks 3day 4 minutes 5secs 6 ms',
          '6 millisecond 5s 4 min 3d 2 weeks 1yrs'
        ],
        33005045006
      ]
    ].forEach(([inputs, value]) => {
      inputs.forEach((str) => expect(dehumanizeTime(str)).to.equal(value));
    });
  })",steel
/examples/jest-puppeteer/__tests__/dummy-app.test.js,Duplicate Assert,"{'line': 49, 'column': 10, 'index': 1442}","it('should be able to navigate to all routes', async () => {
    const header = await page.$('header');

    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Posts');

    await expect(page).toClick('a', { text: 'Todos' });
    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Todos');

    await expect(page).toClick('a', { text: 'Users' });
    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Users');

    // Wait for all requests to resolve, this can also be replaced with
    await context.polly.flush();
  })",steel
/examples/jest-puppeteer/__tests__/dummy-app.test.js,Duplicate Assert,"{'line': 50, 'column': 10, 'index': 1514}","it('should be able to navigate to all routes', async () => {
    const header = await page.$('header');

    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Posts');

    await expect(page).toClick('a', { text: 'Todos' });
    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Todos');

    await expect(page).toClick('a', { text: 'Users' });
    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Users');

    // Wait for all requests to resolve, this can also be replaced with
    await context.polly.flush();
  })",steel
/examples/jest-puppeteer/__tests__/dummy-app.test.js,Duplicate Assert,"{'line': 52, 'column': 10, 'index': 1558}","it('should be able to navigate to all routes', async () => {
    const header = await page.$('header');

    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Posts');

    await expect(page).toClick('a', { text: 'Todos' });
    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Todos');

    await expect(page).toClick('a', { text: 'Users' });
    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Users');

    // Wait for all requests to resolve, this can also be replaced with
    await context.polly.flush();
  })",steel
/examples/jest-puppeteer/__tests__/dummy-app.test.js,Duplicate Assert,"{'line': 53, 'column': 10, 'index': 1614}","it('should be able to navigate to all routes', async () => {
    const header = await page.$('header');

    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Posts');

    await expect(page).toClick('a', { text: 'Todos' });
    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Todos');

    await expect(page).toClick('a', { text: 'Users' });
    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Users');

    // Wait for all requests to resolve, this can also be replaced with
    await context.polly.flush();
  })",steel
/examples/jest-puppeteer/__tests__/dummy-app.test.js,Duplicate Assert,"{'line': 54, 'column': 10, 'index': 1686}","it('should be able to navigate to all routes', async () => {
    const header = await page.$('header');

    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Posts');

    await expect(page).toClick('a', { text: 'Todos' });
    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Todos');

    await expect(page).toClick('a', { text: 'Users' });
    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Users');

    // Wait for all requests to resolve, this can also be replaced with
    await context.polly.flush();
  })",steel
/examples/jest-puppeteer/__tests__/dummy-app.test.js,Duplicate Assert,"{'line': 56, 'column': 10, 'index': 1730}","it('should be able to navigate to all routes', async () => {
    const header = await page.$('header');

    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Posts');

    await expect(page).toClick('a', { text: 'Todos' });
    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Todos');

    await expect(page).toClick('a', { text: 'Users' });
    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Users');

    // Wait for all requests to resolve, this can also be replaced with
    await context.polly.flush();
  })",steel
/examples/jest-puppeteer/__tests__/dummy-app.test.js,Duplicate Assert,"{'line': 57, 'column': 10, 'index': 1786}","it('should be able to navigate to all routes', async () => {
    const header = await page.$('header');

    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Posts');

    await expect(page).toClick('a', { text: 'Todos' });
    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Todos');

    await expect(page).toClick('a', { text: 'Users' });
    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Users');

    // Wait for all requests to resolve, this can also be replaced with
    await context.polly.flush();
  })",steel
/examples/jest-puppeteer/__tests__/dummy-app.test.js,Duplicate Assert,"{'line': 58, 'column': 10, 'index': 1858}","it('should be able to navigate to all routes', async () => {
    const header = await page.$('header');

    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Posts');

    await expect(page).toClick('a', { text: 'Todos' });
    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Todos');

    await expect(page).toClick('a', { text: 'Users' });
    await expect(page).toMatchElement('tbody > tr', { timeout: 5000 });
    await expect(header).toMatch('Users');

    // Wait for all requests to resolve, this can also be replaced with
    await context.polly.flush();
  })",steel
/examples/jest-node-fetch/__tests__/index.test.js,Magic Number,"{'line': 28, 'column': 27, 'index': 715}","it('should return post', async () => {
      const post = await posts('1');

      expect(post.id).toBe(1);
      expect(post.title).toBe(
        'sunt aut facere repellat provident occaecati excepturi optio reprehenderit'
      );
    })",steel
/examples/jest-node-fetch/__tests__/index.test.js,Magic Number,"{'line': 39, 'column': 27, 'index': 995}","it('should return user', async () => {
      const user = await users('1');

      expect(user.id).toBe(1);
      expect(user.name).toBe('Leanne Graham');
      expect(user.email).toBe('Sincere@april.biz');
    })",steel
/examples/client-server/tests/intercept.test.js,Conditional Test Logic,"{'line': 51, 'column': 8, 'index': 1389}","it('can conditionally intercept requests', async function () {
    const { server } = this.polly;

    server
      .get('https://jsonplaceholder.typicode.com/posts/:id')
      .intercept((req, res, interceptor) => {
        if (req.params.id === '42') {
          res.status(200).send('Life');
        } else {
          // Abort out of the intercept handler and continue with the request
          interceptor.abort();
        }
      });

    let res = await fetch('https://jsonplaceholder.typicode.com/posts/42');

    expect(res.status).to.equal(200);
    expect(await res.text()).to.equal('Life');

    res = await fetch('https://jsonplaceholder.typicode.com/posts/1');

    expect(res.status).to.equal(200);
    expect((await res.json()).id).to.equal(1);
  })",steel
/examples/client-server/tests/intercept.test.js,Duplicate Assert,"{'line': 61, 'column': 4, 'index': 1687}","it('can conditionally intercept requests', async function () {
    const { server } = this.polly;

    server
      .get('https://jsonplaceholder.typicode.com/posts/:id')
      .intercept((req, res, interceptor) => {
        if (req.params.id === '42') {
          res.status(200).send('Life');
        } else {
          // Abort out of the intercept handler and continue with the request
          interceptor.abort();
        }
      });

    let res = await fetch('https://jsonplaceholder.typicode.com/posts/42');

    expect(res.status).to.equal(200);
    expect(await res.text()).to.equal('Life');

    res = await fetch('https://jsonplaceholder.typicode.com/posts/1');

    expect(res.status).to.equal(200);
    expect((await res.json()).id).to.equal(1);
  })",steel
/examples/client-server/tests/intercept.test.js,Duplicate Assert,"{'line': 66, 'column': 4, 'index': 1845}","it('can conditionally intercept requests', async function () {
    const { server } = this.polly;

    server
      .get('https://jsonplaceholder.typicode.com/posts/:id')
      .intercept((req, res, interceptor) => {
        if (req.params.id === '42') {
          res.status(200).send('Life');
        } else {
          // Abort out of the intercept handler and continue with the request
          interceptor.abort();
        }
      });

    let res = await fetch('https://jsonplaceholder.typicode.com/posts/42');

    expect(res.status).to.equal(200);
    expect(await res.text()).to.equal('Life');

    res = await fetch('https://jsonplaceholder.typicode.com/posts/1');

    expect(res.status).to.equal(200);
    expect((await res.json()).id).to.equal(1);
  })",steel
